!function( e, t ) {'object'==typeof exports&&'undefined'!=typeof module?module.exports=t():'function'==typeof define&&define.amd?define( t ):( e='undefined'!=typeof globalThis?globalThis:e||self ).firebase=t()}( this, ( function() {
  'use strict'; var e=function( t, n ) {return( e=Object.setPrototypeOf||{ __proto__: [] }instanceof Array&&function( e, t ) {e.__proto__=t}||function( e, t ) {for( var n in t ) {Object.prototype.hasOwnProperty.call( t, n )&&( e[n]=t[n] )}} )( t, n )}, t=function() {return( t=Object.assign||function( e ) {for( var t, n=1, r=arguments.length; n<r; n++ ) {for( var i in t=arguments[n] ) {Object.prototype.hasOwnProperty.call( t, i )&&( e[i]=t[i] )}}return e} ).apply( this, arguments )}; function n( e ) {var t='function'==typeof Symbol&&Symbol.iterator, n=t&&e[t], r=0; if( n ) {return n.call( e )}if( e&&'number'==typeof e.length ) {return{ next: function() {return{ value: ( e=e&&r>=e.length?void 0:e )&&e[r++], done: !e }} }}throw new TypeError( t?'Object is not iterable.':'Symbol.iterator is not defined.' )}function r( e, t ) {
    var n='function'==typeof Symbol&&e[Symbol.iterator]; if( !n ) {return e}var r, i, o=n.call( e ), a=[]; try{for( ;( void 0===t||0<t-- )&&!( r=o.next() ).done; ) {a.push( r.value )}}
    catch( e ) {i={ error: e }}
    finally{
      try{r&&!r.done&&( n=o.return )&&n.call( o )}
      finally{if( i ) {throw i.error}}
    }return a;
  }function i( e, t ) {for( var n=0, r=t.length, i=e.length; n<r; n++, i++ ) {e[i]=t[n]}return e}function o( e, t ) {if( !( t instanceof Object ) ) {return t}switch( t.constructor ) {case Date:return new Date( t.getTime() ); case Object:void 0===e&&( e={} ); break; case Array:e=[]; break; default:return t;}for( var n in t ) {t.hasOwnProperty( n )&&'__proto__'!==n&&( e[n]=o( e[n], t[n] ) )}return e}var a=( s.prototype.wrapCallback=function( e ) {var t=this; return function( n, r ) {n?t.reject( n ):t.resolve( r ), 'function'==typeof e&&( t.promise.catch( ( function() {} ) ), 1===e.length?e( n ):e( n, r ) )}}, s ); function s() {var e=this; this.reject=function() {}, this.resolve=function() {}, this.promise=new Promise( ( function( t, n ) {e.resolve=t, e.reject=n} ) )}var u, l=( function( t, n ) {if( 'function'!=typeof n&&null!==n ) {throw new TypeError( 'Class extends value '+String( n )+' is not a constructor or null' )}function r() {this.constructor=t}e( t, n ), t.prototype=null===n?Object.create( n ):( r.prototype=n.prototype, new r )}( c, u=Error ), c ); function c( e, t, n ) {return( t=u.call( this, t )||this ).code=e, t.customData=n, t.name='FirebaseError', Object.setPrototypeOf( t, c.prototype ), Error.captureStackTrace&&Error.captureStackTrace( t, h.prototype.create ), t}var h=( p.prototype.create=function( e ) {for( var t=[], n=1; n<arguments.length; n++ ) {t[n-1]=arguments[n]}var r, i=t[0]||{}, o=this.service+'/'+e; e=( e=this.errors[e] )?( r=i, e.replace( d, ( function( e, t ) {var n=r[t]; return null!=n?String( n ):'<'+t+'?>'} ) ) ):'Error', e=this.serviceName+': '+e+' ('+o+').'; return new l( o, e, i )}, p ); function p( e, t, n ) {this.service=e, this.serviceName=t, this.errors=n}var d=/\{\$([^}]+)}/g; function f( e, t ) {return Object.prototype.hasOwnProperty.call( e, t )}function _( e, t ) {return( t=new y( e, t ) ).subscribe.bind( t )}var y=( v.prototype.next=function( e ) {this.forEachObserver( ( function( t ) {t.next( e )} ) )}, v.prototype.error=function( e ) {this.forEachObserver( ( function( t ) {t.error( e )} ) ), this.close( e )}, v.prototype.complete=function() {this.forEachObserver( ( function( e ) {e.complete()} ) ), this.close()}, v.prototype.subscribe=function( e, t, n ) {
    var r, i=this; if( void 0===e&&void 0===t&&void 0===n ) {throw new Error( 'Missing Observer.' )}return void 0===( r=function( e, t ) {if( 'object'!=typeof e||null===e ) {return!1}for( var n=0, r=['next', 'error', 'complete']; n<r.length; n++ ) {var i=r[n]; if( i in e&&'function'==typeof e[i] ) {return!0}}return!1}( e )?e:{ next: e, error: t, complete: n } ).next&&( r.next=g ), void 0===r.error&&( r.error=g ), void 0===r.complete&&( r.complete=g ), n=this.unsubscribeOne.bind( this, this.observers.length ), this.finalized&&this.task.then( ( function() {
      try{i.finalError?r.error( i.finalError ):r.complete()}
      catch( e ) {}
    } ) ), this.observers.push( r ), n;
  }, v.prototype.unsubscribeOne=function( e ) {void 0!==this.observers&&void 0!==this.observers[e]&&( delete this.observers[e], --this.observerCount, 0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers( this ) )}, v.prototype.forEachObserver=function( e ) {if( !this.finalized ) {for( var t=0; t<this.observers.length; t++ ) {this.sendOne( t, e )}}}, v.prototype.sendOne=function( e, t ) {
    var n=this; this.task.then( ( function() {
      if( void 0!==n.observers&&void 0!==n.observers[e] ) {
        try{t( n.observers[e] )}
        catch( e ) {'undefined'!=typeof console&&console.error&&console.error( e )}
      }
    } ) );
  }, v.prototype.close=function( e ) {var t=this; this.finalized||( this.finalized=!0, void 0!==e&&( this.finalError=e ), this.task.then( ( function() {t.observers=void 0, t.onNoObservers=void 0} ) ) )}, v ); function v( e, t ) {var n=this; this.observers=[], this.unsubscribes=[], this.observerCount=0, this.task=Promise.resolve(), this.finalized=!1, this.onNoObservers=t, this.task.then( ( function() {e( n )} ) ).catch( ( function( e ) {n.error( e )} ) )}function g() {}var m=( w.prototype.setInstantiationMode=function( e ) {return this.instantiationMode=e, this}, w.prototype.setMultipleInstances=function( e ) {return this.multipleInstances=e, this}, w.prototype.setServiceProps=function( e ) {return this.serviceProps=e, this}, w.prototype.setInstanceCreatedCallback=function( e ) {return this.onInstanceCreated=e, this}, w ); function w( e, t, n ) {this.name=e, this.instanceFactory=t, this.type=n, this.multipleInstances=!1, this.serviceProps={}, this.instantiationMode='LAZY', this.onInstanceCreated=null}var b='[DEFAULT]', C=( E.prototype.get=function( e ) {
    void 0===e&&( e=b ); var t=this.normalizeInstanceIdentifier( e ); if( !this.instancesDeferred.has( t ) ) {
      var n=new a; if( this.instancesDeferred.set( t, n ), this.isInitialized( t )||this.shouldAutoInitialize() ) {
        try{var r=this.getOrInitializeService( { instanceIdentifier: t } ); r&&n.resolve( r )}
        catch( e ) {}
      }
    }return this.instancesDeferred.get( t ).promise;
  }, E.prototype.getImmediate=function( e ) {
    e=( n=t( { identifier: b, optional: !1 }, e ) ).identifier; var n=n.optional, r=this.normalizeInstanceIdentifier( e ); if( !this.isInitialized( r )&&!this.shouldAutoInitialize() ) {if( n ) {return null}throw Error( 'Service '+this.name+' is not available' )}try{return this.getOrInitializeService( { instanceIdentifier: r } )}
    catch( e ) {if( n ) {return null}throw e}
  }, E.prototype.getComponent=function() {return this.component}, E.prototype.setComponent=function( e ) {
    var t, i; if( e.name!==this.name ) {throw Error( 'Mismatching Component '+e.name+' for Provider '+this.name+'.' )}if( this.component ) {throw Error( 'Component for '+this.name+' has already been provided' )}if( this.component=e, this.shouldAutoInitialize() ) {
      if( 'EAGER'===e.instantiationMode ) {
        try{this.getOrInitializeService( { instanceIdentifier: b } )}
        catch( e ) {}
      }try{
        for( var o=n( this.instancesDeferred.entries() ), a=o.next(); !a.done; a=o.next() ) {
          var s=r( a.value, 2 ), u=s[0], l=s[1], c=this.normalizeInstanceIdentifier( u ); try{var h=this.getOrInitializeService( { instanceIdentifier: c } ); l.resolve( h )}
          catch( e ) {}
        }
      }
      catch( e ) {t={ error: e }}
      finally{
        try{a&&!a.done&&( i=o.return )&&i.call( o )}
        finally{if( t ) {throw t.error}}
      }
    }
  }, E.prototype.clearInstance=function( e ) {void 0===e&&( e=b ), this.instancesDeferred.delete( e ), this.instances.delete( e )}, E.prototype.delete=function() {
    return function( e, t, n, r ) {
      return new( n=n||Promise )( ( function( i, o ) {
        function a( e ) {
          try{u( r.next( e ) )}
          catch( e ) {o( e )}
        }function s( e ) {
          try{u( r.throw( e ) )}
          catch( e ) {o( e )}
        }function u( e ) {var t; e.done?i( e.value ):( ( t=e.value )instanceof n?t:new n( ( function( e ) {e( t )} ) ) ).then( a, s )}u( ( r=r.apply( e, t||[] ) ).next() );
      } ) );
    }( this, void 0, void 0, ( function() {
      var e; return function( e, t ) {
        var n, r, i, o={ label: 0, sent: function() {if( 1&i[0] ) {throw i[1]}return i[1]}, trys: [], ops: [] }, a={ next: s( 0 ), throw: s( 1 ), return: s( 2 ) }; return'function'==typeof Symbol&&( a[Symbol.iterator]=function() {return this} ), a; function s( a ) {
          return function( s ) {
            return function( a ) {
              if( n ) {throw new TypeError( 'Generator is already executing.' )}for( ;o; ) {
                try{if( n=1, r&&( i=2&a[0]?r.return:a[0]?r.throw||( ( i=r.return )&&i.call( r ), 0 ):r.next )&&!( i=i.call( r, a[1] ) ).done ) {return i}switch( r=0, ( a=i?[2&a[0], i.value]:a )[0] ) {case 0:case 1:i=a; break; case 4:return o.label++, { value: a[1], done: !1 }; case 5:o.label++, r=a[1], a=[0]; continue; case 7:a=o.ops.pop(), o.trys.pop(); continue; default:if( !( i=0<( i=o.trys ).length&&i[i.length-1] )&&( 6===a[0]||2===a[0] ) ) {o=0; continue}if( 3===a[0]&&( !i||a[1]>i[0]&&a[1]<i[3] ) ) {o.label=a[1]; break}if( 6===a[0]&&o.label<i[1] ) {o.label=i[1], i=a; break}if( i&&o.label<i[2] ) {o.label=i[2], o.ops.push( a ); break}i[2]&&o.ops.pop(), o.trys.pop(); continue;}a=t.call( e, o )}
                catch( e ) {a=[6, e], r=0}
                finally{n=i=0}
              }if( 5&a[0] ) {throw a[1]}return{ value: a[0]?a[1]:void 0, done: !0 };
            }( [a, s] );
          };
        }
      }( this, ( function( t ) {switch( t.label ) {case 0:return e=Array.from( this.instances.values() ), [4, Promise.all( i( i( [], r( e.filter( ( function( e ) {return'INTERNAL'in e} ) ).map( ( function( e ) {return e.INTERNAL.delete()} ) ) ) ), r( e.filter( ( function( e ) {return'_delete'in e} ) ).map( ( function( e ) {return e._delete()} ) ) ) ) )]; case 1:return t.sent(), [2];}} ) );
    } ) );
  }, E.prototype.isComponentSet=function() {return null!=this.component}, E.prototype.isInitialized=function( e ) {return void 0===e&&( e=b ), this.instances.has( e )}, E.prototype.initialize=function( e ) {
    var t, i, o=void 0===( o=( e=void 0===e?{}:e ).instanceIdentifier )?b:o, a=( e=void 0===( e=e.options )?{}:e, this.normalizeInstanceIdentifier( o ) ); if( this.isInitialized( a ) ) {throw Error( this.name+'('+a+') has already been initialized' )}if( !this.isComponentSet() ) {throw Error( 'Component '+this.name+' has not been registered yet' )}var s=this.getOrInitializeService( { instanceIdentifier: a, options: e } ); try{for( var u=n( this.instancesDeferred.entries() ), l=u.next(); !l.done; l=u.next() ) {var c=( h=r( l.value, 2 ) )[0], h=h[1]; a===this.normalizeInstanceIdentifier( c )&&h.resolve( s )}}
    catch( e ) {t={ error: e }}
    finally{
      try{l&&!l.done&&( i=u.return )&&i.call( u )}
      finally{if( t ) {throw t.error}}
    }return s;
  }, E.prototype.getOrInitializeService=function( e ) {
    var t=e.instanceIdentifier, n=e.options, r=( e=void 0===n?{}:n, this.instances.get( t ) ); if( !r&&this.component&&( r=this.component.instanceFactory( this.container, { instanceIdentifier: ( n=t )===b?void 0:n, options: e } ), this.instances.set( t, r ), this.component.onInstanceCreated ) ) {
      try{this.component.onInstanceCreated( this.container, t, r )}
      catch( e ) {}
    }return r||null;
  }, E.prototype.normalizeInstanceIdentifier=function( e ) {return!this.component||this.component.multipleInstances?e:b}, E.prototype.shouldAutoInitialize=function() {return!!this.component&&'EXPLICIT'!==this.component.instantiationMode}, E ); function E( e, t ) {this.name=e, this.container=t, this.component=null, this.instances=new Map, this.instancesDeferred=new Map}var I=( S.prototype.addComponent=function( e ) {var t=this.getProvider( e.name ); if( t.isComponentSet() ) {throw new Error( 'Component '+e.name+' has already been registered with '+this.name )}t.setComponent( e )}, S.prototype.addOrOverwriteComponent=function( e ) {this.getProvider( e.name ).isComponentSet()&&this.providers.delete( e.name ), this.addComponent( e )}, S.prototype.getProvider=function( e ) {if( this.providers.has( e ) ) {return this.providers.get( e )}var t=new C( e, this ); return this.providers.set( e, t ), t}, S.prototype.getProviders=function() {return Array.from( this.providers.values() )}, S ); function S( e ) {this.name=e, this.providers=new Map}var T, N=[]; function P( e, t ) {for( var n=[], r=2; r<arguments.length; r++ ) {n[r-2]=arguments[r]}if( !( t<e.logLevel ) ) {var o=( new Date ).toISOString(), a=x[t]; if( !a ) {throw new Error( 'Attempted to log a message with an invalid logType (value: '+t+')' )}console[a].apply( console, i( ['['+o+']  '+e.name+':'], n ) )}}( O=T=T||{} )[O.DEBUG=0]='DEBUG', O[O.VERBOSE=1]='VERBOSE', O[O.INFO=2]='INFO', O[O.WARN=3]='WARN', O[O.ERROR=4]='ERROR', O[O.SILENT=5]='SILENT'; var R={ debug: T.DEBUG, verbose: T.VERBOSE, info: T.INFO, warn: T.WARN, error: T.ERROR, silent: T.SILENT }, k=T.INFO, x=( ( L={} )[T.DEBUG]='log', L[T.VERBOSE]='log', L[T.INFO]='info', L[T.WARN]='warn', L[T.ERROR]='error', L ), O=( Object.defineProperty( D.prototype, 'logLevel', { get: function() {return this._logLevel}, set: function( e ) {if( !( e in T ) ) {throw new TypeError( 'Invalid value "'+e+'" assigned to `logLevel`' )}this._logLevel=e}, enumerable: !1, configurable: !0 } ), D.prototype.setLogLevel=function( e ) {this._logLevel='string'==typeof e?R[e]:e}, Object.defineProperty( D.prototype, 'logHandler', { get: function() {return this._logHandler}, set: function( e ) {if( 'function'!=typeof e ) {throw new TypeError( 'Value assigned to `logHandler` must be a function' )}this._logHandler=e}, enumerable: !1, configurable: !0 } ), Object.defineProperty( D.prototype, 'userLogHandler', { get: function() {return this._userLogHandler}, set: function( e ) {this._userLogHandler=e}, enumerable: !1, configurable: !0 } ), D.prototype.debug=function() {for( var e=[], t=0; t<arguments.length; t++ ) {e[t]=arguments[t]}this._userLogHandler&&this._userLogHandler.apply( this, i( [this, T.DEBUG], e ) ), this._logHandler.apply( this, i( [this, T.DEBUG], e ) )}, D.prototype.log=function() {for( var e=[], t=0; t<arguments.length; t++ ) {e[t]=arguments[t]}this._userLogHandler&&this._userLogHandler.apply( this, i( [this, T.VERBOSE], e ) ), this._logHandler.apply( this, i( [this, T.VERBOSE], e ) )}, D.prototype.info=function() {for( var e=[], t=0; t<arguments.length; t++ ) {e[t]=arguments[t]}this._userLogHandler&&this._userLogHandler.apply( this, i( [this, T.INFO], e ) ), this._logHandler.apply( this, i( [this, T.INFO], e ) )}, D.prototype.warn=function() {for( var e=[], t=0; t<arguments.length; t++ ) {e[t]=arguments[t]}this._userLogHandler&&this._userLogHandler.apply( this, i( [this, T.WARN], e ) ), this._logHandler.apply( this, i( [this, T.WARN], e ) )}, D.prototype.error=function() {for( var e=[], t=0; t<arguments.length; t++ ) {e[t]=arguments[t]}this._userLogHandler&&this._userLogHandler.apply( this, i( [this, T.ERROR], e ) ), this._logHandler.apply( this, i( [this, T.ERROR], e ) )}, D ); function D( e ) {this.name=e, this._logLevel=k, this._logHandler=P, this._userLogHandler=null, N.push( this )}function A( e ) {N.forEach( ( function( t ) {t.setLogLevel( e )} ) )}var L=( ( L={} )['no-app']='No Firebase App \'{$appName}\' has been created - call Firebase App.initializeApp()', L['bad-app-name']='Illegal App name: \'{$appName}', L['duplicate-app']='Firebase App named \'{$appName}\' already exists', L['app-deleted']='Firebase App named \'{$appName}\' already deleted', L['invalid-app-argument']='firebase.{$appName}() takes either no argument or a Firebase App instance.', L['invalid-log-argument']='First argument to `onLog` must be null or a function.', L ), F=new h( 'app', 'Firebase', L ), M='@firebase/app', q='[DEFAULT]', j=( ( L={} )[M]='fire-core', L['@firebase/analytics']='fire-analytics', L['@firebase/auth']='fire-auth', L['@firebase/database']='fire-rtdb', L['@firebase/functions']='fire-fn', L['@firebase/installations']='fire-iid', L['@firebase/messaging']='fire-fcm', L['@firebase/performance']='fire-perf', L['@firebase/remote-config']='fire-rc', L['@firebase/storage']='fire-gcs', L['@firebase/firestore']='fire-fst', L['fire-js']='fire-js', L['firebase-wrapper']='fire-js-all', L ), W=new O( '@firebase/app' ), U=( Object.defineProperty( B.prototype, 'automaticDataCollectionEnabled', { get: function() {return this.checkDestroyed_(), this.automaticDataCollectionEnabled_}, set: function( e ) {this.checkDestroyed_(), this.automaticDataCollectionEnabled_=e}, enumerable: !1, configurable: !0 } ), Object.defineProperty( B.prototype, 'name', { get: function() {return this.checkDestroyed_(), this.name_}, enumerable: !1, configurable: !0 } ), Object.defineProperty( B.prototype, 'options', { get: function() {return this.checkDestroyed_(), this.options_}, enumerable: !1, configurable: !0 } ), B.prototype.delete=function() {var e=this; return new Promise( ( function( t ) {e.checkDestroyed_(), t()} ) ).then( ( function() {return e.firebase_.INTERNAL.removeApp( e.name_ ), Promise.all( e.container.getProviders().map( ( function( e ) {return e.delete()} ) ) )} ) ).then( ( function() {e.isDeleted_=!0} ) )}, B.prototype._getService=function( e, t ) {return void 0===t&&( t=q ), this.checkDestroyed_(), this.container.getProvider( e ).getImmediate( { identifier: t } )}, B.prototype._removeServiceInstance=function( e, t ) {void 0===t&&( t=q ), this.container.getProvider( e ).clearInstance( t )}, B.prototype._addComponent=function( e ) {
    try{this.container.addComponent( e )}
    catch( t ) {W.debug( 'Component '+e.name+' failed to register with FirebaseApp '+this.name, t )}
  }, B.prototype._addOrOverwriteComponent=function( e ) {this.container.addOrOverwriteComponent( e )}, B.prototype.toJSON=function() {return{ name: this.name, automaticDataCollectionEnabled: this.automaticDataCollectionEnabled, options: this.options }}, B.prototype.checkDestroyed_=function() {if( this.isDeleted_ ) {throw F.create( 'app-deleted', { appName: this.name_ } )}}, B ); function B( e, t, n ) {var r=this; this.firebase_=n, this.isDeleted_=!1, this.name_=t.name, this.automaticDataCollectionEnabled_=t.automaticDataCollectionEnabled||!1, this.options_=o( void 0, e ), this.container=new I( t.name ), this._addComponent( new m( 'app', ( function() {return r} ), 'PUBLIC' ) ), this.firebase_.INTERNAL.components.forEach( ( function( e ) {return r._addComponent( e )} ) )}U.prototype.name&&U.prototype.options||U.prototype.delete||console.log( 'dc' ); function z( e ) {
    var t={}, n=new Map, r={ __esModule: !0, initializeApp: function( n, i ) {void 0===i&&( i={} ), 'object'==typeof i&&null!==i||( i={ name: i } ); var o=i; if( void 0===o.name&&( o.name=q ), 'string'!=typeof( i=o.name )||!i ) {throw F.create( 'bad-app-name', { appName: String( i ) } )}if( f( t, i ) ) {throw F.create( 'duplicate-app', { appName: i } )}return o=new e( n, o, r ), t[i]=o}, app: i, registerVersion: function( e, t, n ) {var r=null!==( i=j[e] )&&void 0!==i?i:e; n&&( r+='-'+n ); var i=r.match( /\s|\// ); e=t.match( /\s|\// ); if( i||e ) {return n=['Unable to register library "'+r+'" with version "'+t+'":'], i&&n.push( 'library name "'+r+'" contains illegal characters (whitespace or "/")' ), i&&e&&n.push( 'and' ), e&&n.push( 'version name "'+t+'" contains illegal characters (whitespace or "/")' ), void W.warn( n.join( ' ' ) )}a( new m( r+'-version', ( function() {return{ library: r, version: t }} ), 'VERSION' ) )}, setLogLevel: A, onLog: function( e, t ) {
      if( null!==e&&'function'!=typeof e ) {throw F.create( 'invalid-log-argument' )}!function( e, t ) {
        for( var n=0, r=N; n<r.length; n++ ) {
          !function( n ) {
            var r=null; t&&t.level&&( r=R[t.level] ), n.userLogHandler=null===e?null:function( t, n ) {
              for( var i=[], o=2; o<arguments.length; o++ ) {i[o-2]=arguments[o]}var a=i.map( ( function( e ) {
                if( null==e ) {return null}if( 'string'==typeof e ) {return e}if( 'number'==typeof e||'boolean'==typeof e ) {return e.toString()}if( e instanceof Error ) {return e.message}try{return JSON.stringify( e )}
                catch( e ) {return null}
              } ) ).filter( ( function( e ) {return e} ) ).join( ' ' ); n>=( null!=r?r:t.logLevel )&&e( { level: T[n].toLowerCase(), message: a, args: i, type: t.name } );
            };
          }( r[n] );
        }
      }( e, t );
    }, apps: null, SDK_VERSION: '8.4.1', INTERNAL: { registerComponent: a, removeApp: function( e ) {delete t[e]}, components: n, useAsService: function( e, t ) {return'serverAuth'===t?null:t} } }; function i( e ) {if( !f( t, e=e||q ) ) {throw F.create( 'no-app', { appName: e } )}return t[e]}function a( a ) {var s, u=a.name; if( n.has( u ) ) {return W.debug( 'There were multiple attempts to register component '+u+'.' ), 'PUBLIC'===a.type?r[u]:null}n.set( u, a ), 'PUBLIC'===a.type&&( s=function( e ) {if( 'function'!=typeof( e=void 0===e?i():e )[u] ) {throw F.create( 'invalid-app-argument', { appName: u } )}return e[u]()}, void 0!==a.serviceProps&&o( s, a.serviceProps ), r[u]=s, e.prototype[u]=function() {for( var e=[], t=0; t<arguments.length; t++ ) {e[t]=arguments[t]}return this._getService.bind( this, u ).apply( this, a.multipleInstances?e:[] )} ); for( var l=0, c=Object.keys( t ); l<c.length; l++ ) {var h=c[l]; t[h]._addComponent( a )}return'PUBLIC'===a.type?r[u]:null}return r.default=r, Object.defineProperty( r, 'apps', { get: function() {return Object.keys( t ).map( ( function( e ) {return t[e]} ) )} } ), i.App=e, r;
  }L=function e() {var n=z( U ); return n.INTERNAL=t( t( {}, n.INTERNAL ), { createFirebaseNamespace: e, extendNamespace: function( e ) {o( n, e )}, createSubscribe: _, ErrorFactory: h, deepExtend: o } ), n}(); var H=( V.prototype.getPlatformInfoString=function() {return this.container.getProviders().map( ( function( e ) {return function( e ) {return'VERSION'===( null==( e=e.getComponent() )?void 0:e.type )}( e )?( e=e.getImmediate() ).library+'/'+e.version:null} ) ).filter( ( function( e ) {return e} ) ).join( ' ' )}, V ); function V( e ) {this.container=e}'object'==typeof self&&self.self===self&&void 0!==self.firebase&&( W.warn( '\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ' ), ( O=self.firebase.SDK_VERSION )&&0<=O.indexOf( 'LITE' )&&W.warn( '\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ' ) ); var Q=L.initializeApp; L.initializeApp=function() {
    for( var e=[], t=0; t<arguments.length; t++ ) {e[t]=arguments[t]}return function() {
      try{return'[object process]'===Object.prototype.toString.call( global.process )}
      catch( e ) {}
    }()&&W.warn( '\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      ' ), Q.apply( void 0, e );
  }; var Y, G=L; return( Y=G ).INTERNAL.registerComponent( new m( 'platform-logger', ( function( e ) {return new H( e )} ), 'PRIVATE' ) ), Y.registerVersion( M, '0.6.20', void 0 ), Y.registerVersion( 'fire-js', '' ), G.registerVersion( 'firebase', '8.4.1', 'app' ), G;
} ) ), function( e, t ) {'object'==typeof exports&&'undefined'!=typeof module?t( require( '@firebase/app' ) ):'function'==typeof define&&define.amd?define( ['@firebase/app'], t ):t( ( e='undefined'!=typeof globalThis?globalThis:e||self ).firebase )}( this, ( function( e ) {
  'use strict'; try{
    ( function() {
      var t=function( e ) {return e&&'object'==typeof e&&'default'in e?e:{ default: e }}( e ), n=function( e, t ) {return( n=Object.setPrototypeOf||{ __proto__: [] }instanceof Array&&function( e, t ) {e.__proto__=t}||function( e, t ) {for( var n in t ) {Object.prototype.hasOwnProperty.call( t, n )&&( e[n]=t[n] )}} )( e, t )}; function r( e, t ) {if( 'function'!=typeof t&&null!==t ) {throw new TypeError( 'Class extends value '+String( t )+' is not a constructor or null' )}function r() {this.constructor=e}n( e, t ), e.prototype=null===t?Object.create( t ):( r.prototype=t.prototype, new r )}var i=function() {return( i=Object.assign||function( e ) {for( var t, n=1, r=arguments.length; n<r; n++ ) {for( var i in t=arguments[n] ) {Object.prototype.hasOwnProperty.call( t, i )&&( e[i]=t[i] )}}return e} ).apply( this, arguments )}; function o( e ) {var t='function'==typeof Symbol&&Symbol.iterator, n=t&&e[t], r=0; if( n ) {return n.call( e )}if( e&&'number'==typeof e.length ) {return{ next: function() {return{ value: ( e=e&&r>=e.length?void 0:e )&&e[r++], done: !e }} }}throw new TypeError( t?'Object is not iterable.':'Symbol.iterator is not defined.' )}function a( e, t ) {
        var n='function'==typeof Symbol&&e[Symbol.iterator]; if( !n ) {return e}var r, i, o=n.call( e ), a=[]; try{for( ;( void 0===t||0<t-- )&&!( r=o.next() ).done; ) {a.push( r.value )}}
        catch( e ) {i={ error: e }}
        finally{
          try{r&&!r.done&&( n=o.return )&&n.call( o )}
          finally{if( i ) {throw i.error}}
        }return a;
      }function s( e, t ) {for( var n=0, r=t.length, i=e.length; n<r; n++, i++ ) {e[i]=t[n]}return e}function u( e ) {for( var t=[], n=0, r=0; r<e.length; r++ ) {var i=e.charCodeAt( r ); i<128?t[n++]=i:( i<2048?t[n++]=i>>6|192:( 55296==( 64512&i )&&r+1<e.length&&56320==( 64512&e.charCodeAt( r+1 ) )?( i=65536+( ( 1023&i )<<10 )+( 1023&e.charCodeAt( ++r ) ), t[n++]=i>>18|240, t[n++]=i>>12&63|128 ):t[n++]=i>>12|224, t[n++]=i>>6&63|128 ), t[n++]=63&i|128 )}return t}function l( e ) {
        try{return f.decodeString( e, !0 )}
        catch( e ) {console.error( 'base64Decode failed: ', e )}return null;
      }var c=!1, h='${JSCORE_VERSION}', p=function( e, t ) {if( !e ) {throw d( t )}}, d=function( e ) {return new Error( 'Firebase Database ('+h+') INTERNAL ASSERT FAILED: '+e )}, f={ byteToCharMap_: null, charToByteMap_: null, byteToCharMapWebSafe_: null, charToByteMapWebSafe_: null, ENCODED_VALS_BASE: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789', get ENCODED_VALS() {return this.ENCODED_VALS_BASE+'+/='}, get ENCODED_VALS_WEBSAFE() {return this.ENCODED_VALS_BASE+'-_.'}, HAS_NATIVE_SUPPORT: 'function'==typeof atob, encodeByteArray: function( e, t ) {if( !Array.isArray( e ) ) {throw Error( 'encodeByteArray takes an array as a parameter' )}this.init_(); for( var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_, r=[], i=0; i<e.length; i+=3 ) {var o=e[i], a=i+1<e.length, s=a?e[i+1]:0, u=i+2<e.length, l=o>>2, c=( o=( 3&o )<<4|s>>4, s=( 15&s )<<2|( c=u?e[i+2]:0 )>>6, 63&c ); u||( c=64, a||( s=64 ) ), r.push( n[l], n[o], n[s], n[c] )}return r.join( '' )}, encodeString: function( e, t ) {return this.HAS_NATIVE_SUPPORT&&!t?btoa( e ):this.encodeByteArray( u( e ), t )}, decodeString: function( e, t ) {return this.HAS_NATIVE_SUPPORT&&!t?atob( e ):function( e ) {for( var t=[], n=0, r=0; n<e.length; ) {var i, o, a, s=e[n++]; s<128?t[r++]=String.fromCharCode( s ):191<s&&s<224?( o=e[n++], t[r++]=String.fromCharCode( ( 31&s )<<6|63&o ) ):239<s&&s<365?( i=( ( 7&s )<<18|( 63&( o=e[n++] ) )<<12|( 63&( a=e[n++] ) )<<6|63&e[n++] )-65536, t[r++]=String.fromCharCode( 55296+( i>>10 ) ), t[r++]=String.fromCharCode( 56320+( 1023&i ) ) ):( o=e[n++], a=e[n++], t[r++]=String.fromCharCode( ( 15&s )<<12|( 63&o )<<6|63&a ) )}return t.join( '' )}( this.decodeStringToByteArray( e, t ) )}, decodeStringToByteArray: function( e, t ) {this.init_(); for( var n=t?this.charToByteMapWebSafe_:this.charToByteMap_, r=[], i=0; i<e.length; ) {var o=n[e.charAt( i++ )], a=i<e.length?n[e.charAt( i )]:0, s=++i<e.length?n[e.charAt( i )]:64, u=++i<e.length?n[e.charAt( i )]:64; if( ++i, null==o||null==a||null==s||null==u ) {throw Error()}o=o<<2|a>>4, r.push( o ), 64!==s&&( a=a<<4&240|s>>2, r.push( a ), 64!==u&&( u|=s<<6&192, r.push( u ) ) )}return r}, init_: function() {if( !this.byteToCharMap_ ) {this.byteToCharMap_={}, this.charToByteMap_={}, this.byteToCharMapWebSafe_={}, this.charToByteMapWebSafe_={}; for( var e=0; e<this.ENCODED_VALS.length; e++ ) {this.byteToCharMap_[e]=this.ENCODED_VALS.charAt( e ), this.charToByteMap_[this.byteToCharMap_[e]]=e, this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt( e ), ( this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e )>=this.ENCODED_VALS_BASE.length&&( this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt( e )]=e, this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt( e )]=e )}}} }; function _( e ) {return'__proto__'!==e}var y=( v.prototype.wrapCallback=function( e ) {var t=this; return function( n, r ) {n?t.reject( n ):t.resolve( r ), 'function'==typeof e&&( t.promise.catch( ( function() {} ) ), 1===e.length?e( n ):e( n, r ) )}}, v ); function v() {var e=this; this.reject=function() {}, this.resolve=function() {}, this.promise=new Promise( ( function( t, n ) {e.resolve=t, e.reject=n} ) )}function g() {return'undefined'!=typeof window&&( window.cordova||window.phonegap||window.PhoneGap )&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test( 'undefined'!=typeof navigator&&'string'==typeof navigator.userAgent?navigator.userAgent:'' )}function m() {return!0===c}var w, b=( r( C, w=Error ), C ); function C( e, t, n ) {return( t=w.call( this, t )||this ).code=e, t.customData=n, t.name='FirebaseError', Object.setPrototypeOf( t, C.prototype ), Error.captureStackTrace&&Error.captureStackTrace( t, E.prototype.create ), t}var E=( I.prototype.create=function( e ) {for( var t=[], n=1; n<arguments.length; n++ ) {t[n-1]=arguments[n]}var r, i=t[0]||{}, o=this.service+'/'+e; e=( e=this.errors[e] )?( r=i, e.replace( S, ( function( e, t ) {var n=r[t]; return null!=n?String( n ):'<'+t+'?>'} ) ) ):'Error', e=this.serviceName+': '+e+' ('+o+').'; return new b( o, e, i )}, I ); function I( e, t, n ) {this.service=e, this.serviceName=t, this.errors=n}var S=/\{\$([^}]+)}/g; function T( e ) {return JSON.parse( e )}function N( e ) {return JSON.stringify( e )}function P( e ) {
        var t={}, n={}, r={}, i=''; try{var o=e.split( '.' ); t=T( l( o[0] )||'' ), n=T( l( o[1] )||'' ), i=o[2], r=n.d||{}; delete n.d}
        catch( e ) {}return{ header: t, claims: n, data: r, signature: i };
      }function R( e, t ) {return Object.prototype.hasOwnProperty.call( e, t )}function k( e, t ) {if( Object.prototype.hasOwnProperty.call( e, t ) ) {return e[t]}}function x( e ) {for( var t in e ) {if( Object.prototype.hasOwnProperty.call( e, t ) ) {return!1}}return!0}function O( e, t, n ) {var r, i={}; for( r in e ) {Object.prototype.hasOwnProperty.call( e, r )&&( i[r]=t.call( n, e[r], r, e ) )}return i}var D=( A.prototype.reset=function() {this.chain_[0]=1732584193, this.chain_[1]=4023233417, this.chain_[2]=2562383102, this.chain_[3]=271733878, this.chain_[4]=3285377520, this.inbuf_=0, this.total_=0}, A.prototype.compress_=function( e, t ) {
        t=t||0; var n=this.W_; if( 'string'==typeof e ) {for( var r=0; r<16; r++ ) {n[r]=e.charCodeAt( t )<<24|e.charCodeAt( t+1 )<<16|e.charCodeAt( t+2 )<<8|e.charCodeAt( t+3 ), t+=4}}
        else {for( r=0; r<16; r++ ) {n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3], t+=4}}for( r=16; r<80; r++ ) {var i=n[r-3]^n[r-8]^n[r-14]^n[r-16]; n[r]=4294967295&( i<<1|i>>>31 )}var o, a=this.chain_[0], s=this.chain_[1], u=this.chain_[2], l=this.chain_[3], c=this.chain_[4]; for( r=0; r<80; r++ ) {var h=r<40?r<20?( o=l^s&( u^l ), 1518500249 ):( o=s^u^l, 1859775393 ):r<60?( o=s&u|l&( s|u ), 2400959708 ):( o=s^u^l, 3395469782 ); i=( a<<5|a>>>27 )+o+c+h+n[r]&4294967295, c=l, l=u, u=4294967295&( s<<30|s>>>2 ), s=a, a=i}this.chain_[0]=this.chain_[0]+a&4294967295, this.chain_[1]=this.chain_[1]+s&4294967295, this.chain_[2]=this.chain_[2]+u&4294967295, this.chain_[3]=this.chain_[3]+l&4294967295, this.chain_[4]=this.chain_[4]+c&4294967295;
      }, A.prototype.update=function( e, t ) {
        if( null!=e ) {
          for( var n=( t=void 0===t?e.length:t )-this.blockSize, r=0, i=this.buf_, o=this.inbuf_; r<t; ) {
            if( 0===o ) {for( ;r<=n; ) {this.compress_( e, r ), r+=this.blockSize}}if( 'string'==typeof e ) {for( ;r<t; ) {if( i[o]=e.charCodeAt( r ), ++r, ++o===this.blockSize ) {this.compress_( i ), o=0; break}}}
            else {for( ;r<t; ) {if( i[o]=e[r], ++r, ++o===this.blockSize ) {this.compress_( i ), o=0; break}}}
          }this.inbuf_=o, this.total_+=t;
        }
      }, A.prototype.digest=function() {var e=[], t=8*this.total_; this.inbuf_<56?this.update( this.pad_, 56-this.inbuf_ ):this.update( this.pad_, this.blockSize-( this.inbuf_-56 ) ); for( var n=this.blockSize-1; 56<=n; n-- ) {this.buf_[n]=255&t, t/=256}this.compress_( this.buf_ ); var r=0; for( n=0; n<5; n++ ) {for( var i=24; 0<=i; i-=8 ) {e[r]=this.chain_[n]>>i&255, ++r}}return e}, A ); function A() {this.chain_=[], this.buf_=[], this.W_=[], this.pad_=[], this.inbuf_=0, this.total_=0, this.blockSize=64, this.pad_[0]=128; for( var e=1; e<this.blockSize; ++e ) {this.pad_[e]=0}this.reset()}function L( e, t, n, r ) {var i; if( r<t?i='at least '+t:n<r&&( i=0===n?'none':'no more than '+n ), i ) {throw new Error( e+' failed: Was called with '+r+( 1===r?' argument.':' arguments.' )+' Expects '+i+'.' )}}function F( e, t ) {return e+' failed: '+t+' argument '}function M( e, t, n, r ) {if( ( !r||n )&&'function'!=typeof n ) {throw new Error( F( e, t )+'must be a valid function.' )}}function q( e, t, n, r ) {if( ( !r||n )&&( 'object'!=typeof n||null===n ) ) {throw new Error( F( e, t )+'must be a valid context object.' )}}function j( e ) {for( var t=0, n=0; n<e.length; n++ ) {var r=e.charCodeAt( n ); r<128?t++:r<2048?t+=2:55296<=r&&r<=56319?( t+=4, n++ ):t+=3}return t}function W( e ) {return e&&e._delegate?e._delegate:e}var U=( B.prototype.setInstantiationMode=function( e ) {return this.instantiationMode=e, this}, B.prototype.setMultipleInstances=function( e ) {return this.multipleInstances=e, this}, B.prototype.setServiceProps=function( e ) {return this.serviceProps=e, this}, B.prototype.setInstanceCreatedCallback=function( e ) {return this.onInstanceCreated=e, this}, B ); function B( e, t, n ) {this.name=e, this.instanceFactory=t, this.type=n, this.multipleInstances=!1, this.serviceProps={}, this.instantiationMode='LAZY', this.onInstanceCreated=null}var z='[DEFAULT]', H=( V.prototype.get=function( e ) {
        void 0===e&&( e=z ); var t=this.normalizeInstanceIdentifier( e ); if( !this.instancesDeferred.has( t ) ) {
          var n=new y; if( this.instancesDeferred.set( t, n ), this.isInitialized( t )||this.shouldAutoInitialize() ) {
            try{var r=this.getOrInitializeService( { instanceIdentifier: t } ); r&&n.resolve( r )}
            catch( e ) {}
          }
        }return this.instancesDeferred.get( t ).promise;
      }, V.prototype.getImmediate=function( e ) {
        e=( t=i( { identifier: z, optional: !1 }, e ) ).identifier; var t=t.optional, n=this.normalizeInstanceIdentifier( e ); if( !this.isInitialized( n )&&!this.shouldAutoInitialize() ) {if( t ) {return null}throw Error( 'Service '+this.name+' is not available' )}try{return this.getOrInitializeService( { instanceIdentifier: n } )}
        catch( e ) {if( t ) {return null}throw e}
      }, V.prototype.getComponent=function() {return this.component}, V.prototype.setComponent=function( e ) {
        var t, n; if( e.name!==this.name ) {throw Error( 'Mismatching Component '+e.name+' for Provider '+this.name+'.' )}if( this.component ) {throw Error( 'Component for '+this.name+' has already been provided' )}if( this.component=e, this.shouldAutoInitialize() ) {
          if( 'EAGER'===e.instantiationMode ) {
            try{this.getOrInitializeService( { instanceIdentifier: z } )}
            catch( e ) {}
          }try{
            for( var r=o( this.instancesDeferred.entries() ), i=r.next(); !i.done; i=r.next() ) {
              var s=a( i.value, 2 ), u=s[0], l=s[1], c=this.normalizeInstanceIdentifier( u ); try{var h=this.getOrInitializeService( { instanceIdentifier: c } ); l.resolve( h )}
              catch( e ) {}
            }
          }
          catch( e ) {t={ error: e }}
          finally{
            try{i&&!i.done&&( n=r.return )&&n.call( r )}
            finally{if( t ) {throw t.error}}
          }
        }
      }, V.prototype.clearInstance=function( e ) {void 0===e&&( e=z ), this.instancesDeferred.delete( e ), this.instances.delete( e )}, V.prototype.delete=function() {
        return function( e, t, n, r ) {
          return new( n=n||Promise )( ( function( i, o ) {
            function a( e ) {
              try{u( r.next( e ) )}
              catch( e ) {o( e )}
            }function s( e ) {
              try{u( r.throw( e ) )}
              catch( e ) {o( e )}
            }function u( e ) {var t; e.done?i( e.value ):( ( t=e.value )instanceof n?t:new n( ( function( e ) {e( t )} ) ) ).then( a, s )}u( ( r=r.apply( e, t||[] ) ).next() );
          } ) );
        }( this, void 0, void 0, ( function() {
          var e; return function( e, t ) {
            var n, r, i, o={ label: 0, sent: function() {if( 1&i[0] ) {throw i[1]}return i[1]}, trys: [], ops: [] }, a={ next: s( 0 ), throw: s( 1 ), return: s( 2 ) }; return'function'==typeof Symbol&&( a[Symbol.iterator]=function() {return this} ), a; function s( a ) {
              return function( s ) {
                return function( a ) {
                  if( n ) {throw new TypeError( 'Generator is already executing.' )}for( ;o; ) {
                    try{if( n=1, r&&( i=2&a[0]?r.return:a[0]?r.throw||( ( i=r.return )&&i.call( r ), 0 ):r.next )&&!( i=i.call( r, a[1] ) ).done ) {return i}switch( r=0, ( a=i?[2&a[0], i.value]:a )[0] ) {case 0:case 1:i=a; break; case 4:return o.label++, { value: a[1], done: !1 }; case 5:o.label++, r=a[1], a=[0]; continue; case 7:a=o.ops.pop(), o.trys.pop(); continue; default:if( !( i=0<( i=o.trys ).length&&i[i.length-1] )&&( 6===a[0]||2===a[0] ) ) {o=0; continue}if( 3===a[0]&&( !i||a[1]>i[0]&&a[1]<i[3] ) ) {o.label=a[1]; break}if( 6===a[0]&&o.label<i[1] ) {o.label=i[1], i=a; break}if( i&&o.label<i[2] ) {o.label=i[2], o.ops.push( a ); break}i[2]&&o.ops.pop(), o.trys.pop(); continue;}a=t.call( e, o )}
                    catch( e ) {a=[6, e], r=0}
                    finally{n=i=0}
                  }if( 5&a[0] ) {throw a[1]}return{ value: a[0]?a[1]:void 0, done: !0 };
                }( [a, s] );
              };
            }
          }( this, ( function( t ) {switch( t.label ) {case 0:return e=Array.from( this.instances.values() ), [4, Promise.all( s( s( [], a( e.filter( ( function( e ) {return'INTERNAL'in e} ) ).map( ( function( e ) {return e.INTERNAL.delete()} ) ) ) ), a( e.filter( ( function( e ) {return'_delete'in e} ) ).map( ( function( e ) {return e._delete()} ) ) ) ) )]; case 1:return t.sent(), [2];}} ) );
        } ) );
      }, V.prototype.isComponentSet=function() {return null!=this.component}, V.prototype.isInitialized=function( e ) {return void 0===e&&( e=z ), this.instances.has( e )}, V.prototype.initialize=function( e ) {
        var t, n, r=void 0===( r=( e=void 0===e?{}:e ).instanceIdentifier )?z:r, i=( e=void 0===( e=e.options )?{}:e, this.normalizeInstanceIdentifier( r ) ); if( this.isInitialized( i ) ) {throw Error( this.name+'('+i+') has already been initialized' )}if( !this.isComponentSet() ) {throw Error( 'Component '+this.name+' has not been registered yet' )}var s=this.getOrInitializeService( { instanceIdentifier: i, options: e } ); try{for( var u=o( this.instancesDeferred.entries() ), l=u.next(); !l.done; l=u.next() ) {var c=( h=a( l.value, 2 ) )[0], h=h[1]; i===this.normalizeInstanceIdentifier( c )&&h.resolve( s )}}
        catch( e ) {t={ error: e }}
        finally{
          try{l&&!l.done&&( n=u.return )&&n.call( u )}
          finally{if( t ) {throw t.error}}
        }return s;
      }, V.prototype.getOrInitializeService=function( e ) {
        var t=e.instanceIdentifier, n=e.options, r=( e=void 0===n?{}:n, this.instances.get( t ) ); if( !r&&this.component&&( r=this.component.instanceFactory( this.container, { instanceIdentifier: ( n=t )===z?void 0:n, options: e } ), this.instances.set( t, r ), this.component.onInstanceCreated ) ) {
          try{this.component.onInstanceCreated( this.container, t, r )}
          catch( e ) {}
        }return r||null;
      }, V.prototype.normalizeInstanceIdentifier=function( e ) {return!this.component||this.component.multipleInstances?e:z}, V.prototype.shouldAutoInitialize=function() {return!!this.component&&'EXPLICIT'!==this.component.instantiationMode}, V ); function V( e, t ) {this.name=e, this.container=t, this.component=null, this.instances=new Map, this.instancesDeferred=new Map}var Q, Y=( G.prototype.addComponent=function( e ) {var t=this.getProvider( e.name ); if( t.isComponentSet() ) {throw new Error( 'Component '+e.name+' has already been registered with '+this.name )}t.setComponent( e )}, G.prototype.addOrOverwriteComponent=function( e ) {this.getProvider( e.name ).isComponentSet()&&this.providers.delete( e.name ), this.addComponent( e )}, G.prototype.getProvider=function( e ) {if( this.providers.has( e ) ) {return this.providers.get( e )}var t=new H( e, this ); return this.providers.set( e, t ), t}, G.prototype.getProviders=function() {return Array.from( this.providers.values() )}, G ); function G( e ) {this.name=e, this.providers=new Map}function K( e, t ) {for( var n=[], r=2; r<arguments.length; r++ ) {n[r-2]=arguments[r]}if( !( t<e.logLevel ) ) {var i=( new Date ).toISOString(), o=X[t]; if( !o ) {throw new Error( 'Attempted to log a message with an invalid logType (value: '+t+')' )}console[o].apply( console, s( ['['+i+']  '+e.name+':'], n ) )}}( pt=Q=Q||{} )[pt.DEBUG=0]='DEBUG', pt[pt.VERBOSE=1]='VERBOSE', pt[pt.INFO=2]='INFO', pt[pt.WARN=3]='WARN', pt[pt.ERROR=4]='ERROR', pt[pt.SILENT=5]='SILENT'; var $={ debug: Q.DEBUG, verbose: Q.VERBOSE, info: Q.INFO, warn: Q.WARN, error: Q.ERROR, silent: Q.SILENT }, J=Q.INFO, X=( ( ft={} )[Q.DEBUG]='log', ft[Q.VERBOSE]='log', ft[Q.INFO]='info', ft[Q.WARN]='warn', ft[Q.ERROR]='error', ft ), Z=( Object.defineProperty( ee.prototype, 'logLevel', { get: function() {return this._logLevel}, set: function( e ) {if( !( e in Q ) ) {throw new TypeError( 'Invalid value "'+e+'" assigned to `logLevel`' )}this._logLevel=e}, enumerable: !1, configurable: !0 } ), ee.prototype.setLogLevel=function( e ) {this._logLevel='string'==typeof e?$[e]:e}, Object.defineProperty( ee.prototype, 'logHandler', { get: function() {return this._logHandler}, set: function( e ) {if( 'function'!=typeof e ) {throw new TypeError( 'Value assigned to `logHandler` must be a function' )}this._logHandler=e}, enumerable: !1, configurable: !0 } ), Object.defineProperty( ee.prototype, 'userLogHandler', { get: function() {return this._userLogHandler}, set: function( e ) {this._userLogHandler=e}, enumerable: !1, configurable: !0 } ), ee.prototype.debug=function() {for( var e=[], t=0; t<arguments.length; t++ ) {e[t]=arguments[t]}this._userLogHandler&&this._userLogHandler.apply( this, s( [this, Q.DEBUG], e ) ), this._logHandler.apply( this, s( [this, Q.DEBUG], e ) )}, ee.prototype.log=function() {for( var e=[], t=0; t<arguments.length; t++ ) {e[t]=arguments[t]}this._userLogHandler&&this._userLogHandler.apply( this, s( [this, Q.VERBOSE], e ) ), this._logHandler.apply( this, s( [this, Q.VERBOSE], e ) )}, ee.prototype.info=function() {for( var e=[], t=0; t<arguments.length; t++ ) {e[t]=arguments[t]}this._userLogHandler&&this._userLogHandler.apply( this, s( [this, Q.INFO], e ) ), this._logHandler.apply( this, s( [this, Q.INFO], e ) )}, ee.prototype.warn=function() {for( var e=[], t=0; t<arguments.length; t++ ) {e[t]=arguments[t]}this._userLogHandler&&this._userLogHandler.apply( this, s( [this, Q.WARN], e ) ), this._logHandler.apply( this, s( [this, Q.WARN], e ) )}, ee.prototype.error=function() {for( var e=[], t=0; t<arguments.length; t++ ) {e[t]=arguments[t]}this._userLogHandler&&this._userLogHandler.apply( this, s( [this, Q.ERROR], e ) ), this._logHandler.apply( this, s( [this, Q.ERROR], e ) )}, ee ); function ee( e ) {this.name=e, this._logLevel=J, this._logHandler=K, this._userLogHandler=null}var te=( ne.prototype.set=function( e, t ) {null==t?this.domStorage_.removeItem( this.prefixedName_( e ) ):this.domStorage_.setItem( this.prefixedName_( e ), N( t ) )}, ne.prototype.get=function( e ) {return null==( e=this.domStorage_.getItem( this.prefixedName_( e ) ) )?null:T( e )}, ne.prototype.remove=function( e ) {this.domStorage_.removeItem( this.prefixedName_( e ) )}, ne.prototype.prefixedName_=function( e ) {return this.prefix_+e}, ne.prototype.toString=function() {return this.domStorage_.toString()}, ne ); function ne( e ) {this.domStorage_=e, this.prefix_='firebase:'}var re=( ie.prototype.set=function( e, t ) {null==t?delete this.cache_[e]:this.cache_[e]=t}, ie.prototype.get=function( e ) {return R( this.cache_, e )?this.cache_[e]:null}, ie.prototype.remove=function( e ) {delete this.cache_[e]}, ie ); function ie() {this.cache_={}, this.isInMemoryStorage=!0}function oe( e ) {var t=function( e ) {for( var t=[], n=0, r=0; r<e.length; r++ ) {var i, o=e.charCodeAt( r ); 55296<=o&&o<=56319&&( i=o-55296, p( ++r<e.length, 'Surrogate pair missing trail surrogate.' ), o=65536+( i<<10 )+( e.charCodeAt( r )-56320 ) ), o<128?t[n++]=o:( o<2048?t[n++]=o>>6|192:( o<65536?t[n++]=o>>12|224:( t[n++]=o>>18|240, t[n++]=o>>12&63|128 ), t[n++]=o>>6&63|128 ), t[n++]=63&o|128 )}return t}( e ); return( e=new D ).update( t ), e=e.digest(), f.encodeByteArray( e )}function ae() {for( var e=[], t=0; t<arguments.length; t++ ) {e[t]=arguments[t]}var n='FIREBASE INTERNAL ERROR: '+ye.apply( void 0, s( [], a( e ) ) ); fe.error( n )}function se( e ) {return'number'==typeof e&&( e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY )}function ue( e, t ) {return e===t?0:e<t?-1:1}function le( e, t ) {if( t&&e in t ) {return t[e]}throw new Error( 'Missing required key ('+e+') in object: '+N( t ) )}function ce( e, t ) {var n=e.length; if( n<=t ) {return[e]}for( var r=[], i=0; i<n; i+=t ) {n<i+t?r.push( e.substring( i, n ) ):r.push( e.substring( i, i+t ) )}return r}var he, pe=( Gt=function( e ) {
          try{if( 'undefined'!=typeof window&&void 0!==window[e] ) {var t=window[e]; return t.setItem( 'firebase:sentinel', 'cache' ), t.removeItem( 'firebase:sentinel' ), new te( t )}}
          catch( e ) {}return new re;
        } )( 'localStorage' ), de=Gt( 'sessionStorage' ), fe=new Z( '@firebase/database' ), _e=( he=1, function() {return he++} ), ye=function() {for( var e=[], t=0; t<arguments.length; t++ ) {e[t]=arguments[t]}for( var n='', r=0; r<e.length; r++ ) {var i=e[r]; Array.isArray( i )||i&&'object'==typeof i&&'number'==typeof i.length?n+=ye.apply( null, i ):n+='object'==typeof i?N( i ):i, n+=' '}return n}, ve=null, ge=!0, me=function( e, t ) {p( !t||!0===e||!1===e, 'Can\'t turn on custom loggers persistently.' ), !0===e?( fe.logLevel=Q.VERBOSE, ve=fe.log.bind( fe ), t&&de.set( 'logging_enabled', !0 ) ):'function'==typeof e?ve=e:( ve=null, de.remove( 'logging_enabled' ) )}, we=function() {for( var e, t=[], n=0; n<arguments.length; n++ ) {t[n]=arguments[n]}!0===ge&&( ge=!1, null===ve&&!0===de.get( 'logging_enabled' )&&me( !0 ) ), ve&&( e=ye.apply( null, t ), ve( e ) )}, be=function( e ) {return function() {for( var t=[], n=0; n<arguments.length; n++ ) {t[n]=arguments[n]}we.apply( void 0, s( [e], a( t ) ) )}}, Ce=function() {for( var e=[], t=0; t<arguments.length; t++ ) {e[t]=arguments[t]}var n='FIREBASE FATAL ERROR: '+ye.apply( void 0, s( [], a( e ) ) ); throw fe.error( n ), new Error( n )}, Ee=function() {for( var e=[], t=0; t<arguments.length; t++ ) {e[t]=arguments[t]}var n='FIREBASE WARNING: '+ye.apply( void 0, s( [], a( e ) ) ); fe.warn( n )}, Ie='[MIN_NAME]', Se='[MAX_NAME]', Te=function( e, t ) {if( e===t ) {return 0}if( e===Ie||t===Se ) {return-1}if( t===Ie||e===Se ) {return 1}var n=Ae( e ), r=Ae( t ); return null!==n?null!==r?n-r==0?e.length-t.length:n-r:-1:null===r&&e<t?-1:1}, Ne=function( e ) {if( 'object'!=typeof e||null===e ) {return N( e )}var t, n=[]; for( t in e ) {n.push( t )}n.sort(); for( var r='{', i=0; i<n.length; i++ ) {0!==i&&( r+=',' ), r+=N( n[i] ), r+=':', r+=Ne( e[n[i]] )}return r+'}'}; function Pe( e, t ) {for( var n in e ) {e.hasOwnProperty( n )&&t( n, e[n] )}}function Re( e ) {var t, n, r, i; p( !se( e ), 'Invalid JSON number' ), 0===e?t=1/e==-1/( r=n=0 )?1:0:( t=e<0, r=( e=Math.abs( e ) )>=Math.pow( 2, -1022 )?( n=( i=Math.min( Math.floor( Math.log( e )/Math.LN2 ), 1023 ) )+1023, Math.round( e*Math.pow( 2, 52-i )-Math.pow( 2, 52 ) ) ):( n=0, Math.round( e/Math.pow( 2, -1074 ) ) ) ); for( var o=[], a=52; a; --a ) {o.push( r%2?1:0 ), r=Math.floor( r/2 )}for( a=11; a; --a ) {o.push( n%2?1:0 ), n=Math.floor( n/2 )}o.push( t?1:0 ), o.reverse(); var s=o.join( '' ), u=''; for( a=0; a<64; a+=8 ) {var l=parseInt( s.substr( a, 8 ), 2 ).toString( 16 ); u+=l=1===l.length?'0'+l:l}return u.toLowerCase()}function ke( e, t ) {return'object'==typeof( t=setTimeout( e, t ) )&&t.unref&&t.unref(), t}var xe=new RegExp( '^-?(0*)\\d{1,10}$' ), Oe=-2147483648, De=2147483647, Ae=function( e ) {return xe.test( e )&&( e=Number( e ), Oe<=e&&e<=De )?e:null}, Le=function( e ) {
          try{e()}
          catch( e ) {setTimeout( ( function() {var t=e.stack||''; throw Ee( 'Exception was thrown by user callback.', t ), e} ), Math.floor( 0 ) )}
        }, Fe=( Me.prototype.getToken=function( e ) {return this.auth_?this.auth_.getToken( e ).catch( ( function( e ) {return e&&'auth/token-not-initialized'===e.code?( we( 'Got auth/token-not-initialized error.  Treating as null token.' ), null ):Promise.reject( e )} ) ):Promise.resolve( null )}, Me.prototype.addTokenChangeListener=function( e ) {this.auth_?this.auth_.addAuthTokenListener( e ):( setTimeout( ( function() {return e( null )} ), 0 ), this.authProvider_.get().then( ( function( t ) {return t.addAuthTokenListener( e )} ) ) )}, Me.prototype.removeTokenChangeListener=function( e ) {this.authProvider_.get().then( ( function( t ) {return t.removeAuthTokenListener( e )} ) )}, Me.prototype.notifyForInvalidToken=function() {var e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. '; 'credential'in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'serviceAccount'in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.', Ee( e )}, Me ); function Me( e, t, n ) {var r=this; this.appName_=e, this.firebaseOptions_=t, this.authProvider_=n, this.auth_=null, this.auth_=n.getImmediate( { optional: !0 } ), this.auth_||n.get().then( ( function( e ) {return r.auth_=e} ) )}var qe=( je.prototype.getToken=function( e ) {return Promise.resolve( { accessToken: je.EMULATOR_AUTH_TOKEN } )}, je.prototype.addTokenChangeListener=function( e ) {e( je.EMULATOR_AUTH_TOKEN )}, je.prototype.removeTokenChangeListener=function( e ) {}, je.prototype.notifyForInvalidToken=function() {}, je.EMULATOR_AUTH_TOKEN='owner', je ); function je() {}var We=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/, Ue='websocket', Be='long_polling', ze=( He.prototype.isCacheableHost=function() {return's-'===this.internalHost.substr( 0, 2 )}, He.prototype.isCustomHost=function() {return'firebaseio.com'!==this._domain&&'firebaseio-demo.com'!==this._domain}, Object.defineProperty( He.prototype, 'host', { get: function() {return this._host}, set: function( e ) {e!==this.internalHost&&( this.internalHost=e, this.isCacheableHost()&&pe.set( 'host:'+this._host, this.internalHost ) )}, enumerable: !1, configurable: !0 } ), He.prototype.toString=function() {var e=this.toURLString(); return this.persistenceKey&&( e+='<'+this.persistenceKey+'>' ), e}, He.prototype.toURLString=function() {var e=this.secure?'https://':'http://', t=this.includeNamespaceInQueryParams?'?ns='+this.namespace:''; return e+this.host+'/'+t}, He ); function He( e, t, n, r, i, o, a ) {void 0===i&&( i=!1 ), void 0===o&&( o='' ), void 0===a&&( a=!1 ), this.secure=t, this.namespace=n, this.webSocketOnly=r, this.nodeAdmin=i, this.persistenceKey=o, this.includeNamespaceInQueryParams=a, this._host=e.toLowerCase(), this._domain=this._host.substr( this._host.indexOf( '.' )+1 ), this.internalHost=pe.get( 'host:'+e )||this._host}function Ve( e, t, n ) {
        var r; if( p( 'string'==typeof t, 'typeof type must == string' ), p( 'object'==typeof n, 'typeof params must == object' ), t===Ue ) {r=( e.secure?'wss://':'ws://' )+e.internalHost+'/.ws?'}
        else{if( t!==Be ) {throw new Error( 'Unknown connection type: '+t )}r=( e.secure?'https://':'http://' )+e.internalHost+'/.lp?'}( ( t=e ).host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams )&&( n.ns=e.namespace ); var i=[]; return Pe( n, ( function( e, t ) {i.push( e+'='+t )} ) ), r+i.join( '&' );
      }var Qe=( Ye.prototype.incrementCounter=function( e, t ) {void 0===t&&( t=1 ), R( this.counters_, e )||( this.counters_[e]=0 ), this.counters_[e]+=t}, Ye.prototype.get=function() {return function( e ) {return function e( t, n ) {if( !( n instanceof Object ) ) {return n}switch( n.constructor ) {case Date:return new Date( n.getTime() ); case Object:void 0===t&&( t={} ); break; case Array:t=[]; break; default:return n;}for( var r in n ) {n.hasOwnProperty( r )&&_( r )&&( t[r]=e( t[r], n[r] ) )}return t}( void 0, e )}( this.counters_ )}, Ye ); function Ye() {this.counters_={}}var Ge={}, Ke={}; function $e( e ) {return e=e.toString(), Ge[e]||( Ge[e]=new Qe ), Ge[e]}var Je=( Xe.prototype.closeAfter=function( e, t ) {this.closeAfterResponse=e, this.onClose=t, this.closeAfterResponse<this.currentResponseNum&&( this.onClose(), this.onClose=null )}, Xe.prototype.handleResponse=function( e, t ) {var n=this; this.pendingResponses[e]=t; for( var r=this; this.pendingResponses[this.currentResponseNum]&&'break'!==function() {var e=r.pendingResponses[r.currentResponseNum]; delete r.pendingResponses[r.currentResponseNum]; for( var t=0; t<e.length; ++t ) {!function( t ) {e[t]&&Le( ( function() {n.onMessage_( e[t] )} ) )}( t )}if( r.currentResponseNum===r.closeAfterResponse ) {return r.onClose&&( r.onClose(), r.onClose=null ), 'break'}r.currentResponseNum++}(); ) {}}, Xe ); function Xe( e ) {this.onMessage_=e, this.pendingResponses=[], this.currentResponseNum=0, this.closeAfterResponse=-1, this.onClose=null}var Ze=( et.prototype.open=function( e, t ) {
        var n, r, i, o=this; this.curSegmentNum=0, this.onDisconnect_=t, this.myPacketOrderer=new Je( e ), this.isClosed_=!1, this.connectTimeoutTimer_=setTimeout( ( function() {o.log_( 'Timed out trying to connect.' ), o.onClosed_(), o.connectTimeoutTimer_=null} ), Math.floor( 3e4 ) ), n=function() {
          var e; o.isClosed_||( o.scriptTagHolder=new tt( ( function() {
            for( var e=[], t=0; t<arguments.length; t++ ) {e[t]=arguments[t]}var n=a( e, 5 ), r=n[0], i=n[1], s=n[2]; if( n[3], n[4], o.incrementIncomingBytes_( e ), o.scriptTagHolder ) {
              if( o.connectTimeoutTimer_&&( clearTimeout( o.connectTimeoutTimer_ ), o.connectTimeoutTimer_=null ), o.everConnected_=!0, 'start'===r ) {o.id=i, o.password=s}
              else{if( 'close'!==r ) {throw new Error( 'Unrecognized command received: '+r )}i?( o.scriptTagHolder.sendNewPolls=!1, o.myPacketOrderer.closeAfter( i, ( function() {o.onClosed_()} ) ) ):o.onClosed_()}
            }
          } ), ( function() {for( var e=[], t=0; t<arguments.length; t++ ) {e[t]=arguments[t]}var n=( r=a( e, 2 ) )[0], r=r[1]; o.incrementIncomingBytes_( e ), o.myPacketOrderer.handleResponse( n, r )} ), ( function() {o.onClosed_()} ), o.urlFn ), ( e={ start: 't' } ).ser=Math.floor( 1e8*Math.random() ), o.scriptTagHolder.uniqueCallbackIdentifier&&( e.cb=o.scriptTagHolder.uniqueCallbackIdentifier ), e.v='5', o.transportSessionId&&( e.s=o.transportSessionId ), o.lastSessionId&&( e.ls=o.lastSessionId ), o.applicationId&&( e.p=o.applicationId ), 'undefined'!=typeof location&&location.hostname&&We.test( location.hostname )&&( e.r='f' ), e=o.urlFn( e ), o.log_( 'Connecting via long-poll to '+e ), o.scriptTagHolder.addTag( e, ( function() {} ) ) );
        }, 'complete'===document.readyState?n():( r=!1, i=function() {document.body?r||( r=!0, n() ):setTimeout( i, Math.floor( 10 ) )}, document.addEventListener?( document.addEventListener( 'DOMContentLoaded', i, !1 ), window.addEventListener( 'load', i, !1 ) ):document.attachEvent&&( document.attachEvent( 'onreadystatechange', ( function() {'complete'===document.readyState&&i()} ) ), window.attachEvent( 'onload', i ) ) );
      }, et.prototype.start=function() {this.scriptTagHolder.startLongPoll( this.id, this.password ), this.addDisconnectPingFrame( this.id, this.password )}, et.forceAllow=function() {et.forceAllow_=!0}, et.forceDisallow=function() {et.forceDisallow_=!0}, et.isAvailable=function() {return!!et.forceAllow_||!( et.forceDisallow_||'undefined'==typeof document||null==document.createElement||'object'==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test( window.location.href )||'object'==typeof Windows&&'object'==typeof Windows.UI )}, et.prototype.markConnectionHealthy=function() {}, et.prototype.shutdown_=function() {this.isClosed_=!0, this.scriptTagHolder&&( this.scriptTagHolder.close(), this.scriptTagHolder=null ), this.myDisconnFrame&&( document.body.removeChild( this.myDisconnFrame ), this.myDisconnFrame=null ), this.connectTimeoutTimer_&&( clearTimeout( this.connectTimeoutTimer_ ), this.connectTimeoutTimer_=null )}, et.prototype.onClosed_=function() {this.isClosed_||( this.log_( 'Longpoll is closing itself' ), this.shutdown_(), this.onDisconnect_&&( this.onDisconnect_( this.everConnected_ ), this.onDisconnect_=null ) )}, et.prototype.close=function() {this.isClosed_||( this.log_( 'Longpoll is being closed.' ), this.shutdown_() )}, et.prototype.send=function( e ) {e=N( e ), this.bytesSent+=e.length, this.stats_.incrementCounter( 'bytes_sent', e.length ); for( var t=ce( e=function( e ) {return e=u( e ), f.encodeByteArray( e, !0 )}( e ), 1840 ), n=0; n<t.length; n++ ) {this.scriptTagHolder.enqueueSegment( this.curSegmentNum, t.length, t[n] ), this.curSegmentNum++}}, et.prototype.addDisconnectPingFrame=function( e, t ) {this.myDisconnFrame=document.createElement( 'iframe' ); var n={ dframe: 't' }; n.id=e, n.pw=t, this.myDisconnFrame.src=this.urlFn( n ), this.myDisconnFrame.style.display='none', document.body.appendChild( this.myDisconnFrame )}, et.prototype.incrementIncomingBytes_=function( e ) {e=N( e ).length, this.bytesReceived+=e, this.stats_.incrementCounter( 'bytes_received', e )}, et ); function et( e, t, n, r, i ) {this.connId=e, this.repoInfo=t, this.applicationId=n, this.transportSessionId=r, this.lastSessionId=i, this.bytesSent=0, this.bytesReceived=0, this.everConnected_=!1, this.log_=be( e ), this.stats_=$e( t ), this.urlFn=function( e ) {return Ve( t, Be, e )}}var tt=( nt.createIFrame_=function() {
        var e=document.createElement( 'iframe' ); if( e.style.display='none', !document.body ) {throw'Document body has not initialized. Wait to initialize Firebase until after the document is ready.'}document.body.appendChild( e ); try{e.contentWindow.document||we( 'No IE domain setting required' )}
        catch( n ) {var t=document.domain; e.src='javascript:void((function(){document.open();document.domain=\''+t+'\';document.close();})())'}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&( e.doc=e.document ), e;
      }, nt.prototype.close=function() {var e=this; this.alive=!1, this.myIFrame&&( this.myIFrame.doc.body.innerHTML='', setTimeout( ( function() {null!==e.myIFrame&&( document.body.removeChild( e.myIFrame ), e.myIFrame=null )} ), Math.floor( 0 ) ) ); var t=this.onDisconnect; t&&( this.onDisconnect=null, t() )}, nt.prototype.startLongPoll=function( e, t ) {for( this.myID=e, this.myPW=t, this.alive=!0; this.newRequest_(); ) {}}, nt.prototype.newRequest_=function() {if( this.alive&&this.sendNewPolls&&this.outstandingRequests.size<( 0<this.pendingSegs.length?2:1 ) ) {this.currentSerial++, ( e={} ).id=this.myID, e.pw=this.myPW, e.ser=this.currentSerial; for( var e=this.urlFn( e ), t='', n=0; 0<this.pendingSegs.length&&this.pendingSegs[0].d.length+30+t.length<=1870; ) {var r=this.pendingSegs.shift(); t=t+'&seg'+n+'='+r.seg+'&ts'+n+'='+r.ts+'&d'+n+'='+r.d; n++}return e+=t, this.addLongPollTag_( e, this.currentSerial ), !0}return!1}, nt.prototype.enqueueSegment=function( e, t, n ) {this.pendingSegs.push( { seg: e, ts: t, d: n } ), this.alive&&this.newRequest_()}, nt.prototype.addLongPollTag_=function( e, t ) {var n=this; function r() {n.outstandingRequests.delete( t ), n.newRequest_()}this.outstandingRequests.add( t ); var i=setTimeout( r, Math.floor( 25e3 ) ); this.addTag( e, ( function() {clearTimeout( i ), r()} ) )}, nt.prototype.addTag=function( e, t ) {
        var n=this; setTimeout( ( function() {
          try{if( !n.sendNewPolls ) {return}var r=n.myIFrame.doc.createElement( 'script' ); r.type='text/javascript', r.async=!0, r.src=e, r.onload=r.onreadystatechange=function() {var e=r.readyState; e&&'loaded'!==e&&'complete'!==e||( r.onload=r.onreadystatechange=null, r.parentNode&&r.parentNode.removeChild( r ), t() )}, r.onerror=function() {we( 'Long-poll script failed to load: '+e ), n.sendNewPolls=!1, n.close()}, n.myIFrame.doc.body.appendChild( r )}
          catch( e ) {}
        } ), Math.floor( 1 ) );
      }, nt ); function nt( e, t, n, r ) {
        this.onDisconnect=n, this.urlFn=r, this.outstandingRequests=new Set, this.pendingSegs=[], this.currentSerial=Math.floor( 1e8*Math.random() ), this.sendNewPolls=!0, this.uniqueCallbackIdentifier=_e(), window['pLPCommand'+this.uniqueCallbackIdentifier]=e, window['pRTLPCB'+this.uniqueCallbackIdentifier]=t, this.myIFrame=nt.createIFrame_(); t=''; var i='<html><body>'+( t=this.myIFrame.src&&'javascript:'===this.myIFrame.src.substr( 0, 'javascript:'.length )?'<script>document.domain="'+document.domain+'";<\/script>':t )+'</body></html>'; try{this.myIFrame.doc.open(), this.myIFrame.doc.write( i ), this.myIFrame.doc.close()}
        catch( e ) {we( 'frame writing exception' ), e.stack&&we( e.stack ), we( e )}
      }var rt=''; function it( e ) {rt=e}var ot=null; 'undefined'!=typeof MozWebSocket?ot=MozWebSocket:'undefined'!=typeof WebSocket&&( ot=WebSocket ); var at=( st.connectionURL_=function( e, t, n ) {var r={ v: '5' }; return'undefined'!=typeof location&&location.hostname&&We.test( location.hostname )&&( r.r='f' ), t&&( r.s=t ), n&&( r.ls=n ), Ve( e, Ue, r )}, st.prototype.open=function( e, t ) {
        var n, r=this; this.onDisconnect=t, this.onMessage=e, this.log_( 'Websocket connecting to '+this.connURL ), this.everConnected_=!1, pe.set( 'previous_websocket_failure', !0 ); try{m()||( n={ headers: { 'X-Firebase-GMPID': this.applicationId||'' } }, this.mySock=new ot( this.connURL, [], n ) )}
        catch( t ) {return this.log_( 'Error instantiating WebSocket.' ), ( e=t.message||t.data )&&this.log_( e ), void this.onClosed_()}this.mySock.onopen=function() {r.log_( 'Websocket connected.' ), r.everConnected_=!0}, this.mySock.onclose=function() {r.log_( 'Websocket connection was disconnected.' ), r.mySock=null, r.onClosed_()}, this.mySock.onmessage=function( e ) {r.handleIncomingFrame( e )}, this.mySock.onerror=function( e ) {r.log_( 'WebSocket error.  Closing connection.' ), ( e=e.message||e.data )&&r.log_( e ), r.onClosed_()};
      }, st.prototype.start=function() {}, st.forceDisallow=function() {st.forceDisallow_=!0}, st.isAvailable=function() {var e, t=!1; return'undefined'!=typeof navigator&&navigator.userAgent&&( e=navigator.userAgent.match( /Android ([0-9]{0,}\.[0-9]{0,})/ ) )&&1<e.length&&parseFloat( e[1] )<4.4&&( t=!0 ), !t&&null!==ot&&!st.forceDisallow_}, st.previouslyFailed=function() {return pe.isInMemoryStorage||!0===pe.get( 'previous_websocket_failure' )}, st.prototype.markConnectionHealthy=function() {pe.remove( 'previous_websocket_failure' )}, st.prototype.appendFrame_=function( e ) {this.frames.push( e ), this.frames.length===this.totalFrames&&( e=this.frames.join( '' ), this.frames=null, e=T( e ), this.onMessage( e ) )}, st.prototype.handleNewFrameCount_=function( e ) {this.totalFrames=e, this.frames=[]}, st.prototype.extractFrameCount_=function( e ) {if( p( null===this.frames, 'We already have a frame buffer' ), e.length<=6 ) {var t=Number( e ); if( !isNaN( t ) ) {return this.handleNewFrameCount_( t ), null}}return this.handleNewFrameCount_( 1 ), e}, st.prototype.handleIncomingFrame=function( e ) {null!==this.mySock&&( e=e.data, this.bytesReceived+=e.length, this.stats_.incrementCounter( 'bytes_received', e.length ), this.resetKeepAlive(), ( null!==this.frames||null!==( e=this.extractFrameCount_( e ) ) )&&this.appendFrame_( e ) )}, st.prototype.send=function( e ) {this.resetKeepAlive(), e=N( e ), this.bytesSent+=e.length, this.stats_.incrementCounter( 'bytes_sent', e.length ); var t=ce( e, 16384 ); 1<t.length&&this.sendString_( String( t.length ) ); for( var n=0; n<t.length; n++ ) {this.sendString_( t[n] )}}, st.prototype.shutdown_=function() {this.isClosed_=!0, this.keepaliveTimer&&( clearInterval( this.keepaliveTimer ), this.keepaliveTimer=null ), this.mySock&&( this.mySock.close(), this.mySock=null )}, st.prototype.onClosed_=function() {this.isClosed_||( this.log_( 'WebSocket is closing itself' ), this.shutdown_(), this.onDisconnect&&( this.onDisconnect( this.everConnected_ ), this.onDisconnect=null ) )}, st.prototype.close=function() {this.isClosed_||( this.log_( 'WebSocket is being closed' ), this.shutdown_() )}, st.prototype.resetKeepAlive=function() {var e=this; clearInterval( this.keepaliveTimer ), this.keepaliveTimer=setInterval( ( function() {e.mySock&&e.sendString_( '0' ), e.resetKeepAlive()} ), Math.floor( 45e3 ) )}, st.prototype.sendString_=function( e ) {
        try{this.mySock.send( e )}
        catch( e ) {this.log_( 'Exception thrown from WebSocket.send():', e.message||e.data, 'Closing connection.' ), setTimeout( this.onClosed_.bind( this ), 0 )}
      }, st.responsesRequiredToBeHealthy=2, st.healthyTimeout=3e4, st ); function st( e, t, n, r, i ) {this.connId=e, this.applicationId=n, this.keepaliveTimer=null, this.frames=null, this.totalFrames=0, this.bytesSent=0, this.bytesReceived=0, this.log_=be( this.connId ), this.stats_=$e( t ), this.connURL=st.connectionURL_( t, r, i ), this.nodeAdmin=t.nodeAdmin}var ut=( Object.defineProperty( lt, 'ALL_TRANSPORTS', { get: function() {return[Ze, at]}, enumerable: !1, configurable: !0 } ), lt.prototype.initTransports_=function( e ) {
        var t, n, r=at&&at.isAvailable(), i=r&&!at.previouslyFailed(); if( e.webSocketOnly&&( r||Ee( 'wss:// URL used, but browser isn\'t known to support websockets.  Trying anyway.' ), i=!0 ), i ) {this.transports_=[at]}
        else{
          var a=this.transports_=[]; try{for( var s=o( lt.ALL_TRANSPORTS ), u=s.next(); !u.done; u=s.next() ) {var l=u.value; l&&l.isAvailable()&&a.push( l )}}
          catch( e ) {t={ error: e }}
          finally{
            try{u&&!u.done&&( n=s.return )&&n.call( s )}
            finally{if( t ) {throw t.error}}
          }
        }
      }, lt.prototype.initialTransport=function() {if( 0<this.transports_.length ) {return this.transports_[0]}throw new Error( 'No transports available' )}, lt.prototype.upgradeTransport=function() {return 1<this.transports_.length?this.transports_[1]:null}, lt ); function lt( e ) {this.initTransports_( e )}var ct=( ht.prototype.start_=function() {var e=this, t=this.transportManager_.initialTransport(); this.conn_=new t( this.nextTransportId_(), this.repoInfo_, this.applicationId_, void 0, this.lastSessionId ), this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0; var n=this.connReceiver_( this.conn_ ), r=this.disconnReceiver_( this.conn_ ); this.tx_=this.conn_, this.rx_=this.conn_, this.secondaryConn_=null, this.isHealthy_=!1, setTimeout( ( function() {e.conn_&&e.conn_.open( n, r )} ), Math.floor( 0 ) ), 0<( t=t.healthyTimeout||0 )&&( this.healthyTimeout_=ke( ( function() {e.healthyTimeout_=null, e.isHealthy_||( e.conn_&&102400<e.conn_.bytesReceived?( e.log_( 'Connection exceeded healthy timeout but has received '+e.conn_.bytesReceived+' bytes.  Marking connection healthy.' ), e.isHealthy_=!0, e.conn_.markConnectionHealthy() ):e.conn_&&10240<e.conn_.bytesSent?e.log_( 'Connection exceeded healthy timeout but has sent '+e.conn_.bytesSent+' bytes.  Leaving connection alive.' ):( e.log_( 'Closing unhealthy connection after timeout.' ), e.close() ) )} ), Math.floor( t ) ) )}, ht.prototype.nextTransportId_=function() {return'c:'+this.id+':'+this.connectionCount++}, ht.prototype.disconnReceiver_=function( e ) {var t=this; return function( n ) {e===t.conn_?t.onConnectionLost_( n ):e===t.secondaryConn_?( t.log_( 'Secondary connection lost.' ), t.onSecondaryConnectionLost_() ):t.log_( 'closing an old connection' )}}, ht.prototype.connReceiver_=function( e ) {var t=this; return function( n ) {2!==t.state_&&( e===t.rx_?t.onPrimaryMessageReceived_( n ):e===t.secondaryConn_?t.onSecondaryMessageReceived_( n ):t.log_( 'message on old connection' ) )}}, ht.prototype.sendRequest=function( e ) {e={ t: 'd', d: e }, this.sendData_( e )}, ht.prototype.tryCleanupConnection=function() {this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&( this.log_( 'cleaning up and promoting a connection: '+this.secondaryConn_.connId ), this.conn_=this.secondaryConn_, this.secondaryConn_=null )}, ht.prototype.onSecondaryControl_=function( e ) {'t'in e&&( 'a'===( e=e.t )?this.upgradeIfSecondaryHealthy_():'r'===e?( this.log_( 'Got a reset on secondary, closing it' ), this.secondaryConn_.close(), this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close() ):'o'===e&&( this.log_( 'got pong on secondary.' ), this.secondaryResponsesRequired_--, this.upgradeIfSecondaryHealthy_() ) )}, ht.prototype.onSecondaryMessageReceived_=function( e ) {
        var t=le( 't', e ); e=le( 'd', e ); if( 'c'===t ) {this.onSecondaryControl_( e )}
        else{if( 'd'!==t ) {throw new Error( 'Unknown protocol layer: '+t )}this.pendingDataMessages.push( e )}
      }, ht.prototype.upgradeIfSecondaryHealthy_=function() {this.secondaryResponsesRequired_<=0?( this.log_( 'Secondary connection is healthy.' ), this.isHealthy_=!0, this.secondaryConn_.markConnectionHealthy(), this.proceedWithUpgrade_() ):( this.log_( 'sending ping on secondary.' ), this.secondaryConn_.send( { t: 'c', d: { t: 'p', d: {} } } ) )}, ht.prototype.proceedWithUpgrade_=function() {this.secondaryConn_.start(), this.log_( 'sending client ack on secondary' ), this.secondaryConn_.send( { t: 'c', d: { t: 'a', d: {} } } ), this.log_( 'Ending transmission on primary' ), this.conn_.send( { t: 'c', d: { t: 'n', d: {} } } ), this.tx_=this.secondaryConn_, this.tryCleanupConnection()}, ht.prototype.onPrimaryMessageReceived_=function( e ) {var t=le( 't', e ); e=le( 'd', e ); 'c'===t?this.onControl_( e ):'d'===t&&this.onDataMessage_( e )}, ht.prototype.onDataMessage_=function( e ) {this.onPrimaryResponse_(), this.onMessage_( e )}, ht.prototype.onPrimaryResponse_=function() {this.isHealthy_||( this.primaryResponsesRequired_--, this.primaryResponsesRequired_<=0&&( this.log_( 'Primary connection is healthy.' ), this.isHealthy_=!0, this.conn_.markConnectionHealthy() ) )}, ht.prototype.onControl_=function( e ) {
        var t=le( 't', e ); if( 'd'in e ) {
          if( e=e.d, 'h'===t ) {this.onHandshake_( e )}
          else if( 'n'===t ) {this.log_( 'recvd end transmission on primary' ), this.rx_=this.secondaryConn_; for( var n=0; n<this.pendingDataMessages.length; ++n ) {this.onDataMessage_( this.pendingDataMessages[n] )}this.pendingDataMessages=[], this.tryCleanupConnection()}
          else{'s'===t?this.onConnectionShutdown_( e ):'r'===t?this.onReset_( e ):'e'===t?ae( 'Server Error: '+e ):'o'===t?( this.log_( 'got pong on primary.' ), this.onPrimaryResponse_(), this.sendPingOnPrimaryIfNecessary_() ):ae( 'Unknown control packet command: '+t )}
        }
      }, ht.prototype.onHandshake_=function( e ) {var t=e.ts, n=e.v, r=e.h; this.sessionId=e.s, this.repoInfo_.host=r, 0===this.state_&&( this.conn_.start(), this.onConnectionEstablished_( this.conn_, t ), '5'!==n&&Ee( 'Protocol version mismatch detected' ), this.tryStartUpgrade_() )}, ht.prototype.tryStartUpgrade_=function() {var e=this.transportManager_.upgradeTransport(); e&&this.startUpgrade_( e )}, ht.prototype.startUpgrade_=function( e ) {var t=this; this.secondaryConn_=new e( this.nextTransportId_(), this.repoInfo_, this.applicationId_, this.sessionId ), this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0; var n=this.connReceiver_( this.secondaryConn_ ); e=this.disconnReceiver_( this.secondaryConn_ ); this.secondaryConn_.open( n, e ), ke( ( function() {t.secondaryConn_&&( t.log_( 'Timed out trying to upgrade.' ), t.secondaryConn_.close() )} ), Math.floor( 6e4 ) )}, ht.prototype.onReset_=function( e ) {this.log_( 'Reset packet received.  New host: '+e ), this.repoInfo_.host=e, 1===this.state_?this.close():( this.closeConnections_(), this.start_() )}, ht.prototype.onConnectionEstablished_=function( e, t ) {var n=this; this.log_( 'Realtime connection established.' ), this.conn_=e, this.state_=1, this.onReady_&&( this.onReady_( t, this.sessionId ), this.onReady_=null ), 0===this.primaryResponsesRequired_?( this.log_( 'Primary connection is healthy.' ), this.isHealthy_=!0 ):ke( ( function() {n.sendPingOnPrimaryIfNecessary_()} ), Math.floor( 5e3 ) )}, ht.prototype.sendPingOnPrimaryIfNecessary_=function() {this.isHealthy_||1!==this.state_||( this.log_( 'sending ping on primary.' ), this.sendData_( { t: 'c', d: { t: 'p', d: {} } } ) )}, ht.prototype.onSecondaryConnectionLost_=function() {var e=this.secondaryConn_; this.secondaryConn_=null, this.tx_!==e&&this.rx_!==e||this.close()}, ht.prototype.onConnectionLost_=function( e ) {this.conn_=null, e||0!==this.state_?1===this.state_&&this.log_( 'Realtime connection lost.' ):( this.log_( 'Realtime connection failed.' ), this.repoInfo_.isCacheableHost()&&( pe.remove( 'host:'+this.repoInfo_.host ), this.repoInfo_.internalHost=this.repoInfo_.host ) ), this.close()}, ht.prototype.onConnectionShutdown_=function( e ) {this.log_( 'Connection shutdown command received. Shutting down...' ), this.onKill_&&( this.onKill_( e ), this.onKill_=null ), this.onDisconnect_=null, this.close()}, ht.prototype.sendData_=function( e ) {if( 1!==this.state_ ) {throw'Connection is not connected'}this.tx_.send( e )}, ht.prototype.close=function() {2!==this.state_&&( this.log_( 'Closing realtime connection.' ), this.state_=2, this.closeConnections_(), this.onDisconnect_&&( this.onDisconnect_(), this.onDisconnect_=null ) )}, ht.prototype.closeConnections_=function() {this.log_( 'Shutting down all connections' ), this.conn_&&( this.conn_.close(), this.conn_=null ), this.secondaryConn_&&( this.secondaryConn_.close(), this.secondaryConn_=null ), this.healthyTimeout_&&( clearTimeout( this.healthyTimeout_ ), this.healthyTimeout_=null )}, ht ); function ht( e, t, n, r, i, o, a, s ) {this.id=e, this.repoInfo_=t, this.applicationId_=n, this.onMessage_=r, this.onReady_=i, this.onDisconnect_=o, this.onKill_=a, this.lastSessionId=s, this.connectionCount=0, this.pendingDataMessages=[], this.state_=0, this.log_=be( 'c:'+this.id+':' ), this.transportManager_=new ut( t ), this.log_( 'Connection created' ), this.start_()}var pt=( dt.prototype.put=function( e, t, n, r ) {}, dt.prototype.merge=function( e, t, n, r ) {}, dt.prototype.refreshAuthToken=function( e ) {}, dt.prototype.onDisconnectPut=function( e, t, n ) {}, dt.prototype.onDisconnectMerge=function( e, t, n ) {}, dt.prototype.onDisconnectCancel=function( e, t ) {}, dt.prototype.reportStats=function( e ) {}, dt ); function dt() {}var ft=( _t.prototype.trigger=function( e ) {for( var t=[], n=1; n<arguments.length; n++ ) {t[n-1]=arguments[n]}if( Array.isArray( this.listeners_[e] ) ) {for( var r=s( [], a( this.listeners_[e] ) ), i=0; i<r.length; i++ ) {r[i].callback.apply( r[i].context, t )}}}, _t.prototype.on=function( e, t, n ) {this.validateEventType_( e ), this.listeners_[e]=this.listeners_[e]||[], this.listeners_[e].push( { callback: t, context: n } ), ( e=this.getInitialEvent( e ) )&&t.apply( n, e )}, _t.prototype.off=function( e, t, n ) {this.validateEventType_( e ); for( var r=this.listeners_[e]||[], i=0; i<r.length; i++ ) {if( r[i].callback===t&&( !n||n===r[i].context ) ) {return void r.splice( i, 1 )}}}, _t.prototype.validateEventType_=function( e ) {p( this.allowedEvents_.find( ( function( t ) {return t===e} ) ), 'Unknown event: '+e )}, _t ); function _t( e ) {this.allowedEvents_=e, this.listeners_={}, p( Array.isArray( e )&&0<e.length, 'Requires a non-empty array' )}var yt, vt=( r( gt, yt=ft ), gt.getInstance=function() {return new gt}, gt.prototype.getInitialEvent=function( e ) {return p( 'online'===e, 'Unknown event type: '+e ), [this.online_]}, gt.prototype.currentlyOnline=function() {return this.online_}, gt ); function gt() {var e=yt.call( this, ['online'] )||this; return e.online_=!0, 'undefined'==typeof window||void 0===window.addEventListener||g()||( window.addEventListener( 'online', ( function() {e.online_||( e.online_=!0, e.trigger( 'online', !0 ) )} ), !1 ), window.addEventListener( 'offline', ( function() {e.online_&&( e.online_=!1, e.trigger( 'online', !1 ) )} ), !1 ) ), e}var mt=( wt.prototype.toString=function() {for( var e='', t=this.pieceNum_; t<this.pieces_.length; t++ ) {''!==this.pieces_[t]&&( e+='/'+this.pieces_[t] )} return e||'/'}, wt ); function wt( e, t ) {
        if( void 0===t ) {this.pieces_=e.split( '/' ); for( var n=0, r=0; r<this.pieces_.length; r++ ) {0<this.pieces_[r].length&&( this.pieces_[n]=this.pieces_[r], n++ )}this.pieces_.length=n, this.pieceNum_=0}
        else {this.pieces_=e, this.pieceNum_=t}
      }function bt() {return new mt( '' )}function Ct( e ) {return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function Et( e ) {return e.pieces_.length-e.pieceNum_}function It( e ) {var t=e.pieceNum_; return t<e.pieces_.length&&t++, new mt( e.pieces_, t )}function St( e ) {return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function Tt( e, t ) {return void 0===t&&( t=0 ), e.pieces_.slice( e.pieceNum_+t )}function Nt( e ) {if( e.pieceNum_>=e.pieces_.length ) {return null}for( var t=[], n=e.pieceNum_; n<e.pieces_.length-1; n++ ) {t.push( e.pieces_[n] )}return new mt( t, 0 )}function Pt( e, t ) {
        for( var n=[], r=e.pieceNum_; r<e.pieces_.length; r++ ) {n.push( e.pieces_[r] )}if( t instanceof mt ) {for( r=t.pieceNum_; r<t.pieces_.length; r++ ) {n.push( t.pieces_[r] )}}
        else{var i=t.split( '/' ); for( r=0; r<i.length; r++ ) {0<i[r].length&&n.push( i[r] )}}return new mt( n, 0 );
      }function Rt( e ) {return e.pieceNum_>=e.pieces_.length}function kt( e, t ) {var n=Ct( e ), r=Ct( t ); if( null===n ) {return t}if( n===r ) {return kt( It( e ), It( t ) )}throw new Error( 'INTERNAL ERROR: innerPath ('+t+') is not within outerPath ('+e+')' )}function xt( e, t ) {for( var n=Tt( e, 0 ), r=Tt( t, 0 ), i=0; i<n.length&&i<r.length; i++ ) {var o=Te( n[i], r[i] ); if( 0!==o ) {return o}}return n.length===r.length?0:n.length<r.length?-1:1}function Ot( e, t ) {if( Et( e )!==Et( t ) ) {return!1}for( var n=e.pieceNum_, r=t.pieceNum_; n<=e.pieces_.length; n++, r++ ) {if( e.pieces_[n]!==t.pieces_[r] ) {return!1}}return!0}function Dt( e, t ) {var n=e.pieceNum_, r=t.pieceNum_; if( Et( e )>Et( t ) ) {return!1}for( ;n<e.pieces_.length; ) {if( e.pieces_[n]!==t.pieces_[r] ) {return!1}++n, ++r}return!0}var At=function( e, t ) {this.errorPrefix_=t, this.parts_=Tt( e, 0 ), this.byteLength_=Math.max( 1, this.parts_.length ); for( var n=0; n<this.parts_.length; n++ ) {this.byteLength_+=j( this.parts_[n] )}Lt( this )}; function Lt( e ) {if( e.byteLength_>768 ) {throw new Error( e.errorPrefix_+'has a key path longer than 768 bytes ('+e.byteLength_+').' )}if( e.parts_.length>32 ) {throw new Error( e.errorPrefix_+'path specified exceeds the maximum depth that can be written (32) or object contains a cycle '+Ft( e ) )}}function Ft( e ) {return 0===e.parts_.length?'':'in property \''+e.parts_.join( '.' )+'\''}var Mt, qt=( r( jt, Mt=ft ), jt.getInstance=function() {return new jt}, jt.prototype.getInitialEvent=function( e ) {return p( 'visible'===e, 'Unknown event type: '+e ), [this.visible_]}, jt ); function jt() {var e, t, n=Mt.call( this, ['visible'] )||this; return'undefined'!=typeof document&&void 0!==document.addEventListener&&( void 0!==document.hidden?( t='visibilitychange', e='hidden' ):void 0!==document.mozHidden?( t='mozvisibilitychange', e='mozHidden' ):void 0!==document.msHidden?( t='msvisibilitychange', e='msHidden' ):void 0!==document.webkitHidden&&( t='webkitvisibilitychange', e='webkitHidden' ) ), n.visible_=!0, t&&document.addEventListener( t, ( function() {var t=!document[e]; t!==n.visible_&&( n.visible_=t, n.trigger( 'visible', t ) )} ), !1 ), n}var Wt, Ut=1e3, Bt=( r( zt, Wt=pt ), zt.prototype.sendRequest=function( e, t, n ) {var r=++this.requestNumber_; t={ r: r, a: e, b: t }; this.log_( N( t ) ), p( this.connected_, 'sendRequest call when we\'re not connected not allowed.' ), this.realtime_.sendRequest( t ), n&&( this.requestCBHash_[r]=n )}, zt.prototype.get=function( e ) {var t=this, n=new y, r={ p: e._path.toString(), q: e._queryObject }, i={ action: 'g', request: r, onComplete: function( e ) {var i=e.d; 'ok'===e.s?( t.onDataUpdate_( r.p, i, !1, null ), n.resolve( i ) ):n.reject( i )} }; this.outstandingGets_.push( i ), this.outstandingGetCount_++; var o=this.outstandingGets_.length-1; return this.connected_||setTimeout( ( function() {var e=t.outstandingGets_[o]; void 0!==e&&i===e&&( delete t.outstandingGets_[o], t.outstandingGetCount_--, 0===t.outstandingGetCount_&&( t.outstandingGets_=[] ), t.log_( 'get '+o+' timed out on connection' ), n.reject( new Error( 'Client is offline.' ) ) )} ), 3e3 ), this.connected_&&this.sendGet_( o ), n.promise}, zt.prototype.listen=function( e, t, n, r ) {var i=e._queryIdentifier, o=e._path.toString(); this.log_( 'Listen called for '+o+' '+i ), this.listens.has( o )||this.listens.set( o, new Map ), p( e._queryParams.isDefault()||!e._queryParams.loadsAllData(), 'listen() called for non-default but complete query' ), p( !this.listens.get( o ).has( i ), 'listen() called twice for same path/queryId.' ), n={ onComplete: r, hashFn: t, query: e, tag: n }, this.listens.get( o ).set( i, n ), this.connected_&&this.sendListen_( n )}, zt.prototype.sendGet_=function( e ) {var t=this, n=this.outstandingGets_[e]; this.sendRequest( 'g', n.request, ( function( r ) {delete t.outstandingGets_[e], t.outstandingGetCount_--, 0===t.outstandingGetCount_&&( t.outstandingGets_=[] ), n.onComplete&&n.onComplete( r )} ) )}, zt.prototype.sendListen_=function( e ) {var t=this, n=e.query, r=n._path.toString(), i=n._queryIdentifier; this.log_( 'Listen on '+r+' for '+i ); var o={ p: r }; e.tag&&( o.q=n._queryObject, o.t=e.tag ), o.h=e.hashFn(), this.sendRequest( 'q', o, ( function( o ) {var a=o.d, s=o.s; zt.warnOnListenWarnings_( a, n ), ( t.listens.get( r )&&t.listens.get( r ).get( i ) )===e&&( t.log_( 'listen response', o ), 'ok'!==s&&t.removeListen_( r, i ), e.onComplete&&e.onComplete( s, a ) )} ) )}, zt.warnOnListenWarnings_=function( e, t ) {e&&'object'==typeof e&&R( e, 'w' )&&( e=k( e, 'w' ), Array.isArray( e )&&~e.indexOf( 'no_index' )&&( e='".indexOn": "'+t._queryParams.getIndex().toString()+'"', t=t._path.toString(), Ee( 'Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding '+e+' at '+t+' to your security rules for better performance.' ) ) )}, zt.prototype.refreshAuthToken=function( e ) {this.authToken_=e, this.log_( 'Auth token refreshed' ), this.authToken_?this.tryAuth():this.connected_&&this.sendRequest( 'unauth', {}, ( function() {} ) ), this.reduceReconnectDelayIfAdminCredential_( e )}, zt.prototype.reduceReconnectDelayIfAdminCredential_=function( e ) {( e&&40===e.length||function( e ) {return'object'==typeof( e=P( e ).claims )&&!0===e.admin}( e ) )&&( this.log_( 'Admin auth credential detected.  Reducing max reconnect time.' ), this.maxReconnectDelay_=3e4 )}, zt.prototype.tryAuth=function() {var e, t, n, r=this; this.connected_&&this.authToken_&&( t=function( e ) {return!!( e=P( e ).claims )&&'object'==typeof e&&e.hasOwnProperty( 'iat' )}( e=this.authToken_ )?'auth':'gauth', n={ cred: e }, null===this.authOverride_?n.noauth=!0:'object'==typeof this.authOverride_&&( n.authvar=this.authOverride_ ), this.sendRequest( t, n, ( function( t ) {var n=t.s; t=t.d||'error'; r.authToken_===e&&( 'ok'===n?r.invalidAuthTokenCount_=0:r.onAuthRevoked_( n, t ) )} ) ) )}, zt.prototype.unlisten=function( e, t ) {var n=e._path.toString(), r=e._queryIdentifier; this.log_( 'Unlisten called for '+n+' '+r ), p( e._queryParams.isDefault()||!e._queryParams.loadsAllData(), 'unlisten() called for non-default but complete query' ), this.removeListen_( n, r )&&this.connected_&&this.sendUnlisten_( n, r, e._queryObject, t )}, zt.prototype.sendUnlisten_=function( e, t, n, r ) {this.log_( 'Unlisten on '+e+' for '+t ), e={ p: e }, r&&( e.q=n, e.t=r ), this.sendRequest( 'n', e )}, zt.prototype.onDisconnectPut=function( e, t, n ) {this.connected_?this.sendOnDisconnect_( 'o', e, t, n ):this.onDisconnectRequestQueue_.push( { pathString: e, action: 'o', data: t, onComplete: n } )}, zt.prototype.onDisconnectMerge=function( e, t, n ) {this.connected_?this.sendOnDisconnect_( 'om', e, t, n ):this.onDisconnectRequestQueue_.push( { pathString: e, action: 'om', data: t, onComplete: n } )}, zt.prototype.onDisconnectCancel=function( e, t ) {this.connected_?this.sendOnDisconnect_( 'oc', e, null, t ):this.onDisconnectRequestQueue_.push( { pathString: e, action: 'oc', data: null, onComplete: t } )}, zt.prototype.sendOnDisconnect_=function( e, t, n, r ) {n={ p: t, d: n }, this.log_( 'onDisconnect '+e, n ), this.sendRequest( e, n, ( function( e ) {r&&setTimeout( ( function() {r( e.s, e.d )} ), Math.floor( 0 ) )} ) )}, zt.prototype.put=function( e, t, n, r ) {this.putInternal( 'p', e, t, n, r )}, zt.prototype.merge=function( e, t, n, r ) {this.putInternal( 'm', e, t, n, r )}, zt.prototype.putInternal=function( e, t, n, r, i ) {n={ p: t, d: n }, void 0!==i&&( n.h=i ), this.outstandingPuts_.push( { action: e, request: n, onComplete: r } ), this.outstandingPutCount_++, r=this.outstandingPuts_.length-1, this.connected_?this.sendPut_( r ):this.log_( 'Buffering put: '+t )}, zt.prototype.sendPut_=function( e ) {var t=this, n=this.outstandingPuts_[e].action, r=this.outstandingPuts_[e].request, i=this.outstandingPuts_[e].onComplete; this.outstandingPuts_[e].queued=this.connected_, this.sendRequest( n, r, ( function( r ) {t.log_( n+' response', r ), delete t.outstandingPuts_[e], t.outstandingPutCount_--, 0===t.outstandingPutCount_&&( t.outstandingPuts_=[] ), i&&i( r.s, r.d )} ) )}, zt.prototype.reportStats=function( e ) {var t=this; this.connected_&&( e={ c: e }, this.log_( 'reportStats', e ), this.sendRequest( 's', e, ( function( e ) {'ok'!==e.s&&( e=e.d, t.log_( 'reportStats', 'Error sending stats: '+e ) )} ) ) )}, zt.prototype.onDataMessage_=function( e ) {
        if( 'r'in e ) {this.log_( 'from server: '+N( e ) ); var t=e.r, n=this.requestCBHash_[t]; n&&( delete this.requestCBHash_[t], n( e.b ) )}
        else{if( 'error'in e ) {throw'A server-side error has occurred: '+e.error}'a'in e&&this.onDataPush_( e.a, e.b )}
      }, zt.prototype.onDataPush_=function( e, t ) {this.log_( 'handleServerMessage', e, t ), 'd'===e?this.onDataUpdate_( t.p, t.d, !1, t.t ):'m'===e?this.onDataUpdate_( t.p, t.d, !0, t.t ):'c'===e?this.onListenRevoked_( t.p, t.q ):'ac'===e?this.onAuthRevoked_( t.s, t.d ):'sd'===e?this.onSecurityDebugPacket_( t ):ae( 'Unrecognized action received from server: '+N( e )+'\nAre you using the latest client?' )}, zt.prototype.onReady_=function( e, t ) {this.log_( 'connection ready' ), this.connected_=!0, this.lastConnectionEstablishedTime_=( new Date ).getTime(), this.handleTimestamp_( e ), this.lastSessionId=t, this.firstConnection_&&this.sendConnectStats_(), this.restoreState_(), this.firstConnection_=!1, this.onConnectStatus_( !0 )}, zt.prototype.scheduleConnect_=function( e ) {var t=this; p( !this.realtime_, 'Scheduling a connect when we\'re already connected/ing?' ), this.establishConnectionTimer_&&clearTimeout( this.establishConnectionTimer_ ), this.establishConnectionTimer_=setTimeout( ( function() {t.establishConnectionTimer_=null, t.establishConnection_()} ), Math.floor( e ) )}, zt.prototype.onVisible_=function( e ) {e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&( this.log_( 'Window became visible.  Reducing delay.' ), this.reconnectDelay_=Ut, this.realtime_||this.scheduleConnect_( 0 ) ), this.visible_=e}, zt.prototype.onOnline_=function( e ) {e?( this.log_( 'Browser went online.' ), this.reconnectDelay_=Ut, this.realtime_||this.scheduleConnect_( 0 ) ):( this.log_( 'Browser went offline.  Killing connection.' ), this.realtime_&&this.realtime_.close() )}, zt.prototype.onRealtimeDisconnect_=function() {var e; this.log_( 'data client disconnected' ), this.connected_=!1, this.realtime_=null, this.cancelSentTransactions_(), this.requestCBHash_={}, this.shouldReconnect_()&&( this.visible_?this.lastConnectionEstablishedTime_&&( 3e4<( new Date ).getTime()-this.lastConnectionEstablishedTime_&&( this.reconnectDelay_=Ut ), this.lastConnectionEstablishedTime_=null ):( this.log_( 'Window isn\'t visible.  Delaying reconnect.' ), this.reconnectDelay_=this.maxReconnectDelay_, this.lastConnectionAttemptTime_=( new Date ).getTime() ), e=( new Date ).getTime()-this.lastConnectionAttemptTime_, e=Math.max( 0, this.reconnectDelay_-e ), e=Math.random()*e, this.log_( 'Trying to reconnect in '+e+'ms' ), this.scheduleConnect_( e ), this.reconnectDelay_=Math.min( this.maxReconnectDelay_, 1.3*this.reconnectDelay_ ) ), this.onConnectStatus_( !1 )}, zt.prototype.establishConnection_=function() {var e, t, n, r, i, o, a, s, u, l, c=this; this.shouldReconnect_()&&( this.log_( 'Making a connection attempt' ), this.lastConnectionAttemptTime_=( new Date ).getTime(), this.lastConnectionEstablishedTime_=null, e=this.onDataMessage_.bind( this ), t=this.onReady_.bind( this ), n=this.onRealtimeDisconnect_.bind( this ), r=this.id+':'+zt.nextConnectionId_++, o=( i=this ).lastSessionId, a=!1, s=null, u=function() {s?s.close():( a=!0, n() )}, this.realtime_={ close: u, sendRequest: function( e ) {p( s, 'sendRequest call when we\'re not connected not allowed.' ), s.sendRequest( e )} }, l=this.forceTokenRefresh_, this.forceTokenRefresh_=!1, this.authTokenProvider_.getToken( l ).then( ( function( u ) {a?we( 'getToken() completed but was canceled' ):( we( 'getToken() completed. Creating connection.' ), i.authToken_=u&&u.accessToken, s=new ct( r, i.repoInfo_, i.applicationId_, e, t, n, ( function( e ) {Ee( e+' ('+i.repoInfo_.toString()+')' ), i.interrupt( 'server_kill' )} ), o ) )} ) ).then( null, ( function( e ) {i.log_( 'Failed to get token: '+e ), a||( c.repoInfo_.nodeAdmin&&Ee( e ), u() )} ) ) )}, zt.prototype.interrupt=function( e ) {we( 'Interrupting connection for reason: '+e ), this.interruptReasons_[e]=!0, this.realtime_?this.realtime_.close():( this.establishConnectionTimer_&&( clearTimeout( this.establishConnectionTimer_ ), this.establishConnectionTimer_=null ), this.connected_&&this.onRealtimeDisconnect_() )}, zt.prototype.resume=function( e ) {we( 'Resuming connection for reason: '+e ), delete this.interruptReasons_[e], x( this.interruptReasons_ )&&( this.reconnectDelay_=Ut, this.realtime_||this.scheduleConnect_( 0 ) )}, zt.prototype.handleTimestamp_=function( e ) {e-=( new Date ).getTime(), this.onServerInfoUpdate_( { serverTimeOffset: e } )}, zt.prototype.cancelSentTransactions_=function() {for( var e=0; e<this.outstandingPuts_.length; e++ ) {var t=this.outstandingPuts_[e]; t&&'h'in t.request&&t.queued&&( t.onComplete&&t.onComplete( 'disconnect' ), delete this.outstandingPuts_[e], this.outstandingPutCount_-- )}0===this.outstandingPutCount_&&( this.outstandingPuts_=[] )}, zt.prototype.onListenRevoked_=function( e, t ) {t=t?t.map( ( function( e ) {return Ne( e )} ) ).join( '$' ):'default', ( t=this.removeListen_( e, t ) )&&t.onComplete&&t.onComplete( 'permission_denied' )}, zt.prototype.removeListen_=function( e, t ) {var n, r=new mt( e ).toString(); return this.listens.has( r )?( n=( e=this.listens.get( r ) ).get( t ), e.delete( t ), 0===e.size&&this.listens.delete( r ) ):n=void 0, n}, zt.prototype.onAuthRevoked_=function( e, t ) {we( 'Auth token revoked: '+e+'/'+t ), this.authToken_=null, this.forceTokenRefresh_=!0, this.realtime_.close(), 'invalid_token'!==e&&'permission_denied'!==e||( this.invalidAuthTokenCount_++, 3<=this.invalidAuthTokenCount_&&( this.reconnectDelay_=3e4, this.authTokenProvider_.notifyForInvalidToken() ) )}, zt.prototype.onSecurityDebugPacket_=function( e ) {this.securityDebugCallback_?this.securityDebugCallback_( e ):'msg'in e&&console.log( 'FIREBASE: '+e.msg.replace( '\n', '\nFIREBASE: ' ) )}, zt.prototype.restoreState_=function() {
        var e, t, n, r; this.tryAuth(); try{
          for( var i=o( this.listens.values() ), a=i.next(); !a.done; a=i.next() ) {
            var s=a.value; try{for( var u=( n=void 0, o( s.values() ) ), l=u.next(); !l.done; l=u.next() ) {var c=l.value; this.sendListen_( c )}}
            catch( t ) {n={ error: t }}
            finally{
              try{l&&!l.done&&( r=u.return )&&r.call( u )}
              finally{if( n ) {throw n.error}}
            }
          }
        }
        catch( t ) {e={ error: t }}
        finally{
          try{a&&!a.done&&( t=i.return )&&t.call( i )}
          finally{if( e ) {throw e.error}}
        }for( var h=0; h<this.outstandingPuts_.length; h++ ) {this.outstandingPuts_[h]&&this.sendPut_( h )}for( ;this.onDisconnectRequestQueue_.length; ) {var p=this.onDisconnectRequestQueue_.shift(); this.sendOnDisconnect_( p.action, p.pathString, p.data, p.onComplete )}for( h=0; h<this.outstandingGets_.length; h++ ) {this.outstandingGets_[h]&&this.sendGet_( h )}
      }, zt.prototype.sendConnectStats_=function() {var e={}; e['sdk.js.'+rt.replace( /\./g, '-' )]=1, g()?e['framework.cordova']=1:'object'==typeof navigator&&'ReactNative'===navigator.product&&( e['framework.reactnative']=1 ), this.reportStats( e )}, zt.prototype.shouldReconnect_=function() {var e=vt.getInstance().currentlyOnline(); return x( this.interruptReasons_ )&&e}, zt.nextPersistentConnectionId_=0, zt.nextConnectionId_=0, zt ); function zt( e, t, n, r, i, o, a ) {var s=Wt.call( this )||this; if( s.repoInfo_=e, s.applicationId_=t, s.onDataUpdate_=n, s.onConnectStatus_=r, s.onServerInfoUpdate_=i, s.authTokenProvider_=o, s.authOverride_=a, s.id=zt.nextPersistentConnectionId_++, s.log_=be( 'p:'+s.id+':' ), s.interruptReasons_={}, s.listens=new Map, s.outstandingPuts_=[], s.outstandingGets_=[], s.outstandingPutCount_=0, s.outstandingGetCount_=0, s.onDisconnectRequestQueue_=[], s.connected_=!1, s.reconnectDelay_=Ut, s.maxReconnectDelay_=3e5, s.securityDebugCallback_=null, s.lastSessionId=null, s.establishConnectionTimer_=null, s.visible_=!1, s.requestCBHash_={}, s.requestNumber_=0, s.realtime_=null, s.authToken_=null, s.forceTokenRefresh_=!1, s.invalidAuthTokenCount_=0, s.firstConnection_=!0, s.lastConnectionAttemptTime_=null, s.lastConnectionEstablishedTime_=null, a&&!m() ) {throw new Error( 'Auth override specified in options, but not supported on non Node.js platforms' )}return s.scheduleConnect_( 0 ), qt.getInstance().on( 'visible', s.onVisible_, s ), -1===e.host.indexOf( 'fblocal' )&&vt.getInstance().on( 'online', s.onOnline_, s ), s}var Ht=( Vt.Wrap=function( e, t ) {return new Vt( e, t )}, Vt ); function Vt( e, t ) {this.name=e, this.node=t}var Qt, Yt, Gt=( Kt.prototype.getCompare=function() {return this.compare.bind( this )}, Kt.prototype.indexedValueChanged=function( e, t ) {return e=new Ht( Ie, e ), t=new Ht( Ie, t ), 0!==this.compare( e, t )}, Kt.prototype.minPost=function() {return Ht.MIN}, Kt ); function Kt() {}function $t() {return null!==Yt&&Yt.apply( this, arguments )||this}var Jt=new( Z=( r( $t, Yt=Gt ), Object.defineProperty( $t, '__EMPTY_NODE', { get: function() {return Qt}, set: function( e ) {Qt=e}, enumerable: !1, configurable: !0 } ), $t.prototype.compare=function( e, t ) {return Te( e.name, t.name )}, $t.prototype.isDefinedOn=function( e ) {throw d( 'KeyIndex.isDefinedOn not expected to be called.' )}, $t.prototype.indexedValueChanged=function( e, t ) {return!1}, $t.prototype.minPost=function() {return Ht.MIN}, $t.prototype.maxPost=function() {return new Ht( Se, Qt )}, $t.prototype.makePost=function( e, t ) {return p( 'string'==typeof e, 'KeyIndex indexValue must always be a string.' ), new Ht( e, Qt )}, $t.prototype.toString=function() {return'.key'}, $t ) ), Xt=( Zt.prototype.getNext=function() {
        if( 0===this.nodeStack_.length ) {return null}var e=this.nodeStack_.pop(), t=this.resultGenerator_?this.resultGenerator_( e.key, e.value ):{ key: e.key, value: e.value }; if( this.isReverse_ ) {for( e=e.left; !e.isEmpty(); ) {this.nodeStack_.push( e ), e=e.right}}
        else {for( e=e.right; !e.isEmpty(); ) {this.nodeStack_.push( e ), e=e.left}}return t;
      }, Zt.prototype.hasNext=function() {return 0<this.nodeStack_.length}, Zt.prototype.peek=function() {if( 0===this.nodeStack_.length ) {return null}var e=this.nodeStack_[this.nodeStack_.length-1]; return this.resultGenerator_?this.resultGenerator_( e.key, e.value ):{ key: e.key, value: e.value }}, Zt ); function Zt( e, t, n, r, i ) {
        void 0===i&&( i=null ), this.isReverse_=r, this.resultGenerator_=i, this.nodeStack_=[]; for( var o=1; !e.isEmpty(); ) {
          if( o=t?n( e.key, t ):1, r&&( o*=-1 ), o<0 ) {e=this.isReverse_?e.left:e.right}
          else{if( 0===o ) {this.nodeStack_.push( e ); break}this.nodeStack_.push( e ), e=this.isReverse_?e.right:e.left}
        }
      }var en=( tn.prototype.copy=function( e, t, n, r, i ) {return new tn( null!=e?e:this.key, null!=t?t:this.value, null!=n?n:this.color, null!=r?r:this.left, null!=i?i:this.right )}, tn.prototype.count=function() {return this.left.count()+1+this.right.count()}, tn.prototype.isEmpty=function() {return!1}, tn.prototype.inorderTraversal=function( e ) {return this.left.inorderTraversal( e )||!!e( this.key, this.value )||this.right.inorderTraversal( e )}, tn.prototype.reverseTraversal=function( e ) {return this.right.reverseTraversal( e )||e( this.key, this.value )||this.left.reverseTraversal( e )}, tn.prototype.min_=function() {return this.left.isEmpty()?this:this.left.min_()}, tn.prototype.minKey=function() {return this.min_().key}, tn.prototype.maxKey=function() {return this.right.isEmpty()?this.key:this.right.maxKey()}, tn.prototype.insert=function( e, t, n ) {var r=this, i=n( e, r.key ); return( r=i<0?r.copy( null, null, null, r.left.insert( e, t, n ), null ):0===i?r.copy( null, t, null, null, null ):r.copy( null, null, null, null, r.right.insert( e, t, n ) ) ).fixUp_()}, tn.prototype.removeMin_=function() {if( this.left.isEmpty() ) {return on.EMPTY_NODE}var e=this; return( e=( e=e.left.isRed_()||e.left.left.isRed_()?e:e.moveRedLeft_() ).copy( null, null, null, e.left.removeMin_(), null ) ).fixUp_()}, tn.prototype.remove=function( e, t ) {
        var n, r=this; if( t( e, r.key )<0 ) {r=( r=r.left.isEmpty()||r.left.isRed_()||r.left.left.isRed_()?r:r.moveRedLeft_() ).copy( null, null, null, r.left.remove( e, t ), null )}
        else{if( 0===t( e, ( r=( r=r.left.isRed_()?r.rotateRight_():r ).right.isEmpty()||r.right.isRed_()||r.right.left.isRed_()?r:r.moveRedRight_() ).key ) ) {if( r.right.isEmpty() ) {return on.EMPTY_NODE}n=r.right.min_(), r=r.copy( n.key, n.value, null, null, r.right.removeMin_() )}r=r.copy( null, null, null, null, r.right.remove( e, t ) )}return r.fixUp_();
      }, tn.prototype.isRed_=function() {return this.color}, tn.prototype.fixUp_=function() {var e=this; return( e=( e=e.right.isRed_()&&!e.left.isRed_()?e.rotateLeft_():e ).left.isRed_()&&e.left.left.isRed_()?e.rotateRight_():e ).left.isRed_()&&e.right.isRed_()?e.colorFlip_():e}, tn.prototype.moveRedLeft_=function() {var e=this.colorFlip_(); return e.right.left.isRed_()?( e=( e=e.copy( null, null, null, null, e.right.rotateRight_() ) ).rotateLeft_() ).colorFlip_():e}, tn.prototype.moveRedRight_=function() {var e=this.colorFlip_(); return e.left.left.isRed_()?( e=e.rotateRight_() ).colorFlip_():e}, tn.prototype.rotateLeft_=function() {var e=this.copy( null, null, tn.RED, null, this.right.left ); return this.right.copy( null, null, this.color, e, null )}, tn.prototype.rotateRight_=function() {var e=this.copy( null, null, tn.RED, this.left.right, null ); return this.left.copy( null, null, this.color, null, e )}, tn.prototype.colorFlip_=function() {var e=this.left.copy( null, null, !this.left.color, null, null ), t=this.right.copy( null, null, !this.right.color, null, null ); return this.copy( null, null, !this.color, e, t )}, tn.prototype.checkMaxDepth_=function() {var e=this.check_(); return Math.pow( 2, e )<=this.count()+1}, tn.prototype.check_=function() {if( this.isRed_()&&this.left.isRed_() ) {throw new Error( 'Red node has red child('+this.key+','+this.value+')' )}if( this.right.isRed_() ) {throw new Error( 'Right child of ('+this.key+','+this.value+') is red' )}var e=this.left.check_(); if( e!==this.right.check_() ) {throw new Error( 'Black depths differ' )}return e+( this.isRed_()?0:1 )}, tn.RED=!0, tn.BLACK=!1, tn ); function tn( e, t, n, r, i ) {this.key=e, this.value=t, this.color=null!=n?n:tn.RED, this.left=null!=r?r:on.EMPTY_NODE, this.right=null!=i?i:on.EMPTY_NODE}function nn() {}nn.prototype.copy=function( e, t, n, r, i ) {return this}, nn.prototype.insert=function( e, t, n ) {return new en( e, t, null )}, nn.prototype.remove=function( e, t ) {return this}, nn.prototype.count=function() {return 0}, nn.prototype.isEmpty=function() {return!0}, nn.prototype.inorderTraversal=function( e ) {return!1}, nn.prototype.reverseTraversal=function( e ) {return!1}, nn.prototype.minKey=function() {return null}, nn.prototype.maxKey=function() {return null}, nn.prototype.check_=function() {return 0}, nn.prototype.isRed_=function() {return!1}, ft=nn; var rn, on=( an.prototype.insert=function( e, t ) {return new an( this.comparator_, this.root_.insert( e, t, this.comparator_ ).copy( null, null, en.BLACK, null, null ) )}, an.prototype.remove=function( e ) {return new an( this.comparator_, this.root_.remove( e, this.comparator_ ).copy( null, null, en.BLACK, null, null ) )}, an.prototype.get=function( e ) {for( var t, n=this.root_; !n.isEmpty(); ) {if( 0===( t=this.comparator_( e, n.key ) ) ) {return n.value}t<0?n=n.left:0<t&&( n=n.right )}return null}, an.prototype.getPredecessorKey=function( e ) {for( var t, n=this.root_, r=null; !n.isEmpty(); ) {if( 0===( t=this.comparator_( e, n.key ) ) ) {if( n.left.isEmpty() ) {return r?r.key:null}for( n=n.left; !n.right.isEmpty(); ) {n=n.right}return n.key}t<0?n=n.left:0<t&&( n=( r=n ).right )}throw new Error( 'Attempted to find predecessor key for a nonexistent key.  What gives?' )}, an.prototype.isEmpty=function() {return this.root_.isEmpty()}, an.prototype.count=function() {return this.root_.count()}, an.prototype.minKey=function() {return this.root_.minKey()}, an.prototype.maxKey=function() {return this.root_.maxKey()}, an.prototype.inorderTraversal=function( e ) {return this.root_.inorderTraversal( e )}, an.prototype.reverseTraversal=function( e ) {return this.root_.reverseTraversal( e )}, an.prototype.getIterator=function( e ) {return new Xt( this.root_, null, this.comparator_, !1, e )}, an.prototype.getIteratorFrom=function( e, t ) {return new Xt( this.root_, e, this.comparator_, !1, t )}, an.prototype.getReverseIteratorFrom=function( e, t ) {return new Xt( this.root_, e, this.comparator_, !0, t )}, an.prototype.getReverseIterator=function( e ) {return new Xt( this.root_, null, this.comparator_, !0, e )}, an.EMPTY_NODE=new ft, an ); function an( e, t ) {void 0===t&&( t=an.EMPTY_NODE ), this.comparator_=e, this.root_=t}function sn( e, t ) {return Te( e.name, t.name )}function un( e, t ) {return Te( e, t )}function ln( e ) {return'number'==typeof e?'number:'+Re( e ):'string:'+e}var cn, hn, pn, dn, fn=function( e ) {var t; e.isLeafNode()?( t=e.val(), p( 'string'==typeof t||'number'==typeof t||'object'==typeof t&&R( t, '.sv' ), 'Priority must be a string or number.' ) ):p( e===rn||e.isEmpty(), 'priority of unexpected type.' ), p( e===rn||e.getPriority().isEmpty(), 'Priority nodes can\'t have a priority of their own.' )}, _n=( Object.defineProperty( yn, '__childrenNodeConstructor', { get: function() {return cn}, set: function( e ) {cn=e}, enumerable: !1, configurable: !0 } ), yn.prototype.isLeafNode=function() {return!0}, yn.prototype.getPriority=function() {return this.priorityNode_}, yn.prototype.updatePriority=function( e ) {return new yn( this.value_, e )}, yn.prototype.getImmediateChild=function( e ) {return'.priority'===e?this.priorityNode_:yn.__childrenNodeConstructor.EMPTY_NODE}, yn.prototype.getChild=function( e ) {return Rt( e )?this:'.priority'===Ct( e )?this.priorityNode_:yn.__childrenNodeConstructor.EMPTY_NODE}, yn.prototype.hasChild=function() {return!1}, yn.prototype.getPredecessorChildName=function( e, t ) {return null}, yn.prototype.updateImmediateChild=function( e, t ) {return'.priority'===e?this.updatePriority( t ):t.isEmpty()&&'.priority'!==e?this:yn.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild( e, t ).updatePriority( this.priorityNode_ )}, yn.prototype.updateChild=function( e, t ) {var n=Ct( e ); return null===n?t:t.isEmpty()&&'.priority'!==n?this:( p( '.priority'!==n||1===Et( e ), '.priority must be the last token in a path' ), this.updateImmediateChild( n, yn.__childrenNodeConstructor.EMPTY_NODE.updateChild( It( e ), t ) ) )}, yn.prototype.isEmpty=function() {return!1}, yn.prototype.numChildren=function() {return 0}, yn.prototype.forEachChild=function( e, t ) {return!1}, yn.prototype.val=function( e ) {return e&&!this.getPriority().isEmpty()?{ '.value': this.getValue(), '.priority': this.getPriority().val() }:this.getValue()}, yn.prototype.hash=function() {var e, t; return null===this.lazyHash_&&( e='', this.priorityNode_.isEmpty()||( e+='priority:'+ln( this.priorityNode_.val() )+':' ), e+=( t=typeof this.value_ )+':', e+='number'==t?Re( this.value_ ):this.value_, this.lazyHash_=oe( e ) ), this.lazyHash_}, yn.prototype.getValue=function() {return this.value_}, yn.prototype.compareTo=function( e ) {return e===yn.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof yn.__childrenNodeConstructor?-1:( p( e.isLeafNode(), 'Unknown node type' ), this.compareToLeafNode_( e ) )}, yn.prototype.compareToLeafNode_=function( e ) {var t=typeof e.value_, n=typeof this.value_, r=yn.VALUE_TYPE_ORDER.indexOf( t ), i=yn.VALUE_TYPE_ORDER.indexOf( n ); return p( 0<=r, 'Unknown leaf type: '+t ), p( 0<=i, 'Unknown leaf type: '+n ), r===i?'object'==n?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-r}, yn.prototype.withIndex=function() {return this}, yn.prototype.isIndexed=function() {return!0}, yn.prototype.equals=function( e ) {return e===this||!!e.isLeafNode()&&this.value_===e.value_&&this.priorityNode_.equals( e.priorityNode_ )}, yn.VALUE_TYPE_ORDER=['object', 'boolean', 'number', 'string'], yn ); function yn( e, t ) {void 0===t&&( t=yn.__childrenNodeConstructor.EMPTY_NODE ), this.value_=e, this.priorityNode_=t, this.lazyHash_=null, p( void 0!==this.value_&&null!==this.value_, 'LeafNode shouldn\'t be created with null/undefined value.' ), fn( this.priorityNode_ )}function vn() {return null!==dn&&dn.apply( this, arguments )||this}var gn=new( r( vn, dn=Gt ), vn.prototype.compare=function( e, t ) {var n=e.node.getPriority(), r=t.node.getPriority(); return 0===( r=n.compareTo( r ) )?Te( e.name, t.name ):r}, vn.prototype.isDefinedOn=function( e ) {return!e.getPriority().isEmpty()}, vn.prototype.indexedValueChanged=function( e, t ) {return!e.getPriority().equals( t.getPriority() )}, vn.prototype.minPost=function() {return Ht.MIN}, vn.prototype.maxPost=function() {return new Ht( Se, new _n( '[PRIORITY-POST]', pn ) )}, vn.prototype.makePost=function( e, t ) {return e=hn( e ), new Ht( t, new _n( '[PRIORITY-POST]', e ) )}, vn.prototype.toString=function() {return'.priority'}, vn ), mn=Math.log( 2 ), wn=( bn.prototype.nextBitIsOne=function() {var e=!( this.bits_&1<<this.current_ ); return this.current_--, e}, bn ); function bn( e ) {var t; this.count=( t=e+1, parseInt( Math.log( t )/mn, 10 ) ), this.current_=this.count-1; var n, r=( n=this.count, parseInt( Array( n+1 ).join( '1' ), 2 ) ); this.bits_=e+1&r}var Cn, En, In=function( e, t, n, r ) {e.sort( t ); var i=function( t, r ) {if( 0==( o=r-t ) ) {return null}if( 1==o ) {return a=e[t], s=n?n( a ):a, new en( s, a.node, en.BLACK, null, null )}var o=parseInt( o/2, 10 )+t, a=( t=i( t, o ), r=i( o+1, r ), e[o] ), s=n?n( a ):a; return new en( s, a.node, en.BLACK, t, r )}, o=function( t ) {for( var r=null, o=null, a=e.length, s=function( t, r ) {var o=a-t, s=a; a-=t, t=i( 1+o, s ), s=e[o], o=n?n( s ):s, u( new en( o, s.node, r, null, t ) )}, u=function( e ) {r=r?r.left=e:o=e}, l=0; l<t.count; ++l ) {var c=t.nextBitIsOne(), h=Math.pow( 2, t.count-( l+1 ) ); c?s( h, en.BLACK ):( s( h, en.BLACK ), s( h, en.RED ) )}return o}( new wn( e.length ) ); return new on( r||t, o )}, Sn={}, Tn=( Object.defineProperty( Nn, 'Default', { get: function() {return p( gn, 'ChildrenNode.ts has not been loaded' ), Cn=Cn||new Nn( { '.priority': Sn }, { '.priority': gn } )}, enumerable: !1, configurable: !0 } ), Nn.prototype.get=function( e ) {var t=k( this.indexes_, e ); if( !t ) {throw new Error( 'No index defined for '+e )}return t instanceof on?t:null}, Nn.prototype.hasIndex=function( e ) {return R( this.indexSet_, e.toString() )}, Nn.prototype.addIndex=function( e, t ) {p( e!==Jt, 'KeyIndex always exists and isn\'t meant to be added to the IndexMap.' ); for( var n=[], r=!1, o=t.getIterator( Ht.Wrap ), a=o.getNext(); a; ) {r=r||e.isDefinedOn( a.node ), n.push( a ), a=o.getNext()}var s=r?In( n, e.getCompare() ):Sn, u=e.toString(), l=i( {}, this.indexSet_ ); return l[u]=e, ( t=i( {}, this.indexes_ ) )[u]=s, new Nn( t, l )}, Nn.prototype.addToIndexes=function( e, t ) {var n=this; return new Nn( O( this.indexes_, ( function( r, i ) {var o=k( n.indexSet_, i ); if( p( o, 'Missing index implementation for '+i ), r===Sn ) {if( o.isDefinedOn( e.node ) ) {for( var a=[], s=t.getIterator( Ht.Wrap ), u=s.getNext(); u; ) {u.name!==e.name&&a.push( u ), u=s.getNext()}return a.push( e ), In( a, o.getCompare() )}return Sn}return( r=( o=t.get( e.name ) )?r.remove( new Ht( e.name, o ) ):r ).insert( e, e.node )} ) ), this.indexSet_ )}, Nn.prototype.removeFromIndexes=function( e, t ) {return new Nn( O( this.indexes_, ( function( n ) {if( n===Sn ) {return n}var r=t.get( e.name ); return r?n.remove( new Ht( e.name, r ) ):n} ) ), this.indexSet_ )}, Nn ); function Nn( e, t ) {this.indexes_=e, this.indexSet_=t}var Pn, Rn=( Object.defineProperty( kn, 'EMPTY_NODE', { get: function() {return En=En||new kn( new on( un ), null, Tn.Default )}, enumerable: !1, configurable: !0 } ), kn.prototype.isLeafNode=function() {return!1}, kn.prototype.getPriority=function() {return this.priorityNode_||En}, kn.prototype.updatePriority=function( e ) {return this.children_.isEmpty()?this:new kn( this.children_, e, this.indexMap_ )}, kn.prototype.getImmediateChild=function( e ) {return'.priority'===e?this.getPriority():null===( e=this.children_.get( e ) )?En:e}, kn.prototype.getChild=function( e ) {var t=Ct( e ); return null===t?this:this.getImmediateChild( t ).getChild( It( e ) )}, kn.prototype.hasChild=function( e ) {return null!==this.children_.get( e )}, kn.prototype.updateImmediateChild=function( e, t ) {if( p( t, 'We should always be passing snapshot nodes' ), '.priority'===e ) {return this.updatePriority( t )}var n=new Ht( e, t ), r=void 0, i=t.isEmpty()?( r=this.children_.remove( e ), this.indexMap_.removeFromIndexes( n, this.children_ ) ):( r=this.children_.insert( e, t ), this.indexMap_.addToIndexes( n, this.children_ ) ); n=r.isEmpty()?En:this.priorityNode_; return new kn( r, n, i )}, kn.prototype.updateChild=function( e, t ) {var n=Ct( e ); return null===n?t:( p( '.priority'!==Ct( e )||1===Et( e ), '.priority must be the last token in a path' ), t=this.getImmediateChild( n ).updateChild( It( e ), t ), this.updateImmediateChild( n, t ) )}, kn.prototype.isEmpty=function() {return this.children_.isEmpty()}, kn.prototype.numChildren=function() {return this.children_.count()}, kn.prototype.val=function( e ) {if( this.isEmpty() ) {return null}var t={}, n=0, r=0, i=!0; if( this.forEachChild( gn, ( function( o, a ) {t[o]=a.val( e ), n++, i&&kn.INTEGER_REGEXP_.test( o )?r=Math.max( r, Number( o ) ):i=!1} ) ), !e&&i&&r<2*n ) {var o, a=[]; for( o in t ) {a[o]=t[o]}return a}return e&&!this.getPriority().isEmpty()&&( t['.priority']=this.getPriority().val() ), t}, kn.prototype.hash=function() {var e; return null===this.lazyHash_&&( e='', this.getPriority().isEmpty()||( e+='priority:'+ln( this.getPriority().val() )+':' ), this.forEachChild( gn, ( function( t, n ) {''!==( n=n.hash() )&&( e+=':'+t+':'+n )} ) ), this.lazyHash_=''===e?'':oe( e ) ), this.lazyHash_}, kn.prototype.getPredecessorChildName=function( e, t, n ) {return( n=this.resolveIndex_( n ) )?( t=n.getPredecessorKey( new Ht( e, t ) ) )?t.name:null:this.children_.getPredecessorKey( e )}, kn.prototype.getFirstChildName=function( e ) {return( e=this.resolveIndex_( e ) )?( e=e.minKey() )&&e.name:this.children_.minKey()}, kn.prototype.getFirstChild=function( e ) {return( e=this.getFirstChildName( e ) )?new Ht( e, this.children_.get( e ) ):null}, kn.prototype.getLastChildName=function( e ) {return( e=this.resolveIndex_( e ) )?( e=e.maxKey() )&&e.name:this.children_.maxKey()}, kn.prototype.getLastChild=function( e ) {return( e=this.getLastChildName( e ) )?new Ht( e, this.children_.get( e ) ):null}, kn.prototype.forEachChild=function( e, t ) {return( e=this.resolveIndex_( e ) )?e.inorderTraversal( ( function( e ) {return t( e.name, e.node )} ) ):this.children_.inorderTraversal( t )}, kn.prototype.getIterator=function( e ) {return this.getIteratorFrom( e.minPost(), e )}, kn.prototype.getIteratorFrom=function( e, t ) {var n=this.resolveIndex_( t ); if( n ) {return n.getIteratorFrom( e, ( function( e ) {return e} ) )}for( var r=this.children_.getIteratorFrom( e.name, Ht.Wrap ), i=r.peek(); null!=i&&t.compare( i, e )<0; ) {r.getNext(), i=r.peek()}return r}, kn.prototype.getReverseIterator=function( e ) {return this.getReverseIteratorFrom( e.maxPost(), e )}, kn.prototype.getReverseIteratorFrom=function( e, t ) {var n=this.resolveIndex_( t ); if( n ) {return n.getReverseIteratorFrom( e, ( function( e ) {return e} ) )}for( var r=this.children_.getReverseIteratorFrom( e.name, Ht.Wrap ), i=r.peek(); null!=i&&0<t.compare( i, e ); ) {r.getNext(), i=r.peek()}return r}, kn.prototype.compareTo=function( e ) {return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===On?-1:0}, kn.prototype.withIndex=function( e ) {return e===Jt||this.indexMap_.hasIndex( e )?this:( e=this.indexMap_.addIndex( e, this.children_ ), new kn( this.children_, this.priorityNode_, e ) )}, kn.prototype.isIndexed=function( e ) {return e===Jt||this.indexMap_.hasIndex( e )}, kn.prototype.equals=function( e ) {if( e===this ) {return!0}if( e.isLeafNode() ) {return!1}if( this.getPriority().equals( e.getPriority() ) ) {if( this.children_.count()!==e.children_.count() ) {return!1}for( var t=this.getIterator( gn ), n=e.getIterator( gn ), r=t.getNext(), i=n.getNext(); r&&i; ) {if( r.name!==i.name||!r.node.equals( i.node ) ) {return!1}r=t.getNext(), i=n.getNext()}return null===r&&null===i}return!1}, kn.prototype.resolveIndex_=function( e ) {return e===Jt?null:this.indexMap_.get( e.toString() )}, kn.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/, kn ); function kn( e, t, n ) {this.children_=e, this.priorityNode_=t, this.indexMap_=n, this.lazyHash_=null, this.priorityNode_&&fn( this.priorityNode_ ), this.children_.isEmpty()&&p( !this.priorityNode_||this.priorityNode_.isEmpty(), 'An empty node cannot have a priority' )}function xn() {return Pn.call( this, new on( un ), Rn.EMPTY_NODE, Tn.Default )||this}var On=new( r( xn, Pn=Rn ), xn.prototype.compareTo=function( e ) {return e===this?0:1}, xn.prototype.equals=function( e ) {return e===this}, xn.prototype.getPriority=function() {return this}, xn.prototype.getImmediateChild=function( e ) {return Rn.EMPTY_NODE}, xn.prototype.isEmpty=function() {return!1}, xn ); Object.defineProperties( Ht, { MIN: { value: new Ht( Ie, Rn.EMPTY_NODE ) }, MAX: { value: new Ht( Se, On ) } } ), Z.__EMPTY_NODE=Rn.EMPTY_NODE, _n.__childrenNodeConstructor=Rn, rn=On, pn=On; function Dn( e, t ) {if( void 0===t&&( t=null ), null===e ) {return Rn.EMPTY_NODE}if( 'object'==typeof e&&'.priority'in e&&( t=e['.priority'] ), p( null===t||'string'==typeof t||'number'==typeof t||'object'==typeof t&&'.sv'in t, 'Invalid priority type found: '+typeof t ), 'object'==typeof e&&'.value'in e&&null!==e['.value']&&( e=e['.value'] ), 'object'!=typeof e||'.sv'in e ) {return new _n( e, Dn( t ) )}if( e instanceof Array ) {var n=Rn.EMPTY_NODE; return Pe( e, ( function( t, r ) {R( e, t )&&'.'!==t.substring( 0, 1 )&&( !( r=Dn( r ) ).isLeafNode()&&r.isEmpty()||( n=n.updateImmediateChild( t, r ) ) )} ) ), n.updatePriority( Dn( t ) )}var r=[], i=!1; if( Pe( e, ( function( e, t ) {'.'!==e.substring( 0, 1 )&&( ( t=Dn( t ) ).isEmpty()||( i=i||!t.getPriority().isEmpty(), r.push( new Ht( e, t ) ) ) )} ) ), 0===r.length ) {return Rn.EMPTY_NODE}var o=In( r, sn, ( function( e ) {return e.name} ), un ); if( i ) {var a=In( r, gn.getCompare() ); return new Rn( o, Dn( t ), new Tn( { '.priority': a }, { '.priority': gn } ) )}return new Rn( o, Dn( t ), Tn.Default )}hn=Dn; var An, Ln, Fn=( r( Mn, An=Gt ), Mn.prototype.extractChild=function( e ) {return e.getChild( this.indexPath_ )}, Mn.prototype.isDefinedOn=function( e ) {return!e.getChild( this.indexPath_ ).isEmpty()}, Mn.prototype.compare=function( e, t ) {var n=this.extractChild( e.node ), r=this.extractChild( t.node ); return 0===( r=n.compareTo( r ) )?Te( e.name, t.name ):r}, Mn.prototype.makePost=function( e, t ) {return e=Dn( e ), e=Rn.EMPTY_NODE.updateChild( this.indexPath_, e ), new Ht( t, e )}, Mn.prototype.maxPost=function() {var e=Rn.EMPTY_NODE.updateChild( this.indexPath_, On ); return new Ht( Se, e )}, Mn.prototype.toString=function() {return Tt( this.indexPath_, 0 ).join( '/' )}, Mn ); function Mn( e ) {var t=An.call( this )||this; return t.indexPath_=e, p( !Rt( e )&&'.priority'!==Ct( e ), 'Can\'t create PathIndex with empty path or .priority key' ), t}function qn() {return null!==Ln&&Ln.apply( this, arguments )||this}function jn( e ) {if( e===''+De ) {return'-'}var t=Ae( e ); if( null!=t ) {return''+( t+1 )}for( var n=new Array( e.length ), r=0; r<n.length; r++ ) {n[r]=e.charAt( r )}if( n.length<786 ) {return n.push( '-' ), n.join( '' )}for( var i=n.length-1; 0<=i&&'z'===n[i]; ) {i--}return-1===i?Se:( t=n[i], t=Hn.charAt( Hn.indexOf( t )+1 ), n[i]=t, n.slice( 0, i+1 ).join( '' ) )}function Wn( e ) {if( e===''+Oe ) {return Ie}var t=Ae( e ); if( null!=t ) {return''+( t-1 )}for( var n=new Array( e.length ), r=0; r<n.length; r++ ) {n[r]=e.charAt( r )}return'-'===n[n.length-1]?1===n.length?''+De:( delete n[n.length-1], n.join( '' ) ):( n[n.length-1]=Hn.charAt( Hn.indexOf( n[n.length-1] )-1 ), n.join( '' )+'z'.repeat( 786-n.length ) )}var Un, Bn, zn=new( r( qn, Ln=Gt ), qn.prototype.compare=function( e, t ) {var n=e.node.compareTo( t.node ); return 0===n?Te( e.name, t.name ):n}, qn.prototype.isDefinedOn=function( e ) {return!0}, qn.prototype.indexedValueChanged=function( e, t ) {return!e.equals( t )}, qn.prototype.minPost=function() {return Ht.MIN}, qn.prototype.maxPost=function() {return Ht.MAX}, qn.prototype.makePost=function( e, t ) {return e=Dn( e ), new Ht( t, e )}, qn.prototype.toString=function() {return'.value'}, qn ), Hn='-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz', Vn=( Un=0, Bn=[], function( e ) {
        var t=e===Un; Un=e; for( var n=new Array( 8 ), r=7; 0<=r; r-- ) {n[r]=Hn.charAt( e%64 ), e=Math.floor( e/64 )}p( 0===e, 'Cannot push at time == 0' ); var i=n.join( '' ); if( t ) {for( r=11; 0<=r&&63===Bn[r]; r-- ) {Bn[r]=0}Bn[r]++}
        else {for( r=0; r<12; r++ ) {Bn[r]=Math.floor( 64*Math.random() )}}for( r=0; r<12; r++ ) {i+=Hn.charAt( Bn[r] )}return p( 20===i.length, 'nextPushId: Length should be 20.' ), i;
      } ); function Qn( e ) {return{ type: 'value', snapshotNode: e }}function Yn( e, t ) {return{ type: 'child_added', snapshotNode: t, childName: e }}function Gn( e, t ) {return{ type: 'child_removed', snapshotNode: t, childName: e }}function Kn( e, t, n ) {return{ type: 'child_changed', snapshotNode: t, childName: e, oldSnap: n }}var $n=( Jn.prototype.updateChild=function( e, t, n, r, i, o ) {p( e.isIndexed( this.index_ ), 'A node must be indexed if only a child is updated' ); var a=e.getImmediateChild( t ); return a.getChild( r ).equals( n.getChild( r ) )&&a.isEmpty()===n.isEmpty()?e:( null!=o&&( n.isEmpty()?e.hasChild( t )?o.trackChildChange( Gn( t, a ) ):p( e.isLeafNode(), 'A child remove without an old child only makes sense on a leaf node' ):a.isEmpty()?o.trackChildChange( Yn( t, n ) ):o.trackChildChange( Kn( t, n, a ) ) ), e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild( t, n ).withIndex( this.index_ ) )}, Jn.prototype.updateFullNode=function( e, t, n ) {return null!=n&&( e.isLeafNode()||e.forEachChild( gn, ( function( e, r ) {t.hasChild( e )||n.trackChildChange( Gn( e, r ) )} ) ), t.isLeafNode()||t.forEachChild( gn, ( function( t, r ) {var i; e.hasChild( t )?( i=e.getImmediateChild( t ) ).equals( r )||n.trackChildChange( Kn( t, r, i ) ):n.trackChildChange( Yn( t, r ) )} ) ) ), t.withIndex( this.index_ )}, Jn.prototype.updatePriority=function( e, t ) {return e.isEmpty()?Rn.EMPTY_NODE:e.updatePriority( t )}, Jn.prototype.filtersNodes=function() {return!1}, Jn.prototype.getIndexedFilter=function() {return this}, Jn.prototype.getIndex=function() {return this.index_}, Jn ); function Jn( e ) {this.index_=e}var Xn=( Zn.prototype.getStartPost=function() {return this.startPost_}, Zn.prototype.getEndPost=function() {return this.endPost_}, Zn.prototype.matches=function( e ) {return this.index_.compare( this.getStartPost(), e )<=0&&this.index_.compare( e, this.getEndPost() )<=0}, Zn.prototype.updateChild=function( e, t, n, r, i, o ) {return this.matches( new Ht( t, n ) )||( n=Rn.EMPTY_NODE ), this.indexedFilter_.updateChild( e, t, n, r, i, o )}, Zn.prototype.updateFullNode=function( e, t, n ) {t.isLeafNode()&&( t=Rn.EMPTY_NODE ); var r=( r=t.withIndex( this.index_ ) ).updatePriority( Rn.EMPTY_NODE ), i=this; return t.forEachChild( gn, ( function( e, t ) {i.matches( new Ht( e, t ) )||( r=r.updateImmediateChild( e, Rn.EMPTY_NODE ) )} ) ), this.indexedFilter_.updateFullNode( e, r, n )}, Zn.prototype.updatePriority=function( e, t ) {return e}, Zn.prototype.filtersNodes=function() {return!0}, Zn.prototype.getIndexedFilter=function() {return this.indexedFilter_}, Zn.prototype.getIndex=function() {return this.index_}, Zn.getStartPost_=function( e ) {if( e.hasStart() ) {var t=e.getIndexStartName(); return e.getIndex().makePost( e.getIndexStartValue(), t )}return e.getIndex().minPost()}, Zn.getEndPost_=function( e ) {if( e.hasEnd() ) {var t=e.getIndexEndName(); return e.getIndex().makePost( e.getIndexEndValue(), t )}return e.getIndex().maxPost()}, Zn ); function Zn( e ) {this.indexedFilter_=new $n( e.getIndex() ), this.index_=e.getIndex(), this.startPost_=Zn.getStartPost_( e ), this.endPost_=Zn.getEndPost_( e )}var er=( tr.prototype.updateChild=function( e, t, n, r, i, o ) {return this.rangedFilter_.matches( new Ht( t, n ) )||( n=Rn.EMPTY_NODE ), e.getImmediateChild( t ).equals( n )?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild( e, t, n, r, i, o ):this.fullLimitUpdateChild_( e, t, n, i, o )}, tr.prototype.updateFullNode=function( e, t, n ) {
        if( t.isLeafNode()||t.isEmpty() ) {r=Rn.EMPTY_NODE.withIndex( this.index_ )}
        else if( 2*this.limit_<t.numChildren()&&t.isIndexed( this.index_ ) ) {var r=Rn.EMPTY_NODE.withIndex( this.index_ ), i=void 0; i=this.reverse_?t.getReverseIteratorFrom( this.rangedFilter_.getEndPost(), this.index_ ):t.getIteratorFrom( this.rangedFilter_.getStartPost(), this.index_ ); for( var o=0; i.hasNext()&&o<this.limit_; ) {var a=i.getNext(); if( !( this.reverse_?this.index_.compare( this.rangedFilter_.getStartPost(), a )<=0:this.index_.compare( a, this.rangedFilter_.getEndPost() )<=0 ) ) {break}r=r.updateImmediateChild( a.name, a.node ), o++}}
        else{r=( r=t.withIndex( this.index_ ) ).updatePriority( Rn.EMPTY_NODE ); var s, u=void 0, l=void 0, c=void 0; i=void 0; c=this.reverse_?( i=r.getReverseIterator( this.index_ ), u=this.rangedFilter_.getEndPost(), l=this.rangedFilter_.getStartPost(), s=this.index_.getCompare(), function( e, t ) {return s( t, e )} ):( i=r.getIterator( this.index_ ), u=this.rangedFilter_.getStartPost(), l=this.rangedFilter_.getEndPost(), this.index_.getCompare() ); o=0; for( var h=!1; i.hasNext(); ) {a=i.getNext(), ( h=!h&&c( u, a )<=0||h )&&o<this.limit_&&c( a, l )<=0?o++:r=r.updateImmediateChild( a.name, Rn.EMPTY_NODE )}}return this.rangedFilter_.getIndexedFilter().updateFullNode( e, r, n );
      }, tr.prototype.updatePriority=function( e, t ) {return e}, tr.prototype.filtersNodes=function() {return!0}, tr.prototype.getIndexedFilter=function() {return this.rangedFilter_.getIndexedFilter()}, tr.prototype.getIndex=function() {return this.index_}, tr.prototype.fullLimitUpdateChild_=function( e, t, n, r, i ) {var o, a; a=this.reverse_?( o=this.index_.getCompare(), function( e, t ) {return o( t, e )} ):this.index_.getCompare(); var s=e; p( s.numChildren()===this.limit_, '' ); var u=new Ht( t, n ), l=this.reverse_?s.getFirstChild( this.index_ ):s.getLastChild( this.index_ ), c=this.rangedFilter_.matches( u ); if( s.hasChild( t ) ) {for( var h=s.getImmediateChild( t ), d=r.getChildAfterChild( this.index_, l, this.reverse_ ); null!=d&&( d.name===t||s.hasChild( d.name ) ); ) {d=r.getChildAfterChild( this.index_, d, this.reverse_ )}var f=null==d?1:a( d, u ); return c&&!n.isEmpty()&&0<=f?( null!=i&&i.trackChildChange( Kn( t, n, h ) ), s.updateImmediateChild( t, n ) ):( null!=i&&i.trackChildChange( Gn( t, h ) ), h=s.updateImmediateChild( t, Rn.EMPTY_NODE ), null!=d&&this.rangedFilter_.matches( d )?( null!=i&&i.trackChildChange( Yn( d.name, d.node ) ), h.updateImmediateChild( d.name, d.node ) ):h )}return!n.isEmpty()&&c&&0<=a( l, u )?( null!=i&&( i.trackChildChange( Gn( l.name, l.node ) ), i.trackChildChange( Yn( t, n ) ) ), s.updateImmediateChild( t, n ).updateImmediateChild( l.name, Rn.EMPTY_NODE ) ):e}, tr ); function tr( e ) {this.rangedFilter_=new Xn( e ), this.index_=e.getIndex(), this.limit_=e.getLimit(), this.reverse_=!e.isViewFromLeft()}var nr=( rr.prototype.hasStart=function() {return this.startSet_}, rr.prototype.hasStartAfter=function() {return this.startAfterSet_}, rr.prototype.hasEndBefore=function() {return this.endBeforeSet_}, rr.prototype.isViewFromLeft=function() {return''===this.viewFrom_?this.startSet_:'l'===this.viewFrom_}, rr.prototype.getIndexStartValue=function() {return p( this.startSet_, 'Only valid if start has been set' ), this.indexStartValue_}, rr.prototype.getIndexStartName=function() {return p( this.startSet_, 'Only valid if start has been set' ), this.startNameSet_?this.indexStartName_:Ie}, rr.prototype.hasEnd=function() {return this.endSet_}, rr.prototype.getIndexEndValue=function() {return p( this.endSet_, 'Only valid if end has been set' ), this.indexEndValue_}, rr.prototype.getIndexEndName=function() {return p( this.endSet_, 'Only valid if end has been set' ), this.endNameSet_?this.indexEndName_:Se}, rr.prototype.hasLimit=function() {return this.limitSet_}, rr.prototype.hasAnchoredLimit=function() {return this.limitSet_&&''!==this.viewFrom_}, rr.prototype.getLimit=function() {return p( this.limitSet_, 'Only valid if limit has been set' ), this.limit_}, rr.prototype.getIndex=function() {return this.index_}, rr.prototype.loadsAllData=function() {return!( this.startSet_||this.endSet_||this.limitSet_ )}, rr.prototype.isDefault=function() {return this.loadsAllData()&&this.index_===gn}, rr.prototype.copy=function() {var e=new rr; return e.limitSet_=this.limitSet_, e.limit_=this.limit_, e.startSet_=this.startSet_, e.indexStartValue_=this.indexStartValue_, e.startNameSet_=this.startNameSet_, e.indexStartName_=this.indexStartName_, e.endSet_=this.endSet_, e.indexEndValue_=this.indexEndValue_, e.endNameSet_=this.endNameSet_, e.indexEndName_=this.indexEndName_, e.index_=this.index_, e.viewFrom_=this.viewFrom_, e}, rr ); function rr() {this.limitSet_=!1, this.startSet_=!1, this.startNameSet_=!1, this.startAfterSet_=!1, this.endSet_=!1, this.endNameSet_=!1, this.endBeforeSet_=!1, this.limit_=0, this.viewFrom_='', this.indexStartValue_=null, this.indexStartName_='', this.indexEndValue_=null, this.indexEndName_='', this.index_=gn}function ir( e, t, n ) {return( e=e.copy() ).startSet_=!0, void 0===t&&( t=null ), e.indexStartValue_=t, null!=n?( e.startNameSet_=!0, e.indexStartName_=n ):( e.startNameSet_=!1, e.indexStartName_='' ), e}function or( e, t, n ) {return( e=e.copy() ).endSet_=!0, void 0===t&&( t=null ), e.indexEndValue_=t, void 0!==n?( e.endNameSet_=!0, e.indexEndName_=n ):( e.endNameSet_=!1, e.indexEndName_='' ), e}function ar( e, t ) {return( e=e.copy() ).index_=t, e}function sr( e ) {var t, n={}; return e.isDefault()||( t=e.index_===gn?'$priority':e.index_===zn?'$value':e.index_===Jt?'$key':( p( e.index_ instanceof Fn, 'Unrecognized index type!' ), e.index_.toString() ), n.orderBy=N( t ), e.startSet_&&( n.startAt=N( e.indexStartValue_ ), e.startNameSet_&&( n.startAt+=','+N( e.indexStartName_ ) ) ), e.endSet_&&( n.endAt=N( e.indexEndValue_ ), e.endNameSet_&&( n.endAt+=','+N( e.indexEndName_ ) ) ), e.limitSet_&&( e.isViewFromLeft()?n.limitToFirst=e.limit_:n.limitToLast=e.limit_ ) ), n}function ur( e ) {var t, n={}; return e.startSet_&&( n.sp=e.indexStartValue_, e.startNameSet_&&( n.sn=e.indexStartName_ ) ), e.endSet_&&( n.ep=e.indexEndValue_, e.endNameSet_&&( n.en=e.indexEndName_ ) ), e.limitSet_&&( n.l=e.limit_, ''===( t=e.viewFrom_ )&&( t=e.isViewFromLeft()?'l':'r' ), n.vf=t ), e.index_!==gn&&( n.i=e.index_.toString() ), n}var lr, cr=( r( hr, lr=pt ), hr.prototype.reportStats=function( e ) {throw new Error( 'Method not implemented.' )}, hr.getListenId_=function( e, t ) {return void 0!==t?'tag$'+t:( p( e._queryParams.isDefault(), 'should have a tag if it\'s not a default query.' ), e._path.toString() )}, hr.prototype.listen=function( e, t, n, r ) {var i=this, o=e._path.toString(); this.log_( 'Listen called for '+o+' '+e._queryIdentifier ); var a=hr.getListenId_( e, n ), s={}; this.listens_[a]=s, e=sr( e._queryParams ), this.restRequest_( o+'.json', e, ( function( e, t ) {null===( e=404===e?t=null:e )&&i.onDataUpdate_( o, t, !1, n ), k( i.listens_, a )===s&&r( e?401===e?'permission_denied':'rest_error:'+e:'ok', null )} ) )}, hr.prototype.unlisten=function( e, t ) {t=hr.getListenId_( e, t ), delete this.listens_[t]}, hr.prototype.get=function( e ) {var t=this, n=sr( e._queryParams ), r=e._path.toString(), i=new y; return this.restRequest_( r+'.json', n, ( function( e, n ) {null===( e=404===e?n=null:e )?( t.onDataUpdate_( r, n, !1, null ), i.resolve( n ) ):i.reject( new Error( n ) )} ) ), i.promise}, hr.prototype.refreshAuthToken=function( e ) {}, hr.prototype.restRequest_=function( e, t, n ) {
        var r=this; ( t=void 0===t?{}:t ).format='export', this.authTokenProvider_.getToken( !1 ).then( ( function( i ) {
          ( i=i&&i.accessToken )&&( t.auth=i ); var o=( r.repoInfo_.secure?'https://':'http://' )+r.repoInfo_.host+e+'?ns='+r.repoInfo_.namespace+function( e ) {for( var t=[], n=0, r=Object.entries( e ); n<r.length; n++ ) {var i=r[n]; !function( e, n ) {Array.isArray( n )?n.forEach( ( function( n ) {t.push( encodeURIComponent( e )+'='+encodeURIComponent( n ) )} ) ):t.push( encodeURIComponent( e )+'='+encodeURIComponent( n ) )}( i[0], i[1] )}return t.length?'&'+t.join( '&' ):''}( t ); r.log_( 'Sending REST request for '+o ); var a=new XMLHttpRequest; a.onreadystatechange=function() {
            if( n&&4===a.readyState ) {
              r.log_( 'REST Response for '+o+' received. status:', a.status, 'response:', a.responseText ); var e=null; if( 200<=a.status&&a.status<300 ) {
                try{e=T( a.responseText )}
                catch( e ) {Ee( 'Failed to parse JSON response for '+o+': '+a.responseText )}n( null, e );
              }
              else {401!==a.status&&404!==a.status&&Ee( 'Got unsuccessful REST response for '+o+' Status: '+a.status ), n( a.status )}n=null;
            }
          }, a.open( 'GET', o, !0 ), a.send();
        } ) );
      }, hr ); function hr( e, t, n ) {var r=lr.call( this )||this; return r.repoInfo_=e, r.onDataUpdate_=t, r.authTokenProvider_=n, r.log_=be( 'p:rest:' ), r.listens_={}, r}var pr=( dr.prototype.getNode=function( e ) {return this.rootNode_.getChild( e )}, dr.prototype.updateSnapshot=function( e, t ) {this.rootNode_=this.rootNode_.updateChild( e, t )}, dr ); function dr() {this.rootNode_=Rn.EMPTY_NODE}function fr() {return{ value: null, children: new Map }}function _r( e, t, n ) {var r; Rt( t )?( e.value=n, e.children.clear() ):null!==e.value?e.value=e.value.updateChild( t, n ):( r=Ct( t ), e.children.has( r )||e.children.set( r, fr() ), _r( e.children.get( r ), t=It( t ), n ) )}function yr( e, t, n ) {var r; null!==e.value?n( t, e.value ):( r=function( e, r ) {yr( r, new mt( t.toString()+'/'+e ), n )}, e.children.forEach( ( function( e, t ) {r( t, e )} ) ) )}var vr=( gr.prototype.get=function() {var e=this.collection_.get(), t=i( {}, e ); return this.last_&&Pe( this.last_, ( function( e, n ) {t[e]=t[e]-n} ) ), this.last_=e, t}, gr ); function gr( e ) {this.collection_=e, this.last_=null}var mr, wr=( br.prototype.reportStats_=function() {var e=this, t=this.statsListener_.get(), n={}, r=!1; Pe( t, ( function( t, i ) {0<i&&R( e.statsToReport_, t )&&( n[t]=i, r=!0 )} ) ), r&&this.server_.reportStats( n ), ke( this.reportStats_.bind( this ), Math.floor( 2*Math.random()*3e5 ) )}, br ); function br( e, t ) {this.server_=t, this.statsToReport_={}, this.statsListener_=new vr( e ), e=1e4+2e4*Math.random(), ke( this.reportStats_.bind( this ), Math.floor( e ) )}function Cr( e ) {return{ fromUser: !1, fromServer: !0, queryId: e, tagged: !0 }}( pt=mr=mr||{} )[pt.OVERWRITE=0]='OVERWRITE', pt[pt.MERGE=1]='MERGE', pt[pt.ACK_USER_WRITE=2]='ACK_USER_WRITE', pt[pt.LISTEN_COMPLETE=3]='LISTEN_COMPLETE'; var Er=( Ir.prototype.operationForChild=function( e ) {if( Rt( this.path ) ) {if( null!=this.affectedTree.value ) {return p( this.affectedTree.children.isEmpty(), 'affectedTree should not have overlapping affected paths.' ), this}var t=this.affectedTree.subtree( new mt( e ) ); return new Ir( bt(), t, this.revert )}return p( Ct( this.path )===e, 'operationForChild called for unrelated child.' ), new Ir( It( this.path ), this.affectedTree, this.revert )}, Ir ); function Ir( e, t, n ) {this.path=e, this.affectedTree=t, this.revert=n, this.type=mr.ACK_USER_WRITE, this.source={ fromUser: !0, fromServer: !1, queryId: null, tagged: !1 }}var Sr=( Tr.prototype.operationForChild=function( e ) {return Rt( this.path )?new Tr( this.source, bt() ):new Tr( this.source, It( this.path ) )}, Tr ); function Tr( e, t ) {this.source=e, this.path=t, this.type=mr.LISTEN_COMPLETE}var Nr=( Pr.prototype.operationForChild=function( e ) {return Rt( this.path )?new Pr( this.source, bt(), this.snap.getImmediateChild( e ) ):new Pr( this.source, It( this.path ), this.snap )}, Pr ); function Pr( e, t, n ) {this.source=e, this.path=t, this.snap=n, this.type=mr.OVERWRITE}var Rr=( kr.prototype.operationForChild=function( e ) {if( Rt( this.path ) ) {var t=this.children.subtree( new mt( e ) ); return t.isEmpty()?null:t.value?new Nr( this.source, bt(), t.value ):new kr( this.source, bt(), t )}return p( Ct( this.path )===e, 'Can\'t get a merge for a child not on the path of the operation' ), new kr( this.source, It( this.path ), this.children )}, kr.prototype.toString=function() {return'Operation('+this.path+': '+this.source.toString()+' merge: '+this.children.toString()+')'}, kr ); function kr( e, t, n ) {this.source=e, this.path=t, this.children=n, this.type=mr.MERGE}var xr=( Or.prototype.isFullyInitialized=function() {return this.fullyInitialized_}, Or.prototype.isFiltered=function() {return this.filtered_}, Or.prototype.isCompleteForPath=function( e ) {return Rt( e )?this.isFullyInitialized()&&!this.filtered_:( e=Ct( e ), this.isCompleteForChild( e ) )}, Or.prototype.isCompleteForChild=function( e ) {return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild( e )}, Or.prototype.getNode=function() {return this.node_}, Or ); function Or( e, t, n ) {this.node_=e, this.fullyInitialized_=t, this.filtered_=n}var Dr, Ar=function( e ) {this.query_=e, this.index_=this.query_._queryParams.getIndex()}; function Lr( e, t, n, r, i, o ) {( r=r.filter( ( function( e ) {return e.type===n} ) ) ).sort( ( function( t, n ) {return function( e, t, n ) {if( null==t.childName||null==n.childName ) {throw d( 'Should only compare child_ events.' )}return t=new Ht( t.childName, t.snapshotNode ), n=new Ht( n.childName, n.snapshotNode ), e.index_.compare( t, n )}( e, t, n )} ) ), r.forEach( ( function( n ) {var r, a, s, u=( r=e, s=o, 'value'===( a=n ).type||'child_removed'===a.type||( a.prevName=s.getPredecessorChildName( a.childName, a.snapshotNode, r.index_ ) ), a ); i.forEach( ( function( r ) {r.respondsTo( n.type )&&t.push( r.createEvent( u, e.query_ ) )} ) )} ) )}function Fr( e, t ) {return{ eventCache: e, serverCache: t }}function Mr( e, t, n, r ) {return Fr( new xr( t, n, r ), e.serverCache )}function qr( e, t, n, r ) {return Fr( e.eventCache, new xr( t, n, r ) )}function jr( e ) {return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function Wr( e ) {return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}var Ur=( Br.fromObject=function( e ) {var t=new Br( null ); return Pe( e, ( function( e, n ) {t=t.set( new mt( e ), n )} ) ), t}, Br.prototype.isEmpty=function() {return null===this.value&&this.children.isEmpty()}, Br.prototype.findRootMostMatchingPathAndValue=function( e, t ) {if( null!=this.value&&t( this.value ) ) {return{ path: bt(), value: this.value }}if( Rt( e ) ) {return null}var n=Ct( e ), r=this.children.get( n ); return null===r||null==( t=r.findRootMostMatchingPathAndValue( It( e ), t ) )?null:{ path: Pt( new mt( n ), t.path ), value: t.value }}, Br.prototype.findRootMostValueAndPath=function( e ) {return this.findRootMostMatchingPathAndValue( e, ( function() {return!0} ) )}, Br.prototype.subtree=function( e ) {if( Rt( e ) ) {return this}var t=Ct( e ); return null!==( t=this.children.get( t ) )?t.subtree( It( e ) ):new Br( null )}, Br.prototype.set=function( e, t ) {if( Rt( e ) ) {return new Br( t, this.children )}var n=Ct( e ); t=( this.children.get( n )||new Br( null ) ).set( It( e ), t ), t=this.children.insert( n, t ); return new Br( this.value, t )}, Br.prototype.remove=function( e ) {if( Rt( e ) ) {return this.children.isEmpty()?new Br( null ):new Br( null, this.children )}var t=Ct( e ), n=this.children.get( t ); return n?( n=n.remove( It( e ) ), e=void 0, e=n.isEmpty()?this.children.remove( t ):this.children.insert( t, n ), null===this.value&&e.isEmpty()?new Br( null ):new Br( this.value, e ) ):this}, Br.prototype.get=function( e ) {if( Rt( e ) ) {return this.value}var t=Ct( e ); return( t=this.children.get( t ) )?t.get( It( e ) ):null}, Br.prototype.setTree=function( e, t ) {if( Rt( e ) ) {return t}var n=Ct( e ); e=( this.children.get( n )||new Br( null ) ).setTree( It( e ), t ), t=void 0, t=e.isEmpty()?this.children.remove( n ):this.children.insert( n, e ); return new Br( this.value, t )}, Br.prototype.fold=function( e ) {return this.fold_( bt(), e )}, Br.prototype.fold_=function( e, t ) {var n={}; return this.children.inorderTraversal( ( function( r, i ) {n[r]=i.fold_( Pt( e, r ), t )} ) ), t( e, this.value, n )}, Br.prototype.findOnPath=function( e, t ) {return this.findOnPath_( e, bt(), t )}, Br.prototype.findOnPath_=function( e, t, n ) {if( r=!!this.value&&n( t, this.value ) ) {return r}if( Rt( e ) ) {return null}var r, i=Ct( e ); return( r=this.children.get( i ) )?r.findOnPath_( It( e ), Pt( t, i ), n ):null}, Br.prototype.foreachOnPath=function( e, t ) {return this.foreachOnPath_( e, bt(), t )}, Br.prototype.foreachOnPath_=function( e, t, n ) {if( Rt( e ) ) {return this}this.value&&n( t, this.value ); var r=Ct( e ), i=this.children.get( r ); return i?i.foreachOnPath_( It( e ), Pt( t, r ), n ):new Br( null )}, Br.prototype.foreach=function( e ) {this.foreach_( bt(), e )}, Br.prototype.foreach_=function( e, t ) {this.children.inorderTraversal( ( function( n, r ) {r.foreach_( Pt( e, n ), t )} ) ), this.value&&t( e, this.value )}, Br.prototype.foreachChild=function( e ) {this.children.inorderTraversal( ( function( t, n ) {n.value&&e( t, n.value )} ) )}, Br ); function Br( e, t ) {void 0===t&&( t=Dr=Dr||new on( ue ) ), this.value=e, this.children=t}var zr=( Hr.empty=function() {return new Hr( new Ur( null ) )}, Hr ); function Hr( e ) {this.writeTree_=e}function Vr( e, t, n ) {if( Rt( t ) ) {return new zr( new Ur( n ) )}if( null!=( o=e.writeTree_.findRootMostValueAndPath( t ) ) ) {var r=o.path, i=o.value, o=kt( r, t ); i=i.updateChild( o, n ); return new zr( e.writeTree_.set( r, i ) )}return n=new Ur( n ), n=e.writeTree_.setTree( t, n ), new zr( n )}function Qr( e, t, n ) {var r=e; return Pe( n, ( function( e, n ) {r=Vr( r, Pt( t, e ), n )} ) ), r}function Yr( e, t ) {return Rt( t )?zr.empty():( t=e.writeTree_.setTree( t, new Ur( null ) ), new zr( t ) )}function Gr( e, t ) {return null!=Kr( e, t )}function Kr( e, t ) {var n=e.writeTree_.findRootMostValueAndPath( t ); return null!=n?e.writeTree_.get( n.path ).getChild( kt( n.path, t ) ):null}function $r( e ) {var t=[], n=e.writeTree_.value; return null!=n?n.isLeafNode()||n.forEachChild( gn, ( function( e, n ) {t.push( new Ht( e, n ) )} ) ):e.writeTree_.children.inorderTraversal( ( function( e, n ) {null!=n.value&&t.push( new Ht( e, n.value ) )} ) ), t}function Jr( e, t ) {if( Rt( t ) ) {return e}var n=Kr( e, t ); return new zr( null!=n?new Ur( n ):e.writeTree_.subtree( t ) )}function Xr( e ) {return e.writeTree_.isEmpty()}function Zr( e, t ) {return function e( t, n, r ) {if( null!=n.value ) {return r.updateChild( t, n.value )}var i=null; return n.children.inorderTraversal( ( function( n, o ) {'.priority'===n?( p( null!==o.value, 'Priority writes must always be leaf nodes' ), i=o.value ):r=e( Pt( t, n ), o, r )} ) ), r=r.getChild( t ).isEmpty()||null===i?r:r.updateChild( Pt( t, '.priority' ), i )}( bt(), e.writeTree_, t )}function ei( e, t ) {return ci( t, e )}function ti( e ) {return e.visible}function ni( e, t, n ) {
        for( var r=zr.empty(), i=0; i<e.length; ++i ) {
          var o=e[i]; if( t( o ) ) {
            var a=o.path, s=void 0; if( o.snap ) {Dt( n, a )?r=Vr( r, s=kt( n, a ), o.snap ):Dt( a, n )&&( s=kt( a, n ), r=Vr( r, bt(), o.snap.getChild( s ) ) )}
            else{if( !o.children ) {throw d( 'WriteRecord should have .snap or .children' )}Dt( n, a )?r=Qr( r, s=kt( n, a ), o.children ):Dt( a, n )&&( Rt( s=kt( a, n ) )?r=Qr( r, bt(), o.children ):( o=k( o.children, Ct( s ) ) )&&( s=o.getChild( It( s ) ), r=Vr( r, bt(), s ) ) )}
          }
        }return r;
      }function ri( e, t, n, r, i ) {if( r||i ) {var o=Jr( e.visibleWrites, t ); return!i&&Xr( o )?n:i||null!=n||Gr( o, bt() )?Zr( ni( e.allWrites, ( function( e ) {return( e.visible||i )&&( !r||!~r.indexOf( e.writeId ) )&&( Dt( e.path, t )||Dt( t, e.path ) )} ), t ), n||Rn.EMPTY_NODE ):null}return null!=( o=Kr( e.visibleWrites, t ) )?o:Xr( e=Jr( e.visibleWrites, t ) )?n:null!=n||Gr( e, bt() )?Zr( e, n||Rn.EMPTY_NODE ):null}function ii( e, t, n, r ) {return ri( e.writeTree, e.treePath, t, n, r )}function oi( e, t ) {return function( e, t, n ) {var r=Rn.EMPTY_NODE, i=Kr( e.visibleWrites, t ); if( i ) {return i.isLeafNode()||i.forEachChild( gn, ( function( e, t ) {r=r.updateImmediateChild( e, t )} ) ), r}if( n ) {var o=Jr( e.visibleWrites, t ); return n.forEachChild( gn, ( function( e, t ) {t=Zr( Jr( o, new mt( e ) ), t ), r=r.updateImmediateChild( e, t )} ) ), $r( o ).forEach( ( function( e ) {r=r.updateImmediateChild( e.name, e.node )} ) ), r}return $r( Jr( e.visibleWrites, t ) ).forEach( ( function( e ) {r=r.updateImmediateChild( e.name, e.node )} ) ), r}( e.writeTree, e.treePath, t )}function ai( e, t, n, r ) {return i=e.writeTree, e=e.treePath, t=t, r=r, p( n||r, 'Either existingEventSnap or existingServerSnap must exist' ), e=Pt( e, t ), Gr( i.visibleWrites, e )?null:Xr( e=Jr( i.visibleWrites, e ) )?r.getChild( t ):Zr( e, r.getChild( t ) ); var i}function si( e, t ) {return n=e.writeTree, t=Pt( e.treePath, t ), Kr( n.visibleWrites, t ); var n}function ui( e, t, n ) {return r=e.writeTree, i=e.treePath, e=n, t=Pt( i, n=t ), null!=( i=Kr( r.visibleWrites, t ) )?i:e.isCompleteForChild( n )?Zr( Jr( r.visibleWrites, t ), e.getNode().getImmediateChild( n ) ):null; var r, i}function li( e, t ) {return ci( Pt( e.treePath, t ), e.writeTree )}function ci( e, t ) {return{ treePath: e, writeTree: t }}var hi=( pi.prototype.trackChildChange=function( e ) {
        var t=e.type, n=e.childName; p( 'child_added'===t||'child_changed'===t||'child_removed'===t, 'Only child changes supported for tracking' ), p( '.priority'!==n, 'Only non-priority child changes can be tracked.' ); var r=this.changeMap.get( n ); if( r ) {
          var i=r.type; if( 'child_added'===t&&'child_removed'===i ) {this.changeMap.set( n, Kn( n, e.snapshotNode, r.snapshotNode ) )}
          else if( 'child_removed'===t&&'child_added'===i ) {this.changeMap.delete( n )}
          else if( 'child_removed'===t&&'child_changed'===i ) {this.changeMap.set( n, Gn( n, r.oldSnap ) )}
          else if( 'child_changed'===t&&'child_added'===i ) {this.changeMap.set( n, Yn( n, e.snapshotNode ) )}
          else{if( 'child_changed'!==t||'child_changed'!==i ) {throw d( 'Illegal combination of changes: '+e+' occurred after '+r )}this.changeMap.set( n, Kn( n, e.snapshotNode, r.oldSnap ) )}
        }
        else {this.changeMap.set( n, e )}
      }, pi.prototype.getChanges=function() {return Array.from( this.changeMap.values() )}, pi ); function pi() {this.changeMap=new Map}function di() {}var fi=new( di.prototype.getCompleteChild=function( e ) {return null}, di.prototype.getChildAfterChild=function( e, t, n ) {return null}, di ), _i=( yi.prototype.getCompleteChild=function( e ) {var t=this.viewCache_.eventCache; return t.isCompleteForChild( e )?t.getNode().getImmediateChild( e ):( t=null!=this.optCompleteServerCache_?new xr( this.optCompleteServerCache_, !0, !1 ):this.viewCache_.serverCache, ui( this.writes_, e, t ) )}, yi.prototype.getChildAfterChild=function( e, t, n ) {
        var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Wr( this.viewCache_ ); return 0===( e=function( e, t, n, r, i, o ) {
          return function( e, t, n, r, i, o, a ) {
            var s; if( null!=( t=Kr( e=Jr( e.visibleWrites, t ), bt() ) ) ) {s=t}
            else{if( null==n ) {return[]}s=Zr( e, n )}if( ( s=s.withIndex( a ) ).isEmpty()||s.isLeafNode() ) {return[]}for( var u=[], l=a.getCompare(), c=o?s.getReverseIteratorFrom( r, a ):s.getIteratorFrom( r, a ), h=c.getNext(); h&&u.length<i; ) {0!==l( h, r )&&u.push( h ), h=c.getNext()}return u;
          }( e.writeTree, e.treePath, t, n, r, i, o );
        }( this.writes_, r, t, 1, n, e ) ).length?null:e[0];
      }, yi ); function yi( e, t, n ) {void 0===n&&( n=null ), this.writes_=e, this.viewCache_=t, this.optCompleteServerCache_=n}function vi( e, t, n, r, i, o ) {var a=t.eventCache; if( null!=si( r, n ) ) {return t}var s, u, l, c, h, d=void 0; return h=Rt( n )?( p( t.serverCache.isFullyInitialized(), 'If change path is empty, we must have complete server data' ), t.serverCache.isFiltered()?( s=oi( r, ( s=Wr( t ) )instanceof Rn?s:Rn.EMPTY_NODE ), e.filter.updateFullNode( t.eventCache.getNode(), s, o ) ):( u=ii( r, Wr( t ) ), e.filter.updateFullNode( t.eventCache.getNode(), u, o ) ) ):'.priority'===( u=Ct( n ) )?( p( 1===Et( n ), 'Can\'t have a priority with additional path components' ), null!=( c=ai( r, n, l=a.getNode(), d=t.serverCache.getNode() ) )?e.filter.updatePriority( l, c ):a.getNode() ):( l=It( n ), c=void 0, null!=( c=a.isCompleteForChild( u )?( d=t.serverCache.getNode(), null!=( d=ai( r, n, a.getNode(), d ) )?a.getNode().getImmediateChild( u ).updateChild( l, d ):a.getNode().getImmediateChild( u ) ):ui( r, u, t.serverCache ) )?e.filter.updateChild( a.getNode(), u, c, l, i, o ):a.getNode() ), Mr( t, h, a.isFullyInitialized()||Rt( n ), e.filter.filtersNodes() )}function gi( e, t, n, r, i, o, a, s ) {
        var u=t.serverCache, l=a?e.filter:e.filter.getIndexedFilter(); if( Rt( n ) ) {h=l.updateFullNode( u.getNode(), r, null )}
        else if( l.filtersNodes()&&!u.isFiltered() ) {var c=u.getNode().updateChild( n, r ), h=l.updateFullNode( u.getNode(), c, null )}
        else{if( a=Ct( n ), !u.isCompleteForPath( n )&&1<Et( n ) ) {return t}c=It( n ), r=u.getNode().getImmediateChild( a ).updateChild( c, r ), h='.priority'===a?l.updatePriority( u.getNode(), r ):l.updateChild( u.getNode(), a, r, c, fi, null )}return vi( e, l=qr( t, h, u.isFullyInitialized()||Rt( n ), l.filtersNodes() ), n, i, new _i( i, l, o ), s );
      }function mi( e, t, n, r, i, o, a ) {var s, u, l=t.eventCache, c=new _i( i, t, o ); return Rt( n )?( u=e.filter.updateFullNode( t.eventCache.getNode(), r, a ), Mr( t, u, !0, e.filter.filtersNodes() ) ):'.priority'===( s=Ct( n ) )?( u=e.filter.updatePriority( t.eventCache.getNode(), r ), Mr( t, u, l.isFullyInitialized(), l.isFiltered() ) ):( i=It( n ), o=l.getNode().getImmediateChild( s ), u=void 0, u=Rt( i )?r:null!=( n=c.getCompleteChild( s ) )?'.priority'===St( i )&&n.getChild( Nt( i ) ).isEmpty()?n:n.updateChild( i, r ):Rn.EMPTY_NODE, o.equals( u )?t:Mr( t, e.filter.updateChild( l.getNode(), s, u, i, c, a ), l.isFullyInitialized(), e.filter.filtersNodes() ) )}function wi( e, t ) {return e.eventCache.isCompleteForChild( t )}function bi( e, t, n ) {return n.foreach( ( function( e, n ) {t=t.updateChild( e, n )} ) ), t}function Ci( e, t, n, r, i, o, a, s ) {if( t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized() ) {return t}var u=t, l=( r=Rt( n )?r:new Ur( null ).setTree( n, r ), t.serverCache.getNode() ); return r.children.inorderTraversal( ( function( n, r ) {l.hasChild( n )&&( r=bi( 0, t.serverCache.getNode().getImmediateChild( n ), r ), u=gi( e, u, new mt( n ), r, i, o, a, s ) )} ) ), r.children.inorderTraversal( ( function( n, r ) {var c=!t.serverCache.isCompleteForChild( n )&&void 0===r.value; l.hasChild( n )||c||( r=bi( 0, t.serverCache.getNode().getImmediateChild( n ), r ), u=gi( e, u, new mt( n ), r, i, o, a, s ) )} ) ), u}var Ei, Ii=( Object.defineProperty( Si.prototype, 'query', { get: function() {return this.query_}, enumerable: !1, configurable: !0 } ), Si ); function Si( e, t ) {this.query_=e, this.eventRegistrations_=[]; var n=this.query_._queryParams, r=new $n( n.getIndex() ), i=( o=n ).loadsAllData()?new $n( o.getIndex() ):new( o.hasLimit()?er:Xn )( o ); this.processor_={ filter: i }; e=t.serverCache, n=t.eventCache; var o=r.updateFullNode( Rn.EMPTY_NODE, e.getNode(), null ); t=i.updateFullNode( Rn.EMPTY_NODE, n.getNode(), null ), r=new xr( o, e.isFullyInitialized(), r.filtersNodes() ), i=new xr( t, n.isFullyInitialized(), i.filtersNodes() ); this.viewCache_=Fr( i, r ), this.eventGenerator_=new Ar( this.query_ )}function Ti( e ) {return 0===e.eventRegistrations_.length}function Ni( e, t, n ) {
        var r, i=[]; if( n&&( p( null==t, 'A cancel should cancel all event registrations.' ), r=e.query._path, e.eventRegistrations_.forEach( ( function( e ) {( e=e.createCancelEvent( n, r ) )&&i.push( e )} ) ) ), t ) {
          for( var o=[], a=0; a<e.eventRegistrations_.length; ++a ) {
            var s=e.eventRegistrations_[a]; if( s.matches( t ) ) {if( t.hasAnyCallback() ) {o=o.concat( e.eventRegistrations_.slice( a+1 ) ); break}}
            else {o.push( s )}
          }e.eventRegistrations_=o;
        }
        else {e.eventRegistrations_=[]}return i;
      }function Pi( e, t, n, r ) {
        t.type===mr.MERGE&&null!==t.source.queryId&&( p( Wr( e.viewCache_ ), 'We should always have a full cache before handling merges' ), p( jr( e.viewCache_ ), 'Missing event cache, even though we have a server cache' ) ); var i=e.viewCache_; t=function( e, t, n, r, i ) {
          var o, a, s, u, l, c, h, f, _=new hi; if( n.type===mr.OVERWRITE ) {var y=n, v=y.source.fromUser?mi( e, t, y.path, y.snap, r, i, _ ):( p( y.source.fromServer, 'Unknown source.' ), o=y.source.tagged||t.serverCache.isFiltered()&&!Rt( y.path ), gi( e, t, y.path, y.snap, r, i, o, _ ) )}
          else if( n.type===mr.MERGE ) {var g=n; v=g.source.fromUser?( a=e, s=t, u=g.path, y=g.children, l=r, c=i, h=_, f=s, y.foreach( ( function( e, t ) {e=Pt( u, e ), wi( s, Ct( e ) )&&( f=mi( a, f, e, t, l, c, h ) )} ) ), y.foreach( ( function( e, t ) {e=Pt( u, e ), wi( s, Ct( e ) )||( f=mi( a, f, e, t, l, c, h ) )} ) ), f ):( p( g.source.fromServer, 'Unknown source.' ), o=g.source.tagged||t.serverCache.isFiltered(), Ci( e, t, g.path, g.children, r, i, o, _ ) )}
          else if( n.type===mr.ACK_USER_WRITE ) {var m=n; v=m.revert?function( e, t, n, r, i, o ) {var a; if( null!=si( r, n ) ) {return t}var s, u, l=new _i( r, t, i ), c=t.eventCache.getNode(); i=void 0; return Rt( n )||'.priority'===Ct( n )?( u=void 0, u=t.serverCache.isFullyInitialized()?ii( r, Wr( t ) ):( s=t.serverCache.getNode(), p( s instanceof Rn, 'serverChildren would be complete if leaf node' ), oi( r, s ) ), i=e.filter.updateFullNode( c, u, o ) ):( null==( u=ui( r, s=Ct( n ), t.serverCache ) )&&t.serverCache.isCompleteForChild( s )&&( u=c.getImmediateChild( s ) ), ( i=null!=u?e.filter.updateChild( c, s, u, It( n ), l, o ):t.eventCache.getNode().hasChild( s )?e.filter.updateChild( c, s, Rn.EMPTY_NODE, It( n ), l, o ):c ).isEmpty()&&t.serverCache.isFullyInitialized()&&( a=ii( r, Wr( t ) ) ).isLeafNode()&&( i=e.filter.updateFullNode( i, a, o ) ) ), a=t.serverCache.isFullyInitialized()||null!=si( r, bt() ), Mr( t, i, a, e.filter.filtersNodes() )}( e, t, m.path, r, i, _ ):function( e, t, n, r, i, o, a ) {if( null!=si( i, n ) ) {return t}var s=t.serverCache.isFiltered(), u=t.serverCache; if( null!=r.value ) {if( Rt( n )&&u.isFullyInitialized()||u.isCompleteForPath( n ) ) {return gi( e, t, n, u.getNode().getChild( n ), i, o, s, a )}if( Rt( n ) ) {var l=new Ur( null ); return u.getNode().forEachChild( Jt, ( function( e, t ) {l=l.set( new mt( e ), t )} ) ), Ci( e, t, n, l, i, o, s, a )}return t}var c=new Ur( null ); return r.foreach( ( function( e, t ) {var r=Pt( n, e ); u.isCompleteForPath( r )&&( c=c.set( e, u.getNode().getChild( r ) ) )} ) ), Ci( e, t, n, c, i, o, s, a )}( e, t, m.path, m.affectedTree, r, i, _ )}
          else{if( n.type!==mr.LISTEN_COMPLETE ) {throw d( 'Unknown operation type: '+n.type )}o=e, m=t, i=n.path, e=r, n=_, v=vi( o, r=qr( m, ( r=m.serverCache ).getNode(), r.isFullyInitialized()||Rt( i ), r.isFiltered() ), i, e, fi, n )}return function( e, t, n ) {var r, i, o=t.eventCache; o.isFullyInitialized()&&( r=o.getNode().isLeafNode()||o.getNode().isEmpty(), i=jr( e ), ( 0<n.length||!e.eventCache.isFullyInitialized()||r&&!o.getNode().equals( i )||!o.getNode().getPriority().equals( i.getPriority() ) )&&n.push( Qn( jr( t ) ) ) )}( t, v, _=_.getChanges() ), { viewCache: v, changes: _ };
        }( e.processor_, i, t, n, r ); return n=e.processor_, r=t.viewCache, p( r.eventCache.getNode().isIndexed( n.filter.getIndex() ), 'Event snap not indexed' ), p( r.serverCache.getNode().isIndexed( n.filter.getIndex() ), 'Server snap not indexed' ), p( t.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(), 'Once a server snap is complete, it should never go back' ), e.viewCache_=t.viewCache, Ri( e, t.changes, t.viewCache.eventCache.getNode(), null );
      }function Ri( e, t, n, r ) {return r=r?[r]:e.eventRegistrations_, function( e, t, n, r ) {var i=[], o=[]; return t.forEach( ( function( t ) {var n; 'child_changed'===t.type&&e.index_.indexedValueChanged( t.oldSnap, t.snapshotNode )&&o.push( ( n=t.childName, { type: 'child_moved', snapshotNode: t.snapshotNode, childName: n } ) )} ) ), Lr( e, i, 'child_removed', t, r, n ), Lr( e, i, 'child_added', t, r, n ), Lr( e, i, 'child_moved', o, r, n ), Lr( e, i, 'child_changed', t, r, n ), Lr( e, i, 'value', t, r, n ), i}( e.eventGenerator_, t, n, r )}var ki, xi=function() {this.views=new Map}; function Oi( e, t, n, r ) {
        var i, a, s=t.source.queryId; if( null!==s ) {var u=e.views.get( s ); return p( null!=u, 'SyncTree gave us an op for an invalid query.' ), Pi( u, t, n, r )}var l=[]; try{for( var c=o( e.views.values() ), h=c.next(); !h.done; h=c.next() ) {u=h.value, l=l.concat( Pi( u, t, n, r ) )}}
        catch( e ) {i={ error: e }}
        finally{
          try{h&&!h.done&&( a=c.return )&&a.call( c )}
          finally{if( i ) {throw i.error}}
        }return l;
      }function Di( e, t, n, r, i ) {var o=t._queryIdentifier; return( e=e.views.get( o ) )?e:( e=!1, e=!!( o=ii( n, i?r:null ) )||( o=r instanceof Rn?oi( n, r ):Rn.EMPTY_NODE, !1 ), i=Fr( new xr( o, e, !1 ), new xr( r, i, !1 ) ), new Ii( t, i ) )}function Ai( e ) {
        var t, n, r=[]; try{for( var i=o( e.views.values() ), a=i.next(); !a.done; a=i.next() ) {var s=a.value; s.query._queryParams.loadsAllData()||r.push( s )}}
        catch( e ) {t={ error: e }}
        finally{
          try{a&&!a.done&&( n=i.return )&&n.call( i )}
          finally{if( t ) {throw t.error}}
        }return r;
      }function Li( e, t ) {
        var n, r, i, a, s=null; try{for( var u=o( e.views.values() ), l=u.next(); !l.done; l=u.next() ) {var c=l.value; s=s||( i=t, a=void 0, ( a=Wr( ( c=c ).viewCache_ ) )&&( c.query._queryParams.loadsAllData()||!Rt( i )&&!a.getImmediateChild( Ct( i ) ).isEmpty() )?a.getChild( i ):null )}}
        catch( e ) {n={ error: e }}
        finally{
          try{l&&!l.done&&( r=u.return )&&r.call( u )}
          finally{if( n ) {throw n.error}}
        }return s;
      }function Fi( e, t ) {return t._queryParams.loadsAllData()?ji( e ):( t=t._queryIdentifier, e.views.get( t ) )}function Mi( e, t ) {return null!=Fi( e, t )}function qi( e ) {return null!=ji( e )}function ji( e ) {
        var t, n; try{for( var r=o( e.views.values() ), i=r.next(); !i.done; i=r.next() ) {var a=i.value; if( a.query._queryParams.loadsAllData() ) {return a}}}
        catch( e ) {t={ error: e }}
        finally{
          try{i&&!i.done&&( n=r.return )&&n.call( r )}
          finally{if( t ) {throw t.error}}
        }return null;
      }var Wi=1, Ui=function( e ) {this.listenProvider_=e, this.syncPointTree_=new Ur( null ), this.pendingWriteTree_={ visibleWrites: zr.empty(), allWrites: [], lastWriteId: -1 }, this.tagToQueryMap=new Map, this.queryToTagMap=new Map}; function Bi( e, t, n, r, i ) {var o, a, s, u; return o=e.pendingWriteTree_, a=t, s=n, u=i, p( ( r=r )>o.lastWriteId, 'Stacking an older write on top of newer ones' ), void 0===u&&( u=!0 ), o.allWrites.push( { path: a, snap: s, writeId: r, visible: u } ), u&&( o.visibleWrites=Vr( o.visibleWrites, a, s ) ), o.lastWriteId=r, i?Gi( e, new Nr( { fromUser: !0, fromServer: !1, queryId: null, tagged: !1 }, t, n ) ):[]}function zi( e, t, n ) {void 0===n&&( n=!1 ); var r=function( e, t ) {for( var n=0; n<e.allWrites.length; n++ ) {var r=e.allWrites[n]; if( r.writeId===t ) {return r}}return null}( e.pendingWriteTree_, t ); if( function( e, t ) {var n=e.allWrites.findIndex( ( function( e ) {return e.writeId===t} ) ); p( 0<=n, 'removeWrite called with nonexistent writeId.' ); var r=e.allWrites[n]; e.allWrites.splice( n, 1 ); for( var i, o=r.visible, a=!1, s=e.allWrites.length-1; o&&0<=s; ) {var u=e.allWrites[s]; u.visible&&( n<=s&&function( e, t ) {if( e.snap ) {return Dt( e.path, t )}for( var n in e.children ) {if( e.children.hasOwnProperty( n )&&Dt( Pt( e.path, n ), t ) ) {return!0}}return!1}( u, r.path )?o=!1:Dt( r.path, u.path )&&( a=!0 ) ), s--}return!!o&&( a?( ( i=e ).visibleWrites=ni( i.allWrites, ti, bt() ), 0<i.allWrites.length?i.lastWriteId=i.allWrites[i.allWrites.length-1].writeId:i.lastWriteId=-1 ):r.snap?e.visibleWrites=Yr( e.visibleWrites, r.path ):Pe( r.children, ( function( t ) {e.visibleWrites=Yr( e.visibleWrites, Pt( r.path, t ) )} ) ), !0 )}( e.pendingWriteTree_, t ) ) {var i=new Ur( null ); return null!=r.snap?i=i.set( bt(), !0 ):Pe( r.children, ( function( e ) {i=i.set( new mt( e ), !0 )} ) ), Gi( e, new Er( r.path, i, n ) )}return[]}function Hi( e, t, n ) {return Gi( e, new Nr( { fromUser: !1, fromServer: !0, queryId: null, tagged: !1 }, t, n ) )}function Vi( e, t, n, r ) {
        var i=t._path, s=e.syncPointTree_.get( i ), u=[]; if( s&&( 'default'===t._queryIdentifier||Mi( s, t ) ) ) {
          var l=function( e, t, n, r ) {
            var i, s, u=t._queryIdentifier, l=[], c=[], h=qi( e ); if( 'default'===u ) {
              try{for( var d=o( e.views.entries() ), f=d.next(); !f.done; f=d.next() ) {var _=a( f.value, 2 ), y=_[0], v=_[1]; c=c.concat( Ni( v, n, r ) ); Ti( v )&&( e.views.delete( y ), v.query._queryParams.loadsAllData()||l.push( v.query ) )}}
              catch( e ) {i={ error: e }}
              finally{
                try{f&&!f.done&&( s=d.return )&&s.call( d )}
                finally{if( i ) {throw i.error}}
              }
            }
            else{( v=e.views.get( u ) )&&( c=c.concat( Ni( v, n, r ) ), Ti( v )&&( e.views.delete( u ), v.query._queryParams.loadsAllData()||l.push( v.query ) ) )}return h&&!qi( e )&&l.push( ( p( Ei, 'Reference.ts has not been loaded' ), new Ei( t._repo, t._path ) ) ), { removed: l, events: c };
          }( s, t, n, r ); if( 0===s.views.size&&( e.syncPointTree_=e.syncPointTree_.remove( i ) ), n=l.removed, u=l.events, s=-1!==n.findIndex( ( function( e ) {return e._queryParams.loadsAllData()} ) ), l=e.syncPointTree_.findOnPath( i, ( function( e, t ) {return qi( t )} ) ), s&&!l&&!( i=e.syncPointTree_.subtree( i ) ).isEmpty() ) {for( var c=i.fold( ( function( e, t, n ) {if( t&&qi( t ) ) {return[ji( t )]}var r=[]; return t&&( r=Ai( t ) ), Pe( n, ( function( e, t ) {r=r.concat( t )} ) ), r} ) ), h=0; h<c.length; ++h ) {var d=( f=c[h] ).query, f=Ki( e, f ); e.listenProvider_.startListening( to( d ), $i( e, d ), f.hashFn, f.onComplete )}}!l&&0<n.length&&!r&&( s?e.listenProvider_.stopListening( to( t ), null ):n.forEach( ( function( t ) {var n=e.queryToTagMap.get( Ji( t ) ); e.listenProvider_.stopListening( to( t ), n )} ) ) ), function( e, t ) {for( var n=0; n<t.length; ++n ) {var r, i=t[n]; i._queryParams.loadsAllData()||( r=Ji( i ), i=e.queryToTagMap.get( r ), e.queryToTagMap.delete( r ), e.tagToQueryMap.delete( i ) )}}( e, n );
        }return u;
      }function Qi( e, t, n ) {
        var r=t._path, i=null, o=!1; e.syncPointTree_.foreachOnPath( r, ( function( e, t ) {e=kt( e, r ), i=i||Li( t, e ), o=o||qi( t )} ) ); var a=e.syncPointTree_.get( r ); a?( o=o||qi( a ), i=i||Li( a, bt() ) ):( a=new xi, e.syncPointTree_=e.syncPointTree_.set( r, a ) ), null!=i?c=!0:( c=!1, i=Rn.EMPTY_NODE, e.syncPointTree_.subtree( r ).foreachChild( ( function( e, t ) {( t=Li( t, bt() ) )&&( i=i.updateImmediateChild( e, t ) )} ) ) ); var s, u, l=Mi( a, t ); l||t._queryParams.loadsAllData()||( s=Ji( t ), p( !e.queryToTagMap.has( s ), 'View does not exist, but we have a tag' ), u=Wi++, e.queryToTagMap.set( s, u ), e.tagToQueryMap.set( u, s ) ); var c=function( e, t, n, r, i, o ) {var a; return o=Di( e, t, r, i, o ), e.views.has( t._queryIdentifier )||e.views.set( t._queryIdentifier, o ), t=n, o.eventRegistrations_.push( t ), t=n, o=( n=o ).viewCache_.eventCache, a=[], o.getNode().isLeafNode()||o.getNode().forEachChild( gn, ( function( e, t ) {a.push( Yn( e, t ) )} ) ), o.isFullyInitialized()&&a.push( Qn( o.getNode() ) ), Ri( n, a, o.getNode(), t )}( a, t, n, ei( e.pendingWriteTree_, r ), i, c ); return l||o||( a=Fi( a, t ), c=c.concat( function( e, t, n ) {
          var r=t._path, i=$i( e, t ); n=Ki( e, n ), n=e.listenProvider_.startListening( to( t ), i, n.hashFn, n.onComplete ), r=e.syncPointTree_.subtree( r ); if( i ) {p( !qi( r.value ), 'If we\'re adding a query, it shouldn\'t be shadowed' )}
          else {for( var o=r.fold( ( function( e, t, n ) {if( !Rt( e )&&t&&qi( t ) ) {return[ji( t ).query]}var r=[]; return t&&( r=r.concat( Ai( t ).map( ( function( e ) {return e.query} ) ) ) ), Pe( n, ( function( e, t ) {r=r.concat( t )} ) ), r} ) ), a=0; a<o.length; ++a ) {var s=o[a]; e.listenProvider_.stopListening( to( s ), $i( e, s ) )}}return n;
        }( e, t, a ) ) ), c;
      }function Yi( e, t, n ) {var r=e.pendingWriteTree_; e=e.syncPointTree_.findOnPath( t, ( function( e, n ) {if( e=Li( n, kt( e, t ) ) ) {return e}} ) ); return ri( r, t, e, n, !0 )}function Gi( e, t ) {return function e( t, n, r, i ) {if( Rt( t.path ) ) {return function e( t, n, r, i ) {var o=n.get( bt() ); null==r&&null!=o&&( r=Li( o, bt() ) ); var a=[]; return n.children.inorderTraversal( ( function( n, o ) {var s=r?r.getImmediateChild( n ):null, u=li( i, n ); ( n=t.operationForChild( n ) )&&( a=a.concat( e( n, o, s, u ) ) )} ) ), a=o?a.concat( Oi( o, t, i, r ) ):a}( t, n, r, i )}var o=n.get( bt() ); null==r&&null!=o&&( r=Li( o, bt() ) ); var a=[], s=Ct( t.path ), u=t.operationForChild( s ), l=n.children.get( s ); return l&&u&&( n=r?r.getImmediateChild( s ):null, s=li( i, s ), a=a.concat( e( u, l, n, s ) ) ), o?a.concat( Oi( o, t, i, r ) ):a}( t, e.syncPointTree_, null, ei( e.pendingWriteTree_, bt() ) )}function Ki( e, t ) {var n=t.query, r=$i( e, n ); return{ hashFn: function() {return( t.viewCache_.serverCache.getNode()||Rn.EMPTY_NODE ).hash()}, onComplete: function( t ) {if( 'ok'===t ) {return r?function( e, t, n ) {var r=Xi( e, n ); return r?( r=( n=Zi( r ) ).path, n=n.queryId, t=kt( r, t ), eo( e, r, new Sr( Cr( n ), t ) ) ):[]}( e, n._path, r ):( i=e, o=n._path, Gi( i, new Sr( { fromUser: !1, fromServer: !0, queryId: null, tagged: !1 }, o ) ) )}var i, o=( o='Unknown Error', 'too_big'===( t=t )?o='The data requested exceeds the maximum size that can be accessed with a single request.':'permission_denied'===t?o='Client doesn\'t have permission to access the desired data.':'unavailable'===t&&( o='The service is unavailable' ), ( o=new Error( t+' at '+n._path.toString()+': '+o ) ).code=t.toUpperCase(), o ); return Vi( e, n, null, o )} }}function $i( e, t ) {return t=Ji( t ), e.queryToTagMap.get( t )}function Ji( e ) {return e._path.toString()+'$'+e._queryIdentifier}function Xi( e, t ) {return e.tagToQueryMap.get( t )}function Zi( e ) {var t=e.indexOf( '$' ); return p( -1!==t&&t<e.length-1, 'Bad queryKey.' ), { queryId: e.substr( t+1 ), path: new mt( e.substr( 0, t ) ) }}function eo( e, t, n ) {var r=e.syncPointTree_.get( t ); return p( r, 'Missing sync point for query tag that we\'re tracking' ), Oi( r, n, ei( e.pendingWriteTree_, t ), null )}function to( e ) {return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?( p( ki, 'Reference.ts has not been loaded' ), new ki( e._repo, e._path ) ):e}var no=( ro.prototype.getImmediateChild=function( e ) {return new ro( this.node_.getImmediateChild( e ) )}, ro.prototype.node=function() {return this.node_}, ro ); function ro( e ) {this.node_=e}var io=( oo.prototype.getImmediateChild=function( e ) {return e=Pt( this.path_, e ), new oo( this.syncTree_, e )}, oo.prototype.node=function() {return Yi( this.syncTree_, this.path_ )}, oo ); function oo( e, t ) {this.syncTree_=e, this.path_=t}var ao=function( e, t, n ) {return e&&'object'==typeof e?( p( '.sv'in e, 'Unexpected leaf node or priority contents' ), 'string'==typeof e['.sv']?so( e['.sv'], t, n ):'object'==typeof e['.sv']?uo( e['.sv'], t ):void p( !1, 'Unexpected server value: '+JSON.stringify( e, null, 2 ) ) ):e}, so=function( e, t, n ) {if( 'timestamp'===e ) {return n.timestamp}p( !1, 'Unexpected server value: '+e )}, uo=function( e, t, n ) {return e.hasOwnProperty( 'increment' )||p( !1, 'Unexpected server value: '+JSON.stringify( e, null, 2 ) ), 'number'!=typeof( e=e.increment )&&p( !1, 'Unexpected increment value: '+e ), t=t.node(), p( null!=t, 'Expected ChildrenNode.EMPTY_NODE for nulls' ), t.isLeafNode()?'number'!=typeof( t=t.getValue() )?e:t+e:e}, lo=function( e, t, n, r ) {return ho( t, new io( n, e ), r )}, co=function( e, t, n ) {return ho( e, new no( t ), n )}; function ho( e, t, n ) {var r=e.getPriority().val(), i=ao( r, t.getImmediateChild( '.priority' ), n ); if( e.isLeafNode() ) {var o=e; return( r=ao( o.getValue(), t, n ) )!==o.getValue()||i!==o.getPriority().val()?new _n( r, Dn( i ) ):e}var a=e=e; return i!==e.getPriority().val()&&( a=a.updatePriority( new _n( i ) ) ), e.forEachChild( gn, ( function( e, r ) {var i=ho( r, t.getImmediateChild( e ), n ); i!==r&&( a=a.updateImmediateChild( e, i ) )} ) ), a}var po=function( e, t, n ) {void 0===e&&( e='' ), void 0===t&&( t=null ), void 0===n&&( n={ children: {}, childCount: 0 } ), this.name=e, this.parent=t, this.node=n}; function fo( e, t ) {for( var n=t instanceof mt?t:new mt( t ), r=e, i=Ct( n ); null!==i; ) {var o=k( r.node.children, i )||{ children: {}, childCount: 0 }; r=new po( i, r, o ), i=Ct( n=It( n ) )}return r}function _o( e ) {return e.node.value}function yo( e, t ) {e.node.value=t, function e( t ) {var n, r, i, o; null!==t.parent&&( n=t.parent, r=t.name, o=function( e ) {return void 0===_o( e )&&!vo( e )}( i=t ), t=R( n.node.children, r ), o&&t?( delete n.node.children[r], n.node.childCount--, e( n ) ):o||t||( n.node.children[r]=i.node, n.node.childCount++, e( n ) ) )}( e )}function vo( e ) {return 0<e.node.childCount}function go( e, t ) {Pe( e.node.children, ( function( n, r ) {t( new po( n, e, r ) )} ) )}function mo( e ) {return new mt( null===e.parent?e.name:mo( e.parent )+'/'+e.name )}function wo( e ) {return'string'==typeof e&&0!==e.length&&!So.test( e )}function bo( e ) {return'string'==typeof e&&0!==e.length&&!To.test( e )}function Co( e, t, n, r ) {if( !r||void 0!==t ) {var i=F( e, 'values' ); if( !t||'object'!=typeof t||Array.isArray( t ) ) {throw new Error( i+' must be an object containing the children to replace.' )}var o=[]; Pe( t, ( function( e, t ) {if( e=new mt( e ), ko( i, t, Pt( n, e ) ), '.priority'===St( e )&&!Po( t ) ) {throw new Error( i+'contains an invalid value for \''+e.toString()+'\', which must be a valid Firebase priority (a string, finite number, server value, or null).' )}o.push( e )} ) ), function( e, t ) {for( var n=0; n<t.length; n++ ) {for( var r, i=Tt( r=t[n] ), o=0; o<i.length; o++ ) {if( ( '.priority'!==i[o]||o!==i.length-1 )&&!wo( i[o] ) ) {throw new Error( e+'contains an invalid key ('+i[o]+') in path '+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"' )}}}t.sort( xt ); var a=null; for( n=0; n<t.length; n++ ) {if( r=t[n], null!==a&&Dt( a, r ) ) {throw new Error( e+'contains a path '+a.toString()+' that is ancestor of another path '+r.toString() )}a=r}}( i, o )}}function Eo( e, t, n ) {if( !n||void 0!==t ) {if( se( t ) ) {throw new Error( F( e, 'priority' )+'is '+t.toString()+', but must be a valid Firebase priority (a string, finite number, server value, or null).' )}if( !Po( t ) ) {throw new Error( F( e, 'priority' )+'must be a valid Firebase priority (a string, finite number, server value, or null).' )}}}function Io( e, t, n, r ) {if( !( r&&void 0===n||wo( n ) ) ) {throw new Error( F( e, t )+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").' )}}var So=/[\[\].#$\/\u0000-\u001F\u007F]/, To=/[\[\].#$\u0000-\u001F\u007F]/, No=10485760, Po=function( e ) {return null===e||'string'==typeof e||'number'==typeof e&&!se( e )||e&&'object'==typeof e&&R( e, '.sv' )}, Ro=function( e, t, n, r ) {r&&void 0===t||ko( F( e, 'value' ), t, n )}, ko=function( e, t, n ) {
          var r=n instanceof mt?new At( n, e ):n; if( void 0===t ) {throw new Error( e+'contains undefined '+Ft( r ) )}if( 'function'==typeof t ) {throw new Error( e+'contains a function '+Ft( r )+' with contents = '+t.toString() )}if( se( t ) ) {throw new Error( e+'contains '+t.toString()+' '+Ft( r ) )}if( 'string'==typeof t&&t.length>No/3&&j( t )>No ) {throw new Error( e+'contains a string greater than '+No+' utf8 bytes '+Ft( r )+' (\''+t.substring( 0, 50 )+'...\')' )}if( t&&'object'==typeof t ) {
            var i=!1, o=!1; if( Pe( t, ( function( t, n ) {
              if( '.value'===t ) {i=!0}
              else if( '.priority'!==t&&'.sv'!==t&&( o=!0, !wo( t ) ) ) {throw new Error( e+' contains an invalid key ('+t+') '+Ft( r )+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"' )}var a; a=t, 0<( t=r ).parts_.length&&( t.byteLength_+=1 ), t.parts_.push( a ), t.byteLength_+=j( a ), Lt( t ), ko( e, n, r ), n=( t=r ).parts_.pop(), t.byteLength_-=j( n ), 0<t.parts_.length&&--t.byteLength_;
            } ) ), i&&o ) {throw new Error( e+' contains ".value" child '+Ft( r )+' in addition to actual children.' )}
          }
        }, xo=function( e, t, n, r ) {if( !( r&&void 0===n||bo( n ) ) ) {throw new Error( F( e, t )+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"' )}}, Oo=function( e, t, n, r ) {n=n&&n.replace( /^\/*\.info(\/|$)/, '/' ), xo( e, t, n, r )}, Do=function( e, t ) {if( '.info'===Ct( t ) ) {throw new Error( e+' failed = Can\'t modify data under /.info/' )}}, Ao=function( e, t ) {var n=t.path.toString(); if( 'string'!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!wo( t.repoInfo.namespace )&&'localhost'!==t.repoInfo.host.split( ':' )[0]||0!==n.length&&!bo( n=( n=n )&&n.replace( /^\/*\.info(\/|$)/, '/' ) ) ) {throw new Error( F( e, 'url' )+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".' )}}, Lo=function() {this.eventLists_=[], this.recursionDepth_=0}; function Fo( e, t ) {for( var n=null, r=0; r<t.length; r++ ) {var i=t[r], o=i.getPath(); null===n||Ot( o, n.path )||( e.eventLists_.push( n ), n=null ), ( n=null===n?{ events: [], path: o }:n ).events.push( i )}n&&e.eventLists_.push( n )}function Mo( e, t, n ) {Fo( e, n ), jo( e, ( function( e ) {return Ot( e, t )} ) )}function qo( e, t, n ) {Fo( e, n ), jo( e, ( function( e ) {return Dt( e, t )||Dt( t, e )} ) )}function jo( e, t ) {e.recursionDepth_++; for( var n=!0, r=0; r<e.eventLists_.length; r++ ) {var i=e.eventLists_[r]; i&&( t( i.path )?( function( e ) {for( var t=0; t<e.events.length; t++ ) {var n, r=e.events[t]; null!==r&&( e.events[t]=null, n=r.getEventRunner(), ve&&we( 'event: '+r.toString() ), Le( n ) )}}( e.eventLists_[r] ), e.eventLists_[r]=null ):n=!1 )}n&&( e.eventLists_=[] ), e.recursionDepth_--}var Wo='repo_interrupt', Uo=( Bo.prototype.toString=function() {return( this.repoInfo_.secure?'https://':'http://' )+this.repoInfo_.host}, Bo ); function Bo( e, t, n ) {this.repoInfo_=e, this.forceRestClient_=t, this.authTokenProvider_=n, this.dataUpdateCount=0, this.statsListener_=null, this.eventQueue_=new Lo, this.nextWriteId_=1, this.interceptServerDataCallback_=null, this.onDisconnect_=fr(), this.transactionQueueTree_=new po, this.persistentConnection_=null, this.key=this.repoInfo_.toURLString()}function zo( e ) {return e=e.infoData_.getNode( new mt( '.info/serverTimeOffset' ) ).val()||0, ( new Date ).getTime()+e}function Ho( e ) {return function( e ) {return( e=e||{} ).timestamp=e.timestamp||( new Date ).getTime(), e}( { timestamp: zo( e ) } )}function Vo( e, t, n, r, i ) {e.dataUpdateCount++; var o=new mt( t ); n=e.interceptServerDataCallback_?e.interceptServerDataCallback_( t, n ):n; var a, s, u, l, c=o; 0<( l=i?r?( a=O( n, ( function( e ) {return Dn( e )} ) ), function( e, t, n, r ) {var i=Xi( e, r ); return i?( i=( r=Zi( i ) ).path, r=r.queryId, t=kt( i, t ), n=Ur.fromObject( n ), eo( e, i, new Rr( Cr( r ), t, n ) ) ):[]}( e.serverSyncTree_, o, a, i ) ):( t=Dn( n ), a=e.serverSyncTree_, s=o, u=t, null==( i=Xi( a, t=i ) )?[]:( t=Zi( i ), i=t.path, t=t.queryId, s=kt( i, s ), eo( a, i, new Nr( Cr( t ), s, u ) ) ) ):r?( s=O( n, ( function( e ) {return Dn( e )} ) ), u=e.serverSyncTree_, r=o, s=s, s=Ur.fromObject( s ), Gi( u, new Rr( { fromUser: !1, fromServer: !0, queryId: null, tagged: !1 }, r, s ) ) ):( n=Dn( n ), Hi( e.serverSyncTree_, o, n ) ) ).length&&( c=ra( e, o ) ), qo( e.eventQueue_, c, l )}function Qo( e, t ) {Yo( e, 'connected', t ), !1===t&&function( e ) {Zo( e, 'onDisconnectEvents' ); var t=Ho( e ), n=fr(); yr( e.onDisconnect_, bt(), ( function( r, i ) {i=lo( r, i, e.serverSyncTree_, t ), _r( n, r, i )} ) ); var r=[]; yr( n, bt(), ( function( t, n ) {r=r.concat( Hi( e.serverSyncTree_, t, n ) ), t=sa( e, t ), ra( e, t )} ) ), e.onDisconnect_=fr(), qo( e.eventQueue_, bt(), r )}( e )}function Yo( e, t, n ) {t=new mt( '/.info/'+t ), n=Dn( n ), e.infoData_.updateSnapshot( t, n ), n=Hi( e.infoSyncTree_, t, n ), qo( e.eventQueue_, t, n )}function Go( e ) {return e.nextWriteId_++}function Ko( e, t, n, r, i ) {Zo( e, 'set', { path: t.toString(), value: n, priority: r } ); var o=Ho( e ), a=( n=Dn( n, r ), r=Yi( e.serverSyncTree_, t ), o=co( n, r, o ), Go( e ) ); o=Bi( e.serverSyncTree_, t, o, a, !0 ); Fo( e.eventQueue_, o ), e.server_.put( t.toString(), n.val( !0 ), ( function( n, r ) {var o='ok'===n; o||Ee( 'set at '+t+' failed: '+n ), o=zi( e.serverSyncTree_, a, !o ), qo( e.eventQueue_, t, o ), ea( 0, i, n, r )} ) ), n=sa( e, t ), ra( e, n ), qo( e.eventQueue_, n, [] )}function $o( e, t, n, r ) {var i=Dn( n ); e.server_.onDisconnectPut( t.toString(), i.val( !0 ), ( function( n, o ) {'ok'===n&&_r( e.onDisconnect_, t, i ), ea( 0, r, n, o )} ) )}function Jo( e, t, n ) {n='.info'===Ct( t._path )?Vi( e.infoSyncTree_, t, n ):Vi( e.serverSyncTree_, t, n ), Mo( e.eventQueue_, t._path, n )}function Xo( e ) {e.persistentConnection_&&e.persistentConnection_.interrupt( Wo )}function Zo( e ) {for( var t=[], n=1; n<arguments.length; n++ ) {t[n-1]=arguments[n]}var r=''; e.persistentConnection_&&( r=e.persistentConnection_.id+':' ), we.apply( void 0, s( [r], a( t ) ) )}function ea( e, t, n, r ) {t&&Le( ( function() {var e, i; 'ok'===n?t( null ):( i=e=( n||'error' ).toUpperCase(), r&&( i+=': '+r ), ( i=new Error( i ) ).code=e, t( i ) )} ) )}function ta( e, t, n ) {return Yi( e.serverSyncTree_, t, n )||Rn.EMPTY_NODE}function na( e, t ) {
        var n; ( t=void 0===t?e.transactionQueueTree_:t )||aa( e, t ), _o( t )?( n=oa( e, t ), p( 0<n.length, 'Sending zero length transaction queue' ), n.every( ( function( e ) {return 0===e.status} ) )&&function( e, t, n ) {
          for( var r=n.map( ( function( e ) {return e.currentWriteId} ) ), i=u=ta( e, t, r ), o=( r=u.hash(), 0 ); o<n.length; o++ ) {var a=n[o]; p( 0===a.status, 'tryToSendTransactionQueue_: items in queue should all be run.' ), a.status=1, a.retryCount++; var s=kt( t, a.path ); i=i.updateChild( s, a.currentOutputSnapshotRaw )}var u=i.val( !0 ), l=t; e.server_.put( l.toString(), u, ( function( r ) {
            Zo( e, 'transaction put response', { path: l.toString(), status: r } ); var i=[]; if( 'ok'===r ) {for( var o=[], a=0; a<n.length; a++ ) {!function( t ) {n[t].status=2, i=i.concat( zi( e.serverSyncTree_, n[t].currentWriteId ) ), n[t].onComplete&&o.push( ( function() {return n[t].onComplete( null, !0, n[t].currentOutputSnapshotResolved )} ) ), n[t].unwatcher()}( a )}for( aa( e, fo( e.transactionQueueTree_, t ) ), na( e, e.transactionQueueTree_ ), qo( e.eventQueue_, t, i ), a=0; a<o.length; a++ ) {Le( o[a] )}}
            else{
              if( 'datastale'===r ) {for( a=0; a<n.length; a++ ) {3===n[a].status?n[a].status=4:n[a].status=0}}
              else {for( Ee( 'transaction at '+l.toString()+' failed: '+r ), a=0; a<n.length; a++ ) {n[a].status=4, n[a].abortReason=r}}ra( e, t );
            }
          } ), r );
        }( e, mo( t ), n ) ):vo( t )&&go( t, ( function( t ) {na( e, t )} ) );
      }function ra( e, t ) {var n=ia( e, t ); t=mo( n ); return function( e, t, n ) {if( 0!==t.length ) {for( var r=[], i=[], o=t.filter( ( function( e ) {return 0===e.status} ) ).map( ( function( e ) {return e.currentWriteId} ) ), a=0; a<t.length; a++ ) {!function( a ) {var s, u, l, c, h=t[a], d=kt( n, h.path ), f=!1; p( null!==d, 'rerunTransactionsUnderNode_: relativePath should not be null.' ), 4===h.status?( f=!0, s=h.abortReason, i=i.concat( zi( e.serverSyncTree_, h.currentWriteId, !0 ) ) ):0===h.status&&( i=h.retryCount>=25?( f=!0, s='maxretry', i.concat( zi( e.serverSyncTree_, h.currentWriteId, !0 ) ) ):( u=ta( e, h.path, o ), h.currentInputSnapshot=u, void 0!==( c=t[a].update( u.val() ) )?( ko( 'transaction failed: Data returned ', c, h.path ), l=Dn( c ), 'object'==typeof c&&null!=c&&R( c, '.priority' )||( l=l.updatePriority( u.getPriority() ) ), d=h.currentWriteId, c=Ho( e ), c=co( l, u, c ), h.currentOutputSnapshotRaw=l, h.currentOutputSnapshotResolved=c, h.currentWriteId=Go( e ), o.splice( o.indexOf( d ), 1 ), ( i=i.concat( Bi( e.serverSyncTree_, h.path, c, h.currentWriteId, h.applyLocally ) ) ).concat( zi( e.serverSyncTree_, d, !0 ) ) ):( f=!0, s='nodata', i.concat( zi( e.serverSyncTree_, h.currentWriteId, !0 ) ) ) ) ), qo( e.eventQueue_, n, i ), i=[], f&&( t[a].status=2, f=t[a].unwatcher, setTimeout( f, Math.floor( 0 ) ), t[a].onComplete&&( 'nodata'===s?r.push( ( function() {return t[a].onComplete( null, !1, t[a].currentInputSnapshot )} ) ):r.push( ( function() {return t[a].onComplete( new Error( s ), !1, null )} ) ) ) )}( a )}for( aa( e, e.transactionQueueTree_ ), a=0; a<r.length; a++ ) {Le( r[a] )}na( e, e.transactionQueueTree_ )}}( e, oa( e, n ), t ), t}function ia( e, t ) {for( var n=e.transactionQueueTree_, r=Ct( t ); null!==r&&void 0===_o( n ); ) {n=fo( n, r ), r=Ct( t=It( t ) )}return n}function oa( e, t ) {var n=[]; return function e( t, n, r ) {var i=_o( n ); if( i ) {for( var o=0; o<i.length; o++ ) {r.push( i[o] )}}go( n, ( function( n ) {e( t, n, r )} ) )}( e, t, n ), n.sort( ( function( e, t ) {return e.order-t.order} ) ), n}function aa( e, t ) {var n=_o( t ); if( n ) {for( var r=0, i=0; i<n.length; i++ ) {2!==n[i].status&&( n[r]=n[i], r++ )}n.length=r, yo( t, 0<n.length?n:void 0 )}go( t, ( function( t ) {aa( e, t )} ) )}function sa( e, t ) {var n=mo( ia( e, t ) ); return function( e, t, n ) {for( var r=e.parent; null!==r; ) {if( t( r ) ) {return}r=r.parent}}( t=fo( e.transactionQueueTree_, t ), ( function( t ) {ua( e, t )} ) ), ua( e, t ), function e( t, n, r, i ) {r&&!i&&n( t ), go( t, ( function( t ) {e( t, n, !0, i )} ) ), r&&i&&n( t )}( t, ( function( t ) {ua( e, t )} ) ), n}function ua( e, t ) {var n=_o( t ); if( n ) {for( var r=[], i=[], o=-1, a=0; a<n.length; a++ ) {3===n[a].status||( 1===n[a].status?( p( o===a-1, 'All SENT items should be at beginning of queue.' ), n[o=a].status=3, n[a].abortReason='set' ):( p( 0===n[a].status, 'Unexpected transaction status in abort' ), n[a].unwatcher(), i=i.concat( zi( e.serverSyncTree_, n[a].currentWriteId, !0 ) ), n[a].onComplete&&r.push( n[a].onComplete.bind( null, new Error( 'set' ), !1, null ) ) ) )}for( -1===o?yo( t, void 0 ):n.length=o+1, qo( e.eventQueue_, mo( t ), i ), a=0; a<r.length; a++ ) {Le( r[a] )}}}var la=function( e, t ) {var n=ca( e ), r=n.namespace; return'firebase.com'===n.domain&&Ce( n.host+' is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead' ), r&&'undefined'!==r||'localhost'===n.domain||Ce( 'Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com' ), n.secure||'undefined'!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf( 'https:' )&&Ee( 'Insecure Firebase access from a secure page. Please use https in calls to new Firebase().' ), e='ws'===n.scheme||'wss'===n.scheme, { repoInfo: new ze( n.host, n.secure, r, t, e, '', r!==n.subdomain ), path: new mt( n.pathString ) }}, ca=function( e ) {
          var t, n, r, i='', a='', s='', u='', l='', c=!0, h='https', p=443; return'string'==typeof e&&( 0<=( r=e.indexOf( '//' ) )&&( h=e.substring( 0, r-1 ), e=e.substring( r+2 ) ), -1===( t=e.indexOf( '/' ) )&&( t=e.length ), -1===( n=e.indexOf( '?' ) )&&( n=e.length ), i=e.substring( 0, Math.min( t, n ) ), t<n&&( u=function( e ) {
            for( var t='', n=e.split( '/' ), r=0; r<n.length; r++ ) {
              if( 0<n[r].length ) {
                var i=n[r]; try{i=decodeURIComponent( i.replace( /\+/g, ' ' ) )}
                catch( e ) {}t+='/'+i;
              }
            }return t;
          }( e.substring( t, n ) ) ), n=function( e ) {
            var t, n, r={}; '?'===e.charAt( 0 )&&( e=e.substring( 1 ) ); try{for( var i=o( e.split( '&' ) ), a=i.next(); !a.done; a=i.next() ) {var s, u=a.value; 0!==u.length&&( 2===( s=u.split( '=' ) ).length?r[decodeURIComponent( s[0] )]=decodeURIComponent( s[1] ):Ee( 'Invalid query segment \''+u+'\' in query \''+e+'\'' ) )}}
            catch( e ) {t={ error: e }}
            finally{
              try{a&&!a.done&&( n=i.return )&&n.call( i )}
              finally{if( t ) {throw t.error}}
            }return r;
          }( e.substring( Math.min( e.length, n ) ) ), 0<=( r=i.indexOf( ':' ) )?( c='https'===h||'wss'===h, p=parseInt( i.substring( r+1 ), 10 ) ):r=i.length, 'localhost'===( r=i.slice( 0, r ) ).toLowerCase()?a='localhost':r.split( '.' ).length<=2?a=r:( r=i.indexOf( '.' ), s=i.substring( 0, r ).toLowerCase(), a=i.substring( r+1 ), l=s ), 'ns'in n&&( l=n.ns ) ), { host: i, port: p, domain: a, subdomain: s, secure: c, scheme: h, pathString: u, namespace: l };
        }, ha=( pa.prototype.getPath=function() {var e=this.snapshot.ref; return( 'value'===this.eventType?e:e.parent )._path}, pa.prototype.getEventType=function() {return this.eventType}, pa.prototype.getEventRunner=function() {return this.eventRegistration.getEventRunner( this )}, pa.prototype.toString=function() {return this.getPath().toString()+':'+this.eventType+':'+N( this.snapshot.exportVal() )}, pa ); function pa( e, t, n, r ) {this.eventType=e, this.eventRegistration=t, this.snapshot=n, this.prevName=r}var da=( fa.prototype.getPath=function() {return this.path}, fa.prototype.getEventType=function() {return'cancel'}, fa.prototype.getEventRunner=function() {return this.eventRegistration.getEventRunner( this )}, fa.prototype.toString=function() {return this.path.toString()+':cancel'}, fa ); function fa( e, t, n ) {this.eventRegistration=e, this.error=t, this.path=n}var _a=( ya.prototype.onValue=function( e, t ) {this.snapshotCallback.call( null, e, t )}, ya.prototype.onCancel=function( e ) {return p( this.hasCancelCallback, 'Raising a cancel event on a listener with no cancel callback' ), this.cancelCallback.call( null, e )}, Object.defineProperty( ya.prototype, 'hasCancelCallback', { get: function() {return!!this.cancelCallback}, enumerable: !1, configurable: !0 } ), ya.prototype.matches=function( e ) {return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}, ya ); function ya( e, t ) {this.snapshotCallback=e, this.cancelCallback=t}var va=( ga.prototype.cancel=function() {var e=new y; return function( e, t, n ) {e.server_.onDisconnectCancel( t.toString(), ( function( r, i ) {'ok'===r&&function e( t, n ) {if( Rt( n ) ) {return t.value=null, t.children.clear(), !0}if( null!==t.value ) {if( t.value.isLeafNode() ) {return!1}var r=t.value; return t.value=null, r.forEachChild( gn, ( function( e, n ) {_r( t, new mt( e ), n )} ) ), e( t, n )}return!( 0<t.children.size )||( r=Ct( n ), n=It( n ), t.children.has( r )&&e( t.children.get( r ), n )&&t.children.delete( r ), 0===t.children.size )}( e.onDisconnect_, t ), ea( 0, n, r, i )} ) )}( this._repo, this._path, e.wrapCallback( ( function() {} ) ) ), e.promise}, ga.prototype.remove=function() {Do( 'OnDisconnect.remove', this._path ); var e=new y; return $o( this._repo, this._path, null, e.wrapCallback( ( function() {} ) ) ), e.promise}, ga.prototype.set=function( e ) {Do( 'OnDisconnect.set', this._path ), Ro( 'OnDisconnect.set', e, this._path, !1 ); var t=new y; return $o( this._repo, this._path, e, t.wrapCallback( ( function() {} ) ) ), t.promise}, ga.prototype.setWithPriority=function( e, t ) {Do( 'OnDisconnect.setWithPriority', this._path ), Ro( 'OnDisconnect.setWithPriority', e, this._path, !1 ), Eo( 'OnDisconnect.setWithPriority', t, !1 ); var n, r, i, o, a=new y; return n=this._repo, r=this._path, e=e, t=t, i=a.wrapCallback( ( function() {} ) ), o=Dn( e, t ), n.server_.onDisconnectPut( r.toString(), o.val( !0 ), ( function( e, t ) {'ok'===e&&_r( n.onDisconnect_, r, o ), ea( 0, i, e, t )} ) ), a.promise}, ga.prototype.update=function( e ) {Do( 'OnDisconnect.update', this._path ), Co( 'OnDisconnect.update', e, this._path, !1 ); var t=new y; return function( e, t, n, r ) {if( x( n ) ) {return we( 'onDisconnect().update() called with empty data.  Don\'t do anything.' ), ea( 0, r, 'ok', void 0 )}e.server_.onDisconnectMerge( t.toString(), n, ( function( i, o ) {'ok'===i&&Pe( n, ( function( n, r ) {r=Dn( r ), _r( e.onDisconnect_, Pt( t, n ), r )} ) ), ea( 0, r, i, o )} ) )}( this._repo, this._path, e, t.wrapCallback( ( function() {} ) ) ), t.promise}, ga ); function ga( e, t ) {this._repo=e, this._path=t}var ma=( Object.defineProperty( wa.prototype, 'key', { get: function() {return Rt( this._path )?null:St( this._path )}, enumerable: !1, configurable: !0 } ), Object.defineProperty( wa.prototype, 'ref', { get: function() {return new Sa( this._repo, this._path )}, enumerable: !1, configurable: !0 } ), Object.defineProperty( wa.prototype, '_queryIdentifier', { get: function() {var e=ur( this._queryParams ); return'{}'===( e=Ne( e ) )?'default':e}, enumerable: !1, configurable: !0 } ), Object.defineProperty( wa.prototype, '_queryObject', { get: function() {return ur( this._queryParams )}, enumerable: !1, configurable: !0 } ), wa.prototype.isEqual=function( e ) {if( !( ( e=W( e ) )instanceof wa ) ) {return!1}var t=this._repo===e._repo, n=Ot( this._path, e._path ); e=this._queryIdentifier===e._queryIdentifier; return t&&n&&e}, wa.prototype.toJSON=function() {return this.toString()}, wa.prototype.toString=function() {return this._repo.toString()+function( e ) {for( var t='', n=e.pieceNum_; n<e.pieces_.length; n++ ) {''!==e.pieces_[n]&&( t+='/'+encodeURIComponent( String( e.pieces_[n] ) ) )} return t||'/'}( this._path )}, wa ); function wa( e, t, n, r ) {this._repo=e, this._path=t, this._queryParams=n, this._orderByCalled=r}function ba( e, t ) {if( !0===e._orderByCalled ) {throw new Error( t+': You can\'t combine multiple orderBy calls.' )}}function Ca( e ) {
        var t=null, n=null; if( e.hasStart()&&( t=e.getIndexStartValue() ), e.hasEnd()&&( n=e.getIndexEndValue() ), e.getIndex()===Jt ) {var r='Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().', i='Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.'; if( e.hasStart() ) {if( e.getIndexStartName()!==Ie ) {throw new Error( r )}if( 'string'!=typeof t ) {throw new Error( i )}}if( e.hasEnd() ) {if( e.getIndexEndName()!==Se ) {throw new Error( r )}if( 'string'!=typeof n ) {throw new Error( i )}}}
        else if( e.getIndex()===gn ) {if( null!=t&&!Po( t )||null!=n&&!Po( n ) ) {throw new Error( 'Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).' )}}
        else if( p( e.getIndex()instanceof Fn||e.getIndex()===zn, 'unknown index type.' ), null!=t&&'object'==typeof t||null!=n&&'object'==typeof n ) {throw new Error( 'Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.' )}
      }function Ea( e ) {if( e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit() ) {throw new Error( 'Query: Can\'t combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.' )}}var Ia, Sa=( r( Ta, Ia=ma ), Object.defineProperty( Ta.prototype, 'parent', { get: function() {var e=Nt( this._path ); return null===e?null:new Ta( this._repo, e )}, enumerable: !1, configurable: !0 } ), Object.defineProperty( Ta.prototype, 'root', { get: function() {for( var e=this; null!==e.parent; ) {e=e.parent}return e}, enumerable: !1, configurable: !0 } ), Ta ); function Ta( e, t ) {return Ia.call( this, e, t, new nr, !1 )||this}var Na=( Object.defineProperty( Pa.prototype, 'priority', { get: function() {return this._node.getPriority().val()}, enumerable: !1, configurable: !0 } ), Object.defineProperty( Pa.prototype, 'key', { get: function() {return this.ref.key}, enumerable: !1, configurable: !0 } ), Object.defineProperty( Pa.prototype, 'size', { get: function() {return this._node.numChildren()}, enumerable: !1, configurable: !0 } ), Pa.prototype.child=function( e ) {var t=new mt( e ); e=xa( this.ref, e ); return new Pa( this._node.getChild( t ), e, gn )}, Pa.prototype.exists=function() {return!this._node.isEmpty()}, Pa.prototype.exportVal=function() {return this._node.val( !0 )}, Pa.prototype.forEach=function( e ) {var t=this; return!this._node.isLeafNode()&&!!this._node.forEachChild( this._index, ( function( n, r ) {return e( new Pa( r, xa( t.ref, n ), gn ) )} ) )}, Pa.prototype.hasChild=function( e ) {return e=new mt( e ), !this._node.getChild( e ).isEmpty()}, Pa.prototype.hasChildren=function() {return!this._node.isLeafNode()&&!this._node.isEmpty()}, Pa.prototype.toJSON=function() {return this.exportVal()}, Pa.prototype.val=function() {return this._node.val()}, Pa ); function Pa( e, t, n ) {this._node=e, this.ref=t, this._index=n}function Ra( e, t ) {return( e=W( e ) )._checkNotDeleted( 'ref' ), void 0!==t?xa( e._root, t ):e._root}function ka( e, t ) {( e=W( e ) )._checkNotDeleted( 'refFromURL' ); var n=la( t, e._repo.repoInfo_.nodeAdmin ); return Ao( 'refFromURL', n ), t=n.repoInfo, e._repo.repoInfo_.isCustomHost()||t.host===e._repo.repoInfo_.host||Ce( 'refFromURL: Host name does not match the current database: (found '+t.host+' but expected '+e._repo.repoInfo_.host+')' ), Ra( e, n.path.toString() )}function xa( e, t ) {return( null===Ct( ( e=W( e ) )._path )?Oo:xo )( 'child', 'path', t, !1 ), new Sa( e._repo, Pt( e._path, t ) )}function Oa( e, t ) {e=W( e ), Do( 'set', e._path ), Ro( 'set', t, e._path, !1 ); var n=new y; return Ko( e._repo, e._path, t, null, n.wrapCallback( ( function() {} ) ) ), n.promise}function Da( e, t ) {Co( 'update', t, e._path, !1 ); var n=new y; return function( e, t, n, r ) {Zo( e, 'update', { path: t.toString(), value: n } ); var i, o, a=!0, s=Ho( e ), u={}; Pe( n, ( function( n, r ) {a=!1, u[n]=lo( Pt( t, n ), Dn( r ), e.serverSyncTree_, s )} ) ), a?( we( 'update() called with empty data.  Don\'t do anything.' ), ea( 0, r, 'ok', void 0 ) ):( i=Go( e ), o=function( e, t, n, r ) {var i, o, a; return i=e.pendingWriteTree_, o=t, a=n, p( ( r=r )>i.lastWriteId, 'Stacking an older merge on top of newer ones' ), i.allWrites.push( { path: o, children: a, writeId: r, visible: !0 } ), i.visibleWrites=Qr( i.visibleWrites, o, a ), i.lastWriteId=r, n=Ur.fromObject( n ), Gi( e, new Rr( { fromUser: !0, fromServer: !1, queryId: null, tagged: !1 }, t, n ) )}( e.serverSyncTree_, t, u, i ), Fo( e.eventQueue_, o ), e.server_.merge( t.toString(), n, ( function( n, o ) {( s='ok'===n )||Ee( 'update at '+t+' failed: '+n ); var a=zi( e.serverSyncTree_, i, !s ), s=0<a.length?ra( e, t ):t; qo( e.eventQueue_, s, a ), ea( 0, r, n, o )} ) ), Pe( n, ( function( n ) {n=sa( e, Pt( t, n ) ), ra( e, n )} ) ), qo( e.eventQueue_, t, [] ) )}( e._repo, e._path, t, n.wrapCallback( ( function() {} ) ) ), n.promise}function Aa( e ) {return e=W( e ), t=e._repo, n=e, ( null!=( r=function( e, t ) {var n=t._path, r=null; e.syncPointTree_.foreachOnPath( n, ( function( e, t ) {e=kt( e, n ), r=r||Li( t, e )} ) ); var i=e.syncPointTree_.get( n ); i?r=r||Li( i, bt() ):( i=new xi, e.syncPointTree_=e.syncPointTree_.set( n, i ) ); var o, a=( o=null!=r )?new xr( r, !0, !1 ):null; return jr( ( o=Di( i, t, ei( e.pendingWriteTree_, t._path ), o?a.getNode():Rn.EMPTY_NODE, o ) ).viewCache_ )}( t.serverSyncTree_, n ) )?Promise.resolve( r ):t.server_.get( n ).then( ( function( e ) {var r=Dn( e ); e=Hi( t.serverSyncTree_, n._path, r ); return Mo( t.eventQueue_, n._path, e ), Promise.resolve( r )} ), ( function( e ) {return Zo( t, 'get for query '+N( n )+' failed: '+e ), Promise.reject( new Error( e ) )} ) ) ).then( ( function( t ) {return new Na( t, new Sa( e._repo, e._path ), e._queryParams.getIndex() )} ) ); var t, n, r}var La=( Fa.prototype.respondsTo=function( e ) {return'value'===e}, Fa.prototype.createEvent=function( e, t ) {var n=t._queryParams.getIndex(); return new ha( 'value', this, new Na( e.snapshotNode, new Sa( t._repo, t._path ), n ) )}, Fa.prototype.getEventRunner=function( e ) {var t=this; return'cancel'===e.getEventType()?function() {return t.callbackContext.onCancel( e.error )}:function() {return t.callbackContext.onValue( e.snapshot, null )}}, Fa.prototype.createCancelEvent=function( e, t ) {return this.callbackContext.hasCancelCallback?new da( this, e, t ):null}, Fa.prototype.matches=function( e ) {return e instanceof Fa&&( !e.callbackContext||!this.callbackContext||e.callbackContext.matches( this.callbackContext ) )}, Fa.prototype.hasAnyCallback=function() {return null!==this.callbackContext}, Fa ); function Fa( e ) {this.callbackContext=e}var Ma=( qa.prototype.respondsTo=function( e ) {return e='children_removed'===( e='children_added'===e?'child_added':e )?'child_removed':e, R( this.callbacks, e )}, qa.prototype.createCancelEvent=function( e, t ) {return this.callbacks.cancel.hasCancelCallback?new da( this, e, t ):null}, qa.prototype.createEvent=function( e, t ) {p( null!=e.childName, 'Child events should have a childName.' ); var n=xa( new Sa( t._repo, t._path ), e.childName ); t=t._queryParams.getIndex(); return new ha( e.type, this, new Na( e.snapshotNode, n, t ), e.prevName )}, qa.prototype.getEventRunner=function( e ) {if( 'cancel'===e.getEventType() ) {var t=this.callbacks.cancel; return function() {return t.onCancel( e.error )}}var n=this.callbacks[e.eventType]; return function() {return n.onValue( e.snapshot, e.prevName )}}, qa.prototype.matches=function( e ) {var t=this; if( e instanceof qa ) {if( !this.callbacks||!e.callbacks ) {return!0}var n=Object.keys( e.callbacks ), r=Object.keys( this.callbacks ), i=n.length; if( i===r.length ) {return 1!==i?r.every( ( function( n ) {return e.callbacks[n].matches( t.callbacks[n] )} ) ):( n=n[0], ( r=r[0] )===n&&( !e.callbacks[n]||!this.callbacks[r]||e.callbacks[n].matches( this.callbacks[r] ) ) )}}return!1}, qa.prototype.hasAnyCallback=function() {return null!==this.callbacks}, qa ); function qa( e ) {this.callbacks=e}function ja( e, t, n, r, i ) {var o; 'object'==typeof r&&( s=void 0, i=r ), 'function'==typeof r&&( s=r ), i&&i.onlyOnce&&( ( i=function( t, n ) {o( t, n ), Jo( e._repo, e, u )} ).userCallback=( o=n ).userCallback, i.context=n.context, n=i ); var a, s=new _a( n, s||void 0 ), u='value'===t?new La( s ):new Ma( ( ( a={} )[t]=s, a ) ); return t=e._repo, s=u, s='.info'===Ct( ( a=e )._path )?Qi( t.infoSyncTree_, a, s ):Qi( t.serverSyncTree_, a, s ), Mo( t.eventQueue_, a._path, s ), function() {return Jo( e._repo, e, u )}}function Wa( e, t, n, r ) {return ja( e, 'value', t, n, r )}function Ua( e, t, n, r ) {return ja( e, 'child_added', t, n, r )}function Ba( e, t, n, r ) {return ja( e, 'child_changed', t, n, r )}function za( e, t, n, r ) {return ja( e, 'child_moved', t, n, r )}function Ha( e, t, n, r ) {return ja( e, 'child_removed', t, n, r )}function Va( e, t, n ) {var r=null, i=null, o=n?new _a( n ):null; 'value'===t?r=new La( o ):t&&( n&&( ( i={} )[t]=o ), r=new Ma( i ) ), Jo( e._repo, e, r )}var Qa, Ya=( r( Ga, Qa=pt=function() {} ), Ga.prototype._apply=function( e ) {Ro( 'endAt', this._value, e._path, !0 ); var t=or( e._queryParams, this._value, this._key ); if( Ea( t ), Ca( t ), e._queryParams.hasEnd() ) {throw new Error( 'endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).' )}return new ma( e._repo, e._path, t, e._orderByCalled )}, Ga ); function Ga( e, t ) {var n=Qa.call( this )||this; return n._value=e, n._key=t, n}var Ka, $a=( r( Ja, Ka=pt ), Ja.prototype._apply=function( e ) {var t, n, r; if( Ro( 'endBefore', this._value, e._path, !1 ), Ea( r=( t=e._queryParams, n=this._value, r=this._key, ( r=t.index_===Jt?or( t, n='string'==typeof n?Wn( n ):n, r ):or( t, n, null==r?Ie:Wn( r ) ) ).endBeforeSet_=!0, r ) ), Ca( r ), e._queryParams.hasEnd() ) {throw new Error( 'endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).' )}return new ma( e._repo, e._path, r, e._orderByCalled )}, Ja ); function Ja( e, t ) {var n=Ka.call( this )||this; return n._value=e, n._key=t, n}var Xa, Za=( r( es, Xa=pt ), es.prototype._apply=function( e ) {Ro( 'startAt', this._value, e._path, !0 ); var t=ir( e._queryParams, this._value, this._key ); if( Ea( t ), Ca( t ), e._queryParams.hasStart() ) {throw new Error( 'startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).' )}return new ma( e._repo, e._path, t, e._orderByCalled )}, es ); function es( e, t ) {var n=Xa.call( this )||this; return n._value=e, n._key=t, n}var ts, ns=( r( rs, ts=pt ), rs.prototype._apply=function( e ) {var t, n, r; if( Ro( 'startAfter', this._value, e._path, !1 ), Ea( r=( t=e._queryParams, n=this._value, r=this._key, ( r=t.index_===Jt?ir( t, n='string'==typeof n?jn( n ):n, r ):ir( t, n, null==r?Se:jn( r ) ) ).startAfterSet_=!0, r ) ), Ca( r ), e._queryParams.hasStart() ) {throw new Error( 'startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).' )}return new ma( e._repo, e._path, r, e._orderByCalled )}, rs ); function rs( e, t ) {var n=ts.call( this )||this; return n._value=e, n._key=t, n}var is, os=( r( as, is=pt ), as.prototype._apply=function( e ) {if( e._queryParams.hasLimit() ) {throw new Error( 'limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).' )}return new ma( e._repo, e._path, ( t=e._queryParams, n=this._limit, ( t=t.copy() ).limitSet_=!0, t.limit_=n, t.viewFrom_='l', t ), e._orderByCalled ); var t, n}, as ); function as( e ) {var t=is.call( this )||this; return t._limit=e, t}var ss, us=( r( ls, ss=pt ), ls.prototype._apply=function( e ) {if( e._queryParams.hasLimit() ) {throw new Error( 'limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).' )}return new ma( e._repo, e._path, ( t=e._queryParams, n=this._limit, ( t=t.copy() ).limitSet_=!0, t.limit_=n, t.viewFrom_='r', t ), e._orderByCalled ); var t, n}, ls ); function ls( e ) {var t=ss.call( this )||this; return t._limit=e, t}var cs, hs=( r( ps, cs=pt ), ps.prototype._apply=function( e ) {ba( e, 'orderByChild' ); var t=new mt( this._path ); if( Rt( t ) ) {throw new Error( 'orderByChild: cannot pass in empty path. Use orderByValue() instead.' )}return t=new Fn( t ), Ca( t=ar( e._queryParams, t ) ), new ma( e._repo, e._path, t, !0 )}, ps ); function ps( e ) {var t=cs.call( this )||this; return t._path=e, t}var ds, fs=( r( _s, ds=pt ), _s.prototype._apply=function( e ) {ba( e, 'orderByKey' ); var t=ar( e._queryParams, Jt ); return Ca( t ), new ma( e._repo, e._path, t, !0 )}, _s ); function _s() {return null!==ds&&ds.apply( this, arguments )||this}var ys, vs=( r( gs, ys=pt ), gs.prototype._apply=function( e ) {ba( e, 'orderByPriority' ); var t=ar( e._queryParams, gn ); return Ca( t ), new ma( e._repo, e._path, t, !0 )}, gs ); function gs() {return null!==ys&&ys.apply( this, arguments )||this}var ms, ws=( r( bs, ms=pt ), bs.prototype._apply=function( e ) {ba( e, 'orderByValue' ); var t=ar( e._queryParams, zn ); return Ca( t ), new ma( e._repo, e._path, t, !0 )}, bs ); function bs() {return null!==ms&&ms.apply( this, arguments )||this}var Cs, Es, Is, Ss=( r( Ts, Cs=pt ), Ts.prototype._apply=function( e ) {if( Ro( 'equalTo', this._value, e._path, !1 ), e._queryParams.hasStart() ) {throw new Error( 'equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).' )}if( e._queryParams.hasEnd() ) {throw new Error( 'equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).' )}return new Ya( this._value, this._key )._apply( new Za( this._value, this._key )._apply( e ) )}, Ts ); function Ts( e, t ) {var n=Cs.call( this )||this; return n._value=e, n._key=t, n}function Ns( e ) {
        for( var t, n, r=[], i=1; i<arguments.length; i++ ) {r[i-1]=arguments[i]}var a=W( e ); try{for( var s=o( r ), u=s.next(); !u.done; u=s.next() ) {a=u.value._apply( a )}}
        catch( e ) {t={ error: e }}
        finally{
          try{u&&!u.done&&( n=s.return )&&n.call( s )}
          finally{if( t ) {throw t.error}}
        }return a;
      }Es=Sa, p( !Ei, '__referenceConstructor has already been defined' ), Ei=Es, Is=Sa, p( !ki, '__referenceConstructor has already been defined' ), ki=Is; var Ps={}, Rs=!1; function ks( e, t, n, r ) {var i=n||e.options.databaseURL; void 0===i&&( e.options.projectId||Ce( 'Can\'t determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp().' ), we( 'Using default host for project ', e.options.projectId ), i=e.options.projectId+'-default-rtdb.firebaseio.com' ); var o, a=la( i, r ), s=a.repoInfo; n=void 0; return( n='undefined'!=typeof process?process.env.FIREBASE_DATABASE_EMULATOR_HOST:n )?( o=!0, i='http://'+n+'?ns='+s.namespace, s=( a=la( i, r ) ).repoInfo ):o=!a.repoInfo.secure, t=r&&o?new qe:new Fe( e.name, e.options, t ), Ao( 'Invalid Firebase Database URL', a ), Rt( a.path )||Ce( 'Database URL must point to the root of a Firebase Database (not including a child path).' ), t=function( e, t, n ) {var r=Ps[t.name]; return r||( r={}, Ps[t.name]=r ), ( t=r[e.toURLString()] )&&Ce( 'Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.' ), t=new Uo( e, Rs, n ), r[e.toURLString()]=t}( s, e, t ), new xs( t, e )}var xs=( Object.defineProperty( Os.prototype, '_repo', { get: function() {
        return this._instanceStarted||( function( e, t, n ) {
          if( e.stats_=$e( e.repoInfo_ ), e.forceRestClient_||0<=( 'object'==typeof window&&window.navigator&&window.navigator.userAgent||'' ).search( /googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i ) ) {e.server_=new cr( e.repoInfo_, ( function( t, n, r, i ) {Vo( e, t, n, r, i )} ), e.authTokenProvider_ ), setTimeout( ( function() {return Qo( e, !0 )} ), 0 )}
          else{
            if( null!=n ) {
              if( 'object'!=typeof n ) {throw new Error( 'Only objects are supported for option databaseAuthVariableOverride' )}try{N( n )}
              catch( t ) {throw new Error( 'Invalid authOverride provided: '+t )}
            }e.persistentConnection_=new Bt( e.repoInfo_, t, ( function( t, n, r, i ) {Vo( e, t, n, r, i )} ), ( function( t ) {Qo( e, t )} ), ( function( t ) {var n; n=e, Pe( t, ( function( e, t ) {Yo( n, e, t )} ) )} ), e.authTokenProvider_, n ), e.server_=e.persistentConnection_;
          }var r; e.authTokenProvider_.addTokenChangeListener( ( function( t ) {e.server_.refreshAuthToken( t )} ) ), e.statsReporter_=( t=function() {return new wr( e.stats_, e.server_ )}, r=( r=e.repoInfo_ ).toString(), Ke[r]||( Ke[r]=t() ), Ke[r] ), e.infoData_=new pr, e.infoSyncTree_=new Ui( { startListening: function( t, n, r, i ) {var o=[], a=e.infoData_.getNode( t._path ); return a.isEmpty()||( o=Hi( e.infoSyncTree_, t._path, a ), setTimeout( ( function() {i( 'ok' )} ), 0 ) ), o}, stopListening: function() {} } ), Yo( e, 'connected', !1 ), e.serverSyncTree_=new Ui( { startListening: function( t, n, r, i ) {return e.server_.listen( t, r, n, ( function( n, r ) {r=i( n, r ), qo( e.eventQueue_, t._path, r )} ) ), []}, stopListening: function( t, n ) {e.server_.unlisten( t, n )} } );
        }( this._repoInternal, this.app.options.appId, this.app.options.databaseAuthVariableOverride ), this._instanceStarted=!0 ), this._repoInternal;
      }, enumerable: !1, configurable: !0 } ), Object.defineProperty( Os.prototype, '_root', { get: function() {return this._rootInternal||( this._rootInternal=new Sa( this._repo, bt() ) ), this._rootInternal}, enumerable: !1, configurable: !0 } ), Os.prototype._delete=function() {var e, t, n; return this._checkNotDeleted( 'delete' ), e=this._repo, t=this.app.name, ( n=Ps[t] )&&n[e.key]===e||Ce( 'Database '+t+'('+e.repoInfo_+') has already been deleted.' ), Xo( e ), delete n[e.key], this._repoInternal=null, this._rootInternal=null, Promise.resolve()}, Os.prototype._checkNotDeleted=function( e ) {null===this._rootInternal&&Ce( 'Cannot call '+e+' on a deleted database.' )}, Os ); function Os( e, t ) {this._repoInternal=e, this.app=t, this.type='database', this._instanceStarted=!1}function Ds( e ) {( e=W( e ) )._checkNotDeleted( 'goOnline' ), ( e=e._repo ).persistentConnection_&&e.persistentConnection_.resume( Wo )}var As=( Ls.prototype.toJSON=function() {return{ committed: this.committed, snapshot: this.snapshot.toJSON() }}, Ls ); function Ls( e, t ) {this.committed=e, this.snapshot=t}function Fs( e, t, n ) {if( e=W( e ), Do( 'Reference.transaction', e._path ), '.length'===e.key||'.keys'===e.key ) {throw'Reference.transaction failed: '+e.key+' is a read-only object.'}n=null===( i=null==n?void 0:n.applyLocally )||void 0===i||i; var r=new y, i=Wa( e, ( function() {} ) ); return function( e, t, n, r, i, o ) {Zo( e, 'transaction on '+t ); var a={ path: t, update: n, onComplete: r, status: null, order: _e(), applyLocally: o, retryCount: 0, unwatcher: i, abortReason: null, currentWriteId: null, currentInputSnapshot: null, currentOutputSnapshotRaw: null, currentOutputSnapshotResolved: null }; n=ta( e, t, void 0 ); a.currentInputSnapshot=n, void 0===( r=a.update( n.val() ) )?( a.unwatcher(), a.currentOutputSnapshotRaw=null, a.currentOutputSnapshotResolved=null, a.onComplete&&a.onComplete( null, !1, a.currentInputSnapshot ) ):( ko( 'transaction failed: Data returned ', r, a.path ), a.status=0, ( i=_o( o=fo( e.transactionQueueTree_, t ) )||[] ).push( a ), yo( o, i ), o=void 0, 'object'==typeof r&&null!==r&&R( r, '.priority' )?( o=k( r, '.priority' ), p( Po( o ), 'Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.' ) ):o=( Yi( e.serverSyncTree_, t )||Rn.EMPTY_NODE ).getPriority().val(), i=Ho( e ), o=Dn( r, o ), i=co( o, n, i ), a.currentOutputSnapshotRaw=o, a.currentOutputSnapshotResolved=i, a.currentWriteId=Go( e ), a=Bi( e.serverSyncTree_, t, i, a.currentWriteId, a.applyLocally ), qo( e.eventQueue_, t, a ), na( e, e.transactionQueueTree_ ) )}( e._repo, e._path, t, ( function( t, n, i ) {var o; t?r.reject( t ):( o=new Na( i, new Sa( e._repo, e._path ), gn ), r.resolve( new As( n, o ) ) )} ), i, n ), r.promise}var Ms=( qs.prototype.cancel=function( e ) {L( 'OnDisconnect.cancel', 0, 1, arguments.length ), M( 'OnDisconnect.cancel', 'onComplete', e, !0 ); var t=this._delegate.cancel(); return e&&t.then( ( function() {return e( null )} ), ( function( t ) {return e( t )} ) ), t}, qs.prototype.remove=function( e ) {L( 'OnDisconnect.remove', 0, 1, arguments.length ), M( 'OnDisconnect.remove', 'onComplete', e, !0 ); var t=this._delegate.remove(); return e&&t.then( ( function() {return e( null )} ), ( function( t ) {return e( t )} ) ), t}, qs.prototype.set=function( e, t ) {return L( 'OnDisconnect.set', 1, 2, arguments.length ), M( 'OnDisconnect.set', 'onComplete', t, !0 ), e=this._delegate.set( e ), t&&e.then( ( function() {return t( null )} ), ( function( e ) {return t( e )} ) ), e}, qs.prototype.setWithPriority=function( e, t, n ) {return L( 'OnDisconnect.setWithPriority', 2, 3, arguments.length ), M( 'OnDisconnect.setWithPriority', 'onComplete', n, !0 ), t=this._delegate.setWithPriority( e, t ), n&&t.then( ( function() {return n( null )} ), ( function( e ) {return n( e )} ) ), t}, qs.prototype.update=function( e, t ) {if( L( 'OnDisconnect.update', 1, 2, arguments.length ), Array.isArray( e ) ) {for( var n={}, r=0; r<e.length; ++r ) {n[''+r]=e[r]}e=n, Ee( 'Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.' )}M( 'OnDisconnect.update', 'onComplete', t, !0 ); var i=this._delegate.update( e ); return t&&i.then( ( function() {return t( null )} ), ( function( e ) {return t( e )} ) ), i}, qs ); function qs( e ) {this._delegate=e}var js=( Ws.prototype.toJSON=function() {return L( 'TransactionResult.toJSON', 0, 1, arguments.length ), { committed: this.committed, snapshot: this.snapshot.toJSON() }}, Ws ); function Ws( e, t ) {this.committed=e, this.snapshot=t}var Us=( Bs.prototype.val=function() {return L( 'DataSnapshot.val', 0, 0, arguments.length ), this._delegate.val()}, Bs.prototype.exportVal=function() {return L( 'DataSnapshot.exportVal', 0, 0, arguments.length ), this._delegate.exportVal()}, Bs.prototype.toJSON=function() {return L( 'DataSnapshot.toJSON', 0, 1, arguments.length ), this._delegate.toJSON()}, Bs.prototype.exists=function() {return L( 'DataSnapshot.exists', 0, 0, arguments.length ), this._delegate.exists()}, Bs.prototype.child=function( e ) {return L( 'DataSnapshot.child', 0, 1, arguments.length ), e=String( e ), xo( 'DataSnapshot.child', 'path', e, !1 ), new Bs( this._database, this._delegate.child( e ) )}, Bs.prototype.hasChild=function( e ) {return L( 'DataSnapshot.hasChild', 1, 1, arguments.length ), xo( 'DataSnapshot.hasChild', 'path', e, !1 ), this._delegate.hasChild( e )}, Bs.prototype.getPriority=function() {return L( 'DataSnapshot.getPriority', 0, 0, arguments.length ), this._delegate.priority}, Bs.prototype.forEach=function( e ) {var t=this; return L( 'DataSnapshot.forEach', 1, 1, arguments.length ), M( 'DataSnapshot.forEach', 'action', e, !1 ), this._delegate.forEach( ( function( n ) {return e( new Bs( t._database, n ) )} ) )}, Bs.prototype.hasChildren=function() {return L( 'DataSnapshot.hasChildren', 0, 0, arguments.length ), this._delegate.hasChildren()}, Object.defineProperty( Bs.prototype, 'key', { get: function() {return this._delegate.key}, enumerable: !1, configurable: !0 } ), Bs.prototype.numChildren=function() {return L( 'DataSnapshot.numChildren', 0, 0, arguments.length ), this._delegate.size}, Bs.prototype.getRef=function() {return L( 'DataSnapshot.ref', 0, 0, arguments.length ), new Qs( this._database, this._delegate.ref )}, Object.defineProperty( Bs.prototype, 'ref', { get: function() {return this.getRef()}, enumerable: !1, configurable: !0 } ), Bs ); function Bs( e, t ) {this._database=e, this._delegate=t}var zs=( Hs.prototype.on=function( e, t, n, r ) {var i=this; function o( e, n ) {t.call( a.context, new Us( i.database, e ), n )}L( 'Query.on', 2, 4, arguments.length ), M( 'Query.on', 'callback', t, !1 ); var a=Hs.getCancelAndContextArgs_( 'Query.on', n, r ); o.userCallback=t, o.context=a.context; var s=null===( r=a.cancel )||void 0===r?void 0:r.bind( a.context ); switch( e ) {case'value':return Wa( this._delegate, o, s ), t; case'child_added':return Ua( this._delegate, o, s ), t; case'child_removed':return Ha( this._delegate, o, s ), t; case'child_changed':return Ba( this._delegate, o, s ), t; case'child_moved':return za( this._delegate, o, s ), t; default:throw new Error( F( 'Query.on', 'eventType' )+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".' );}}, Hs.prototype.off=function( e, t, n ) {var r; L( 'Query.off', 0, 3, arguments.length ), function( e, t, n ) {if( void 0!==t ) {switch( t ) {case'value':case'child_added':case'child_removed':case'child_changed':case'child_moved':break; default:throw new Error( F( 'Query.off', 'eventType' )+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".' );}}}( 0, e ), M( 'Query.off', 'callback', t, !0 ), q( 'Query.off', 'context', n, !0 ), t?( ( r=function() {} ).userCallback=t, r.context=n, Va( this._delegate, e, r ) ):Va( this._delegate, e )}, Hs.prototype.get=function() {var e=this; return Aa( this._delegate ).then( ( function( t ) {return new Us( e.database, t )} ) )}, Hs.prototype.once=function( e, t, n, r ) {var i=this; function o( e, n ) {e=new Us( i.database, e ), t&&t.call( a.context, e, n ), s.resolve( e )}L( 'Query.once', 1, 4, arguments.length ), M( 'Query.once', 'callback', t, !0 ); var a=Hs.getCancelAndContextArgs_( 'Query.on', n, r ), s=new y; function u( e ) {a.cancel&&a.cancel.call( a.context, e ), s.reject( e )}switch( o.userCallback=t, o.context=a.context, e ) {case'value':Wa( this._delegate, o, u, { onlyOnce: !0 } ); break; case'child_added':Ua( this._delegate, o, u, { onlyOnce: !0 } ); break; case'child_removed':Ha( this._delegate, o, u, { onlyOnce: !0 } ); break; case'child_changed':Ba( this._delegate, o, u, { onlyOnce: !0 } ); break; case'child_moved':za( this._delegate, o, u, { onlyOnce: !0 } ); break; default:throw new Error( F( 'Query.once', 'eventType' )+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".' );}return s.promise}, Hs.prototype.limitToFirst=function( e ) {return L( 'Query.limitToFirst', 1, 1, arguments.length ), new Hs( this.database, Ns( this._delegate, function( e ) {if( 'number'!=typeof e||Math.floor( e )!==e||e<=0 ) {throw new Error( 'limitToFirst: First argument must be a positive integer.' )}return new os( e )}( e ) ) )}, Hs.prototype.limitToLast=function( e ) {return L( 'Query.limitToLast', 1, 1, arguments.length ), new Hs( this.database, Ns( this._delegate, function( e ) {if( 'number'!=typeof e||Math.floor( e )!==e||e<=0 ) {throw new Error( 'limitToLast: First argument must be a positive integer.' )}return new us( e )}( e ) ) )}, Hs.prototype.orderByChild=function( e ) {return L( 'Query.orderByChild', 1, 1, arguments.length ), new Hs( this.database, Ns( this._delegate, function( e ) {if( '$key'===e ) {throw new Error( 'orderByChild: "$key" is invalid.  Use orderByKey() instead.' )}if( '$priority'===e ) {throw new Error( 'orderByChild: "$priority" is invalid.  Use orderByPriority() instead.' )}if( '$value'===e ) {throw new Error( 'orderByChild: "$value" is invalid.  Use orderByValue() instead.' )}return xo( 'orderByChild', 'path', e, !1 ), new hs( e )}( e ) ) )}, Hs.prototype.orderByKey=function() {return L( 'Query.orderByKey', 0, 0, arguments.length ), new Hs( this.database, Ns( this._delegate, new fs ) )}, Hs.prototype.orderByPriority=function() {return L( 'Query.orderByPriority', 0, 0, arguments.length ), new Hs( this.database, Ns( this._delegate, new vs ) )}, Hs.prototype.orderByValue=function() {return L( 'Query.orderByValue', 0, 0, arguments.length ), new Hs( this.database, Ns( this._delegate, new ws ) )}, Hs.prototype.startAt=function( e, t ) {return void 0===e&&( e=null ), L( 'Query.startAt', 0, 2, arguments.length ), new Hs( this.database, Ns( this._delegate, ( void 0===( e=e )&&( e=null ), Io( 'startAt', 'key', t=t, !0 ), new Za( e, t ) ) ) )}, Hs.prototype.startAfter=function( e, t ) {return void 0===e&&( e=null ), L( 'Query.startAfter', 0, 2, arguments.length ), new Hs( this.database, Ns( this._delegate, ( e=e, Io( 'startAfter', 'key', t=t, !0 ), new ns( e, t ) ) ) )}, Hs.prototype.endAt=function( e, t ) {return void 0===e&&( e=null ), L( 'Query.endAt', 0, 2, arguments.length ), new Hs( this.database, Ns( this._delegate, ( e=e, Io( 'endAt', 'key', t=t, !0 ), new Ya( e, t ) ) ) )}, Hs.prototype.endBefore=function( e, t ) {return void 0===e&&( e=null ), L( 'Query.endBefore', 0, 2, arguments.length ), new Hs( this.database, Ns( this._delegate, ( e=e, Io( 'endBefore', 'key', t=t, !0 ), new $a( e, t ) ) ) )}, Hs.prototype.equalTo=function( e, t ) {return L( 'Query.equalTo', 1, 2, arguments.length ), new Hs( this.database, Ns( this._delegate, ( e=e, Io( 'equalTo', 'key', t=t, !0 ), new Ss( e, t ) ) ) )}, Hs.prototype.toString=function() {return L( 'Query.toString', 0, 0, arguments.length ), this._delegate.toString()}, Hs.prototype.toJSON=function() {return L( 'Query.toJSON', 0, 1, arguments.length ), this._delegate.toJSON()}, Hs.prototype.isEqual=function( e ) {if( L( 'Query.isEqual', 1, 1, arguments.length ), e instanceof Hs ) {return this._delegate.isEqual( e._delegate )}throw new Error( 'Query.isEqual failed: First argument must be an instance of firebase.database.Query.' )}, Hs.getCancelAndContextArgs_=function( e, t, n ) {
        var r={ cancel: void 0, context: void 0 }; if( t&&n ) {r.cancel=t, M( e, 'cancel', r.cancel, !0 ), r.context=n, q( e, 'context', r.context, !0 )}
        else if( t ) {
          if( 'object'==typeof t&&null!==t ) {r.context=t}
          else{if( 'function'!=typeof t ) {throw new Error( F( e, 'cancelOrContext' )+' must either be a cancel callback or a context object.' )}r.cancel=t}
        }return r;
      }, Object.defineProperty( Hs.prototype, 'ref', { get: function() {return new Qs( this.database, new Sa( this._delegate._repo, this._delegate._path ) )}, enumerable: !1, configurable: !0 } ), Hs ); function Hs( e, t ) {this.database=e, this._delegate=t}var Vs, Qs=( r( Ys, Vs=zs ), Ys.prototype.getKey=function() {return L( 'Reference.key', 0, 0, arguments.length ), this._delegate.key}, Ys.prototype.child=function( e ) {return L( 'Reference.child', 1, 1, arguments.length ), 'number'==typeof e&&( e=String( e ) ), new Ys( this.database, xa( this._delegate, e ) )}, Ys.prototype.getParent=function() {L( 'Reference.parent', 0, 0, arguments.length ); var e=this._delegate.parent; return e?new Ys( this.database, e ):null}, Ys.prototype.getRoot=function() {return L( 'Reference.root', 0, 0, arguments.length ), new Ys( this.database, this._delegate.root )}, Ys.prototype.set=function( e, t ) {return L( 'Reference.set', 1, 2, arguments.length ), M( 'Reference.set', 'onComplete', t, !0 ), e=Oa( this._delegate, e ), t&&e.then( ( function() {return t( null )} ), ( function( e ) {return t( e )} ) ), e}, Ys.prototype.update=function( e, t ) {if( L( 'Reference.update', 1, 2, arguments.length ), Array.isArray( e ) ) {for( var n={}, r=0; r<e.length; ++r ) {n[''+r]=e[r]}e=n, Ee( 'Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.' )}Do( 'Reference.update', this._delegate._path ), M( 'Reference.update', 'onComplete', t, !0 ); var i=Da( this._delegate, e ); return t&&i.then( ( function() {return t( null )} ), ( function( e ) {return t( e )} ) ), i}, Ys.prototype.setWithPriority=function( e, t, n ) {return L( 'Reference.setWithPriority', 2, 3, arguments.length ), M( 'Reference.setWithPriority', 'onComplete', n, !0 ), t=function( e, t, n ) {if( Do( 'setWithPriority', e._path ), Ro( 'setWithPriority', t, e._path, !1 ), Eo( 'setWithPriority', n, !1 ), '.length'===e.key||'.keys'===e.key ) {throw'setWithPriority failed: '+e.key+' is a read-only object.'}var r=new y; return Ko( e._repo, e._path, t, n, r.wrapCallback( ( function() {} ) ) ), r.promise}( this._delegate, e, t ), n&&t.then( ( function() {return n( null )} ), ( function( e ) {return n( e )} ) ), t}, Ys.prototype.remove=function( e ) {L( 'Reference.remove', 0, 1, arguments.length ), M( 'Reference.remove', 'onComplete', e, !0 ); var t=( t=this._delegate, Do( 'remove', t._path ), Oa( t, null ) ); return e&&t.then( ( function() {return e( null )} ), ( function( t ) {return e( t )} ) ), t}, Ys.prototype.transaction=function( e, t, n ) {var r=this; return L( 'Reference.transaction', 1, 3, arguments.length ), M( 'Reference.transaction', 'transactionUpdate', e, !1 ), M( 'Reference.transaction', 'onComplete', t, !0 ), function( e, t, n, r ) {if( void 0!==n&&'boolean'!=typeof n ) {throw new Error( F( 'Reference.transaction', 'applyLocally' )+'must be a boolean.' )}}( 0, 0, n ), n=Fs( this._delegate, e, { applyLocally: n } ).then( ( function( e ) {return new js( e.committed, new Us( r.database, e.snapshot ) )} ) ), t&&n.then( ( function( e ) {return t( null, e.committed, e.snapshot )} ), ( function( e ) {return t( e, !1, null )} ) ), n}, Ys.prototype.setPriority=function( e, t ) {return L( 'Reference.setPriority', 1, 2, arguments.length ), M( 'Reference.setPriority', 'onComplete', t, !0 ), e=function( e, t ) {e=W( e ), Do( 'setPriority', e._path ), Eo( 'setPriority', t, !1 ); var n=new y; return Ko( e._repo, Pt( e._path, '.priority' ), t, null, n.wrapCallback( ( function() {} ) ) ), n.promise}( this._delegate, e ), t&&e.then( ( function() {return t( null )} ), ( function( e ) {return t( e )} ) ), e}, Ys.prototype.push=function( e, t ) {var n=this; L( 'Reference.push', 0, 2, arguments.length ), M( 'Reference.push', 'onComplete', t, !0 ); var r=function( e, t ) {e=W( e ), Do( 'push', e._path ), Ro( 'push', t, e._path, !0 ); var n=zo( e._repo ), r=Vn( n ), i=( n=xa( e, r ), xa( e, r ) ); t=null!=t?Oa( i, t ).then( ( function() {return i} ) ):Promise.resolve( i ); return n.then=t.then.bind( t ), n.catch=t.then.bind( t, void 0 ), n}( this._delegate, e ); e=r.then( ( function( e ) {return new Ys( n.database, e )} ) ); return t&&e.then( ( function() {return t( null )} ), ( function( e ) {return t( e )} ) ), ( r=new Ys( this.database, r ) ).then=e.then.bind( e ), r.catch=e.catch.bind( e, void 0 ), r}, Ys.prototype.onDisconnect=function() {return Do( 'Reference.onDisconnect', this._delegate._path ), new Ms( new va( this._delegate._repo, this._delegate._path ) )}, Object.defineProperty( Ys.prototype, 'key', { get: function() {return this.getKey()}, enumerable: !1, configurable: !0 } ), Object.defineProperty( Ys.prototype, 'parent', { get: function() {return this.getParent()}, enumerable: !1, configurable: !0 } ), Object.defineProperty( Ys.prototype, 'root', { get: function() {return this.getRoot()}, enumerable: !1, configurable: !0 } ), Ys ); function Ys( e, t ) {var n=Vs.call( this, e, new ma( t._repo, t._path, new nr, !1 ) )||this; return n.database=e, n._delegate=t, n}var Gs=( Ks.prototype.useEmulator=function( e, t ) {!function( e, t, n ) {( e=W( e ) )._checkNotDeleted( 'useEmulator' ), e._instanceStarted&&Ce( 'Cannot call useEmulator() after instance has already been initialized.' ), t=t, n=n, ( e=e._repo ).repoInfo_=new ze( t+':'+n, !1, e.repoInfo_.namespace, e.repoInfo_.webSocketOnly, e.repoInfo_.nodeAdmin, e.repoInfo_.persistenceKey, e.repoInfo_.includeNamespaceInQueryParams ), e.repoInfo_.nodeAdmin&&( e.authTokenProvider_=new qe )}( this._delegate, e, t )}, Ks.prototype.ref=function( e ) {if( L( 'database.ref', 0, 1, arguments.length ), e instanceof Qs ) {var t=ka( this._delegate, e.toString() ); return new Qs( this, t )}return t=Ra( this._delegate, e ), new Qs( this, t )}, Ks.prototype.refFromURL=function( e ) {return L( 'database.refFromURL', 1, 1, arguments.length ), e=ka( this._delegate, e ), new Qs( this, e )}, Ks.prototype.goOffline=function() {var e; L( 'database.goOffline', 0, 0, arguments.length ), ( e=W( e=this._delegate ) )._checkNotDeleted( 'goOffline' ), Xo( e._repo )}, Ks.prototype.goOnline=function() {return L( 'database.goOnline', 0, 0, arguments.length ), Ds( this._delegate )}, Ks.ServerValue={ TIMESTAMP: { '.sv': 'timestamp' }, increment: function( e ) {return{ '.sv': { increment: e } }} }, Ks ); function Ks( e, t ) {var n=this; this._delegate=e, this.app=t, this.INTERNAL={ delete: function() {return n._delegate._delete()} }}var $s=Object.freeze( { __proto__: null, forceLongPolling: function() {at.forceDisallow(), Ze.forceAllow()}, forceWebSockets: function() {Ze.forceDisallow()}, isWebSocketsAvailable: function() {return at.isAvailable()}, setSecurityDebugCallback: function( e, t ) {e._delegate._repo.persistentConnection_.securityDebugCallback_=t}, stats: function( e, t ) {var n; e=e._delegate._repo, void 0===( t=t )&&( t=!1 ), 'undefined'!=typeof console&&( e=t?( e.statsListener_||( e.statsListener_=new vr( e.stats_ ) ), e.statsListener_.get() ):e.stats_.get(), n=Object.keys( e ).reduce( ( function( e, t ) {return Math.max( t.length, e )} ), 0 ), Pe( e, ( function( e, t ) {for( var r=e, i=e.length; i<n+2; i++ ) {r+=' '}console.log( r+t )} ) ) )}, statsIncrementCounter: function( e, t ) {t=t, ( e=e._delegate._repo ).stats_.incrementCounter( t ), t=t, ( e=e.statsReporter_ ).statsToReport_[t]=!0}, dataUpdateCount: function( e ) {return e._delegate._repo.dataUpdateCount}, interceptServerData: function( e, t ) {t=t, ( e=e._delegate._repo ).interceptServerDataCallback_=t}, initStandalone: function( e ) {var t=e.app, n=e.url, r=e.version, i=e.customAuthImpl, o=e.namespace; e=void 0!==( e=e.nodeAdmin )&&e; return it( r ), ( r=new H( 'auth-internal', new Y( 'database-standalone' ) ) ).setComponent( new U( 'auth-internal', ( function() {return i} ), 'PRIVATE' ) ), { instance: new Gs( ks( t, r, n, e ), t ), namespace: o }} } ); pt=Bt; Bt.prototype.simpleListen=function( e, t ) {this.sendRequest( 'q', { p: e }, t )}, Bt.prototype.echo=function( e, t ) {this.sendRequest( 'echo', { d: e }, t )}; var Js, Xs=Object.freeze( { __proto__: null, DataConnection: pt, RealTimeConnection: ct, hijackHash: function( e ) {var t=Bt.prototype.put; return Bt.prototype.put=function( n, r, i, o ) {void 0!==o&&( o=e() ), t.call( this, n, r, i, o )}, function() {Bt.prototype.put=t}}, ConnectionTarget: ze, queryIdentifier: function( e ) {return e._delegate._queryIdentifier}, forceRestClient: function( e ) {Rs=e} } ), Zs=Gs.ServerValue; it( ( Js=t.default ).SDK_VERSION ), Js.INTERNAL.registerComponent( new U( 'database', ( function( e, t ) {var n=t.instanceIdentifier; t=e.getProvider( 'app' ).getImmediate(), e=e.getProvider( 'auth-internal' ); return new Gs( ks( t, e, n ), t )} ), 'PUBLIC' ).setServiceProps( { Reference: Qs, Query: zs, Database: Gs, DataSnapshot: Us, enableLogging: function( e, t ) {me( e, t )}, INTERNAL: $s, ServerValue: Zs, TEST_ACCESS: Xs } ).setMultipleInstances( !0 ) ), Js.registerVersion( '@firebase/database', '0.9.10' );
    } ).apply( this, arguments );
  }
  catch( e ) {throw console.error( e ), new Error( 'Cannot instantiate firebase-database.js - be sure to load firebase-app.js first.' )}
} ) ); const firebaseChatConfig={ apiKey: 'AIzaSyCw6TAuBUrlWqNVZ1470xE4pBcHuQeY_Vo', authDomain: 'vi-network-chats.firebaseapp.com', databaseURL: 'https://vi-network-chats-default-rtdb.firebaseio.com', projectId: 'vi-network-chats', storageBucket: 'vi-network-chats.appspot.com', messagingSenderId: '120778279060', appId: '1:120778279060:web:a14315107afce576398c81' }; firebase.initializeApp( firebaseChatConfig ); const NetworkMainRoom=firebase.database().ref( window.location.host.replace( /\./g, '_' ) );