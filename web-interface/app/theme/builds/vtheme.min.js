const Background=function(){"use strict";return{launch:function(){V.setNode("body",CanvasComponents.background())}}}(),Canvas=function(){"use strict";const e=V.getSetting("sourceEndpoint");function t(e,t=(e?e.path:"")){Chat.drawMessageForm("clear"),function(){if(!V.getState("serviceNav")){const e=Object.keys(V.getSetting("plugins")),t=V.getState("availablePlugins");e.map(e=>t[e]?t[e]():null),User.launch()}V.getSetting("demoContent")&&V.setEntity(DemoContent.mongoArr[4])}(),V.getNode("background")||(Background.launch(),Haze.launch(),Feature.launch(),Header.launch(),Logo.launch(),Page.launch(),Button.launch(),V.setNode("balance",AccountComponents.headerBalance(-1)),VMap.setMap()),V.aE()||V.setAuth().then(e=>{if(e.success)return console.log("auth success"),e.data[0];throw new Error("could not set auth")}).then(e=>V.getEntity({uuidE:e.uuidE,uuidP:e.uuidP,isReturningUser:!0})).then(e=>{if(!e.success)throw new Error("could not get entity after set auth");V.setActiveEntity(e.data[0]),Navigation.drawJoinedUserPill(),Join.draw("new entity was set up")}).catch(e=>{V.setTempRefreshToken(),console.log("auth unsuccessful -",e),V.getLocal("last-connected-address")&&window.ethereum?Join.draw("authenticate"):Join.launch()}),V.castRoute(t).then((e,t=e.status,n=e.data[0])=>{["home"].includes(t)?Marketplace.draw():["market","market category","pool"].includes(t)?Marketplace.draw(n):["media","media category"].includes(t)?Media.draw(n):["data"].includes(t)?Data.draw(n):["user profile"].includes(t)?User.draw(n):["user account"].includes(t)?Account.draw(n):["user entities"].includes(t)?EntityList.draw(n):["user settings"].includes(t)?Settings.draw(n):["chat everyone"].includes(t)?Chat.draw(n):["profile"].includes(t)&&Profile.draw(n)}).catch(()=>{Marketplace.draw(),Modal.draw("404")})}function n(e){e.some(e=>{V.getVisibility("#"+e)&&V.getNode("#"+e).click()})}return{launch:async function(){await async function(){V.getSetting("useBuilds")?await Promise.all([V.setStylesheet(e+"/css/builds/v.min.css")]).then(()=>console.log("Success loading css build")).catch(()=>console.error("Error loading css build")):await Promise.all([V.setStylesheet(e+"/css/src/0_0_variables.css"),V.setStylesheet(e+"/css/src/1_0_reset-normalize.css"),V.setStylesheet(e+"/css/src/1_1_reset.css"),V.setStylesheet(e+"/css/src/2_0_typography.css"),V.setStylesheet(e+"/css/src/2_2_color.css"),V.setStylesheet(e+"/css/src/3_0_utilities.css"),V.setStylesheet(e+"/css/src/4_0_components.css"),V.setStylesheet(e+"/css/src/8_0_overrides.css"),V.setStylesheet(e+"/css/src/9_0_leaflet.css")]).then(()=>console.log("Success loading CSS source files")).catch(()=>console.error("Error loading CSS source files"))}(),await async function(){V.getSetting("useBuilds")||await Promise.all([V.setScript(e+"/theme/src/canvas/components.js"),V.setScript(e+"/theme/src/canvas/background.js"),V.setScript(e+"/theme/src/canvas/haze.js"),V.setScript(e+"/theme/src/canvas/logo.js"),V.setScript(e+"/theme/src/canvas/feature.js"),V.setScript(e+"/theme/src/canvas/header.js"),V.setScript(e+"/theme/src/canvas/page.js"),V.setScript(e+"/theme/src/search/components.js"),V.setScript(e+"/theme/src/modal/components.js"),V.setScript(e+"/theme/src/modal/modal.js"),V.setScript(e+"/theme/src/interaction/components.js"),V.setScript(e+"/theme/src/interaction/button.js"),V.setScript(e+"/theme/src/interaction/form.js"),V.setScript(e+"/theme/src/interaction/join.js"),V.setScript(e+"/theme/src/navigation/components.js"),V.setScript(e+"/theme/src/navigation/navigation.js")]).then(()=>console.log("Success loading theme source files")).catch(()=>console.error("Error loading theme source files")),V.getSetting("useBuilds")?await Promise.all([V.setScript(e+"/plugins/builds/vplugins.min.js")]).then(()=>console.log("Success loading plugin build")).catch(()=>console.error("Error loading plugin build")):await Promise.all([V.setScript(e+"/plugins/src/account/components.js"),V.setScript(e+"/plugins/src/account/account.js"),V.setScript(e+"/plugins/src/entity/components.js"),V.setScript(e+"/plugins/src/entity/editable.js"),V.setScript(e+"/plugins/src/entity/display.js"),V.setScript(e+"/plugins/src/entity/settings.js"),V.setScript(e+"/plugins/src/entity/entitylist.js"),V.setScript(e+"/plugins/src/chat/components.js"),V.setScript(e+"/plugins/src/chat/chat.js"),V.setScript(e+"/plugins/dependencies/leaflet.js"),V.setScript(e+"/plugins/src/map/map.js"),V.setScript(e+"/plugins/src/google/google.js"),V.setScript(e+"/plugins/src/data/components.js"),V.setScript(e+"/plugins/src/data/data.js"),V.setScript(e+"/plugins/src/marketplace/components.js"),V.setScript(e+"/plugins/src/marketplace/definitions.js"),V.setScript(e+"/plugins/src/marketplace/marketplace.js"),V.setScript(e+"/plugins/src/media/components.js"),V.setScript(e+"/plugins/src/media/media.js")]).then(()=>console.log("Success loading plugin source files")).catch(()=>console.error("Error loading plugin source files")),V.setNode("body",""),V.getSetting("demoContent")&&await Promise.all([V.setScript(e+"/assets/demo-content/demo-content.js")]).then(()=>console.log("Success loading demo content")).catch(()=>console.error("Error loading demo content"))}(),function(){V.setState("screen",{height:Number(window.innerHeight),width:Number(window.innerWidth),brandPrimary:V.getCss("--brandPrimary"),brandSecondary:V.getCss("--brandSecondary"),buttonBkg:V.getCss("--buttonBkg")}),V.setState("active",{path:window.location.pathname}),V.setState("page",{height:V.getCss("--page-position-peek"),top:V.setPipe(V.getCss,V.castRemToPixel)("--page-position-top"),topSelected:V.setPipe(V.getCss,V.castRemToPixel)("--page-position-top-selected"),peek:V.getCss("--page-position-peek"),closed:V.getCss("--page-position-closed"),detach:V.setPipe(V.getCss,V.castRemToPixel)("--desktop-page-detach")});const e=V.getState();V.setState("page",{topCalc:e.screen.height-e.page.top-1.5*e.page.detach}),V.setState("page",{topSelectedCalc:e.screen.height-e.page.topSelected-1.5*e.page.detach}),V.setState("page",{featureCalc:Math.floor(e.screen.height-e.page.topSelected-9*(e.screen.width<600?e.screen.width:600)/16)}),V.setState("page",{featureDimensions:{width:e.screen.width<600?e.screen.width:495,height:Math.floor(9*(e.screen.width<600?e.screen.width:495)/16)}}),V.setState("header",{isHazed:!1,serviceNavTop:V.setPipe(V.getCss,V.castRemToPixel,Number)("--service-nav-top"),serviceNavLeft:V.getCss("--service-nav-left"),entityNavTop:V.getCss("--entity-nav-top"),entityNavLeft:V.getCss("--entity-nav-left")})}(),window.onresize=function(){window.innerHeight<V.getState("screen").height/4*3&&!V.getVisibility("form")?"top"==V.getState("page").position?(V.setStyle("keyboard-open",{"page-top-keyb-open":{top:V.getState("page").current.top+"px",bottom:"0 !important",height:"unset !important"}}),V.getNode("page").classList.add("page-top-keyb-open")):(V.setStyle("keyboard-open",{"page-max-keyb-open":{"max-height":window.innerHeight-V.getState("page").top+"px !important"}}),V.getNode("page").classList.add("page-max-keyb-open")):V.getNode("page").classList.remove("page-top-keyb-open","page-max-keyb-open")},document.addEventListener("keydown",(function(e){const t=window.event?e.keyCode:e.which;13==t?V.getVisibility("#query")||V.getVisibility("#search")?(e.preventDefault(),n(["search","query"])):V.getVisibility("form")||V.getVisibility("modal")||V.getVisibility(".messageform")||V.getNode(".magic-btn__btn").click():27==t&&(e.preventDefault(),CanvasComponents.handleClosePopup(),n(["close","modal-close"]))})),document.documentElement.style.setProperty("--screen-height",window.innerHeight+"px"),document.documentElement.style.setProperty("--screen-width",window.innerWidth+"px"),V.setStyle("font-styles",{"@font-face":{"font-family":"IBM Plex Regular",src:"url("+V.getSetting("sourceEndpoint")+"/assets/font/IBMPlexSans-Regular.ttf) format('truetype')","font-display":"fallback","unicode-range":"U+000-024F"},"@font-face-2":{"font-family":"IBM Plex Medium",src:"url("+V.getSetting("sourceEndpoint")+"/assets/font/IBMPlexSans-Medium.ttf) format('truetype')","font-display":"fallback","unicode-range":"U+000-024F"},"@font-face-3":{"font-family":"IBM Plex Bold",src:"url("+V.getSetting("sourceEndpoint")+"/assets/font/IBMPlexSans-Bold.ttf) format('truetype')","font-display":"fallback","unicode-range":"U+000-024F"},"@font-face-4":{"font-family":"Indie Flower",src:"url("+V.getSetting("sourceEndpoint")+"/assets/font/IndieFlower-Regular.ttf) format('truetype')","font-display":"fallback","unicode-range":"U+000-024F"}})},draw:function(e){t(e)}}}(),CanvasComponents=function(){"use strict";V.setStyle({"list > *:last-child":{"padding-bottom":"160px"},"card__top-left":{width:"25%"},"card__bottom-left":{display:"grid","justify-items":"center","text-align":"center",width:"25%"},"card__top-right":{width:"69%"},"card__bottom-right":{width:"69%"},card__unit:{width:"100%"},card__container:{"max-width":"360px","flex-wrap":"wrap"},background:{background:"rgba(211,232,235,1)",height:"100vh","z-index":-2},haze:{top:0,height:"45vh","z-index":-1},handle:{"padding-top":"12px",height:"26px",display:"block"},handle__bar:{"margin-left":"auto","margin-right":"auto",height:"4px",width:"5%","max-width":"40px"},page:{bottom:0,height:"var(--page-position-peek)"},"page-full-screen":{top:0,bottom:"0 !important",height:"unset !important"},"network-logo":{height:"18px"}});const e={transaction:"No transactions found",message:"No messages found",entity:"No entities found",marketplace:"No items found",media:"No media items found",close:"close"};function t(){V.setNode(".leaflet-popup-pane",""),V.getVisibility(".popup")&&V.setAnimation(".popup",{opacity:0},{duration:.8},{delay:.5}).then(()=>{V.setNode(".popup-content","")})}return{notFound:function(t){return V.cN({t:"p",c:"pxy",h:(n=e[t],V.i18n(n,"canvas",o||"not found")+" ")});var n,o},background:function(){return V.cN({t:"background",id:"background",k:t,c:"background fixed w-screen"})},haze:function(){return V.cN({t:"haze",c:"haze fixed w-screen bkg-white hidden"})},feature:function(){const e=V.getState("page").featureDimensions;return V.cN({t:"feature",c:"feature fixed hidden",setStyle:{feature:{top:"var(--page-position-top-selected)",height:e.height+"px",width:e.width+"px",background:"white"}}})},balance:function(){const e=V.getState("screen");return V.cN({t:"balance",c:"balance fixed cursor-pointer txt-anchor-mid",y:e.width>800?{top:"12px",left:"12px"}:{top:"2px",left:"2px"}})},interactions:function(){const e=V.getState("screen");return V.cN({t:"interactions",c:"interactions fixed",s:{interactions:{top:e.width>800?"23px":"11px",right:0,width:"45%"}},h:{t:"ul",c:"flex items-center justify-end"}})},handle:function(){return V.cN({t:"handle",c:"handle",h:{c:"handle__bar rounded-full bkg-offblack"}})},topSlider:function(){return V.cN({t:"topslider"})},slider:function(){return V.cN({t:"slider",c:"flex overflow-x-scroll list-none pb-s"})},listings:function(){return V.cN({t:"listings"})},list:function(e){const t=V.cN({t:"list",c:"list flex flex-wrap content-start justify-evenly overflow-y-scroll list-none h-full"});return"narrow"==e&&(t.style["max-width"]="380px",t.style.margin="0 auto"),t},card:function(e,t,n){return V.cN({t:"li",c:"pxy w-screen max-w-380",i:n,h:{t:"card",c:"card__container flex card-shadow rounded bkg-white pxy",h:t?[{t:"h2",c:"w-full font-bold pxy capitalize",h:t},e]:e}})},header:function(){return V.cN({t:"header",c:"absolute"})},page:function(){return V.cN({t:"page",c:"page fixed w-screen bkg-white pill-shadow overflow-hidden"})},content:function(){return V.cN({t:"content"})},topContent:function(){return V.cN({t:"topcontent"})},logo:function(){return V.cN({t:"logo",c:"fixed hidden w-screen",k:t,h:{c:"popup",h:[{c:"popup-content-wrapper flex flex-wrap justify-center items-center",h:[{c:"popup-content"}]},{c:"popup-tip-container",h:{c:"popup-tip"}}]}})},networkLogo:function(){return V.cN({t:"img",c:"network-logo",src:V.getSetting("logo")})},handleClosePopup:t}}(),Feature=function(){"use strict";function e(e){return{$content:"object"==typeof e?e:e.content?e.content:void 0,fade:e.fade}}function t(e){const t=V.getNode("feature");"out"!=e.fade?("in"==e.fade||e.$content)&&(t.textContent="",V.setNode(t,e.$content),V.setAnimation("feature","fadeIn")):V.setAnimation("feature","fadeOut")}return{launch:function(){V.setNode("body",CanvasComponents.feature())},draw:function(n){V.setPipe(e,t)(n)}}}(),Haze=function(){"use strict";return{launch:function(){V.setNode("body",CanvasComponents.haze())},draw:function(e){!function(e){if(e&&"out"==e.fade)return V.setState("header",{isHazed:!1}),void V.setAnimation("haze","fadeOut",{delay:.1,duration:1});1!=V.getState("header").isHazed&&(V.setState("header",{isHazed:!0}),V.setAnimation("haze","fadeIn",{delay:2,duration:3}))}(e)}}}(),Header=function(){"use strict";return{launch:function(){const e=CanvasComponents.header(),t=CanvasComponents.balance(),n=NavComponents.entityNav(),o=NavComponents.userNav(),i=NavComponents.serviceNav(),a=CanvasComponents.interactions(),s=SearchComponents.searchMain();V.setNode(e,[t,n,o,i,a,s]),V.setNode("body",e)}}}(),Logo=function(){"use strict";function e(){const e=V.getNode("page").getBoundingClientRect();V.setNode("logo",CanvasComponents.networkLogo()),t(e.height>V.getState("page").closed?"peek":"closed")}function t(e){const t=V.getNode("logo"),n=V.getState("screen");"closed"==e?V.setAnimation(t,n.width<800?{bottom:"40px",left:"4px"}:{bottom:"70px",left:"35px"},{delay:.5}):"peek"==e&&V.setAnimation(t,n.width<800?{bottom:"110px",left:"4px"}:{bottom:"140px",left:"35px"},{delay:.5}),V.getVisibility("logo")||V.setAnimation(t,"fadeIn",{delay:1,duration:3})}return{launch:function(){V.setNode("body",CanvasComponents.logo()),setTimeout(e,2500)},draw:function(e){!function(e){t(e)}(e)}}}(),Page=function(){"use strict";const e={};function t(t){t&&(0!=t.reset&&(e.$topcontent.textContent="",e.$topslider.textContent="",e.$listings.textContent=""),t.topcontent&&V.setNode(e.$topcontent,t.topcontent),t.topslider&&V.setNode(e.$topslider,t.topslider),t.listings&&V.setNode(e.$listings,t.listings),(t.position||t.pos)&&function(t,o,i,a){const s=V.getNode("list"),r=V.getNode("page"),c=V.getState("page"),l=V.getState("screen");"bottom"==o&&(s.scrollTop=s.scrollHeight);const d=function(e){const t=V.getState("page"),n=V.getState("active");switch(e){case"top":return n&&n.navItem?t.topSelectedCalc:t.topCalc;case"feature":return t.featureCalc;case"peek":return t.peek;default:return t.closed}}(t);if(d==c.height)return;V.setAnimation(e.$page,{height:d+"px"},{duration:3}).then(()=>{V.setState("page",{height:d,position:t,current:e.$page.getBoundingClientRect()}),s&&!o&&(s.scrollTop=0)}),"top"==t?(l.width<800&&(Haze.draw(),r.classList.remove("pill-shadow")),Feature.draw({fade:"out"}),CanvasComponents.handleClosePopup(),n(7,22)):"feature"==t?(l.width<800&&(r.classList.remove("pill-shadow"),r.classList.remove("page-full-screen")),l.width<800&&(null==i||0!=i)&&Haze.draw(),CanvasComponents.handleClosePopup(),n(7,22)):"closed"==t?(SearchComponents.drawReset(),Haze.draw({fade:"out"}),Feature.draw({fade:"out"}),CanvasComponents.handleClosePopup(),n(5,35),r.classList.add("pill-shadow"),r.classList.remove("page-full-screen"),Logo.draw(t),null!=a&&0==a||Navigation.drawReset()):"peek"==t&&(Haze.draw({fade:"out"}),Feature.draw({fade:"out"}),n(5,25),r.classList.add("pill-shadow"),r.classList.remove("page-full-screen"),Logo.draw(t))}(t.position||t.pos,t.scroll,t.haze,t.navReset))}function n(e,t){V.setAnimation(".handle__bar",{width:e+"%"}),V.setAnimation("handle",{height:t+"px"})}return{launch:function(){!function(){const t=CanvasComponents.page(),n=CanvasComponents.handle(),o=CanvasComponents.content(),i=CanvasComponents.topContent(),a=CanvasComponents.topSlider(),s=CanvasComponents.listings();function r(e){V.setState("flick",{startX:e.changedTouches[0].clientX}),V.setState("flick",{startY:e.changedTouches[0].clientY})}function c(e){V.setState("flick",{endX:e.changedTouches[0].clientX}),V.setState("flick",{endY:e.changedTouches[0].clientY});const t=V.getNode("list");let n=!0;t&&t.scrollTop>0&&"listings"==e.currentTarget.localName&&(n=!1);const o=V.getState("page"),i=V.getState("flick");Math.abs(i.startX-i.endX)<100&&i.startY>i.endY+15?o.height==o.peek||o.height==o.featureCalc?Page.draw({position:"top",reset:!1}):o.height==o.closed&&Page.draw({position:"peek",reset:!1}):n&&Math.abs(i.startX-i.endX)<100&&i.startY<i.endY-15&&(o.height==o.peek?Page.draw({position:"closed",reset:!1}):(o.height==o.featureCalc||o.height>=o.topCalc)&&Page.draw({position:"peek",reset:!1}))}t.addEventListener("mouseover",(function(){V.setNode(".popup-content",""),V.getNode(".popup","").style.opacity=0})),n.addEventListener("click",(function(){const e=V.getState("page");e.height==e.closed?Page.draw({position:"peek",reset:!1}):e.height==e.peek?Page.draw({position:"top",reset:!1}):(e.height==e.featureCalc||e.height>=e.topCalc)&&Page.draw({position:"closed",reset:!1})})),n.addEventListener("touchstart",r),n.addEventListener("touchend",c),i.addEventListener("touchstart",r),i.addEventListener("touchend",c),a.addEventListener("touchstart",r),a.addEventListener("touchend",c),s.addEventListener("touchstart",r),s.addEventListener("touchend",c),V.setNode(o,[i,a,s]),V.setNode(t,[n,o]),V.setNode("body",t),e.$page=V.getNode("page"),e.$topcontent=V.getNode("topcontent"),e.$topslider=V.getNode("topslider"),e.$listings=V.getNode("listings")}()},draw:function(e){return Promise.resolve(t(e))}}}(),Button=function(){"use strict";function e(t){t.target.removeEventListener("click",e),V.setNode("interactions > ul",InteractionComponents.confirmClickSpinner());const n=V.getNode("form"),o=n.getNode("#plusform__loc"),i={title:n.getNode("#plusform__title").value,role:V.getNavItem("active","serviceNav").use.role,location:o.value,lat:o.value&&o.getAttribute("lat")||void 0,lng:o.value&&o.getAttribute("lng")||void 0,description:n.getNode("#plusform__descr").value,unit:n.getNode("#plusform__unit").value,target:n.getNode("#plusform__target").value};V.aE()&&0!=V.aE().auth?V.setEntity(i).then(e=>{V.setNode(".confirm-click-spinner","clear"),e.success?(V.setLocal("last-form",void 0),console.log(e.message),console.log("set uuidE:",e.data[0].uuidE),V.setBrowserHistory(e.data[0].path),User.draw({uuidE:e.data[0].uuidE,uuidP:e.data[0].uuidP}),Button.draw("set",{fade:"out"}),Form.draw("all",{fade:"out"}),"MongoDB"==V.getSetting("entityLedger")&&V.setEntity(V.aE().fullId,{field:"adminOf",data:e.data[0].fullId})):(Form.draw("error",e),console.error(e))}):(V.setLocal("last-form",i),Modal.draw("confirm uPhrase"),t.target.addEventListener("click",e))}function t(){const e=V.getNode("#search-input").value;if(e.length<2)return;const t={query:e};Marketplace.draw(V.getState("active").navItem,t)}function n(){Page.draw({position:"closed",reset:!1,navReset:!1}),Form.draw("search")}function o(){Page.draw({position:"closed",reset:!1,navReset:!1}),Form.draw(V.getNavItem("active","serviceNav").use.form)}function i(){V.setBrowserHistory("/me/transfers"),V.setState("active",{lastViewed:V.getNode(".pill__replace").textContent}),Canvas.draw({path:"/me/transfers"})}return V.handleSetEntity=e,{launch:function(){!function(){const a=InteractionComponents.filter(),s=InteractionComponents.searchBtn(),r=InteractionComponents.query(),c=InteractionComponents.plus(),l=InteractionComponents.set(),d=InteractionComponents.sendNav();c.addEventListener("click",o),s.addEventListener("click",n),r.addEventListener("click",t),l.addEventListener("click",e,{once:!0}),d.addEventListener("click",i),V.setNode("interactions > ul",[c,a,s,r,l,d])}()},draw:function(e,t){!function(e,t){if(!e)return;const n="all"==e?["filter","search","plus","set","send","query"]:e.split(" ");let o="fadeIn",i=.2;t&&"out"==t.fade&&(o="fadeOut"),t&&t.delay&&(i=t.delay),n.forEach(e=>{V.setAnimation("#"+e,o,{delay:i,duration:.5})})}(e,t)}}}(),InteractionComponents=function(){"use strict";const e="cursor-pointer hidden pr-s",t="uploading...",n="Change",o="Image",i="Enter a title or city name",a="Key",s="Title",r="Email",c="4 digits",l="Location",d="Description and Links",u="Target",p="Unit",g="Search",f="create",m="search",h="Watch intro",v="Connect a new crypto wallet",y="Ask a friend to transfer 1 VALUE to progress your verification.",w="Verify with BrightID to receive VALUE basic income.";function N(e,t){return V.i18n(e,"interaction",t||"interaction content")+" "}function b(e){V.setNode("#img-upload__label",N(t)),V.castImageUpload(e).then(e=>{V.setNode("#img-upload__label",N(n)),V.setNode("#img-upload__preview",""),V.setNode("#img-upload__preview",V.cN({t:"img",y:{"max-width":"25px","max-height":"20px","margin-left":"10px"},src:e.src}))})}function x(){V.setState("active",{navItem:"/media"}),setTimeout(()=>{V.getNode('[path="/media"]').click()},350)}function k(e,t){return V.cN({c:"circle-1 flex justify-center items-center rounded-full bkg-white transition pill-shadow"+(t?" "+t:""),h:V.getIcon(e)})}return{filter:function(){return V.cN({t:"li",id:"filter",c:e,h:k("filter_list")})},searchBtn:function(){return V.cN({t:"li",id:"search",c:e,h:k("search")})},query:function(){return V.cN({t:"li",id:"query",c:e,h:{c:"create-btn pxy",h:N(m)}})},plus:function(){return V.cN({t:"li",id:"plus",c:e,h:k("+")})},close:function(){return V.cN({t:"li",id:"close",c:e,h:k("close")})},set:function(){return V.cN({t:"li",id:"set",c:e,h:{c:"create-btn pxy",h:N(f)}})},sendNav:function(){return V.cN({t:"li",id:"send",c:e,h:k("send")})},sendBtn:function(){return V.cN({t:"button",i:"send-message",c:"circle-1 flex justify-center items-center rounded-full bkg-white",h:V.cN({t:"span",c:"sendbtn",s:{sendbtn:{position:"relative",left:"1px",top:"1px",opacity:"0.75"}},h:V.getIcon("send")})})},form:function(){return V.cN({tag:"form",classes:"form fixed w-screen hidden bkg-white pxy",setStyle:{form:{"padding-top":"calc(var(--page-position-top-selected) + 5px) !important",height:"100%","z-index":-1}},h:{c:"form__response pxy txt-red"}})},formField:function(e,t,n,o){const i={uPhrase:{label:N(a),inputId:"loginform__uphrase",attributes:{type:"password",autocomplete:"off"}},title:{label:N(s),inputId:"plusform__title",attributes:{value:t,autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false"}},email:{label:N(r),inputId:"plusform__email",attributes:{autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false"}},emailConfirm:{label:N(c),inputId:"plusform__emailConfirm",attributes:{autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false"}},location:{label:N(l),inputId:"plusform__loc",attributes:{value:t,lat:n,lng:o,autocomplete:"off"}},description:{label:N(d),inputId:"plusform__descr",multiline:!0},target:{label:N(u),inputId:"plusform__target",fieldClasses:"flex-grow w-30%"},unit:{label:N(p),inputId:"plusform__unit",fieldClasses:"flex-grow w-30%"},search:{label:N(g),inputId:"search-input",attributes:{autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false"}}};function f(){this.closest(".field").classList+=" field--static field--focus"}function m(){const e=this.closest(".field").classList;this.value||e.remove("field--static"),e.remove("field--focus")}const h=V.cN({c:"field__input-container"}),v=V.cN({c:"field__label-wrapper",h:{t:"label",c:"field__label label-primary",h:{t:"span",c:"label__content",h:i[e].label}}}),y=V.cN({t:"input",c:"field__input",id:i[e].inputId,e:{focus:f,blur:m},a:i[e].attributes||{value:t}}),w=V.cN({t:"textarea",c:"field__input auto-height",id:i[e].inputId,a:{row:"1"},h:t,e:{input:function(){this.style.height="1px",this.style.height=this.scrollHeight+"px"},focus:f,blur:m}});i[e].multiline?V.setNode(h,[v,w]):V.setNode(h,[v,y]);const b=i[e].fieldClasses||"",x=t?" field--static":"";return V.cN({c:"field pxy "+b+x,h:{c:"field__border",h:{c:"field__internal",h:h}}})},formUploadImage:function(){return V.cN({c:"pxy w-30%",h:{s:{"upload-field":{padding:"16px 12px 17px","align-items":"center",border:"1px solid #DBDAE3","border-radius":"2px",color:"#6F7287","font-size":"14px",transition:"border 240ms cubic-bezier(0.4, 0, 0.3, 1)"},"upload-field:hover":{border:"1px solid #A9A8B3"}},c:"upload-field relative flex flex-grow",h:[{t:"label",i:"img-upload__label",c:"w-full cursor-pointer",a:{for:"img-upload__file"},h:N(o)},{t:"input",i:"img-upload__file",c:"hidden",a:{type:"file",accept:"image/*"},e:{change:b}},{i:"img-upload__preview",y:{position:"absolute",right:"10px"}}]}})},formSearchFilter:function(){return V.cN({h:[{t:"p",c:"pxy",h:N(i)}]})},joinBtn:function(){const e=V.getState("screen"),t="rgba("+e.buttonBkg+", 1)";return V.cN({t:"join",i:"join",c:"fixed cursor-pointer txt-anchor-mid",y:e.width>800?{top:"12px",left:"12px"}:{top:"2px",left:"2px"},h:{svg:!0,a:{width:e.width>800?"66px":"54px",viewBox:"0 0 36 36"},h:[{svg:!0,t:"circle",a:{"stroke-dasharray":"100",transform:"rotate(-90, 18, 18) translate(0, 36) scale(1, -1)","stroke-dashoffset":"-200",cx:"18",cy:"18",r:"15.91549430918954",fill:t,stroke:t,"stroke-width":"2.7"}},{svg:!0,t:"text",c:"font-medium fs-xs txt-button",a:{x:"50%",y:"59%"},h:"Join"}]}})},onboardingCard:function(){const e=V.getSetting("transactionLedger");if(V.aE()&&"EVM"==e){let e;const t=!!(V.aE().balance&&V.aE().balance.balance.liveBalance>0);return V.cA()?t||"Person"!=V.aE().role?t&&"Person"==V.aE().role?(e=V.castNode({tag:"div",c:"flex w-full items-center justify-evenly",html:"<p>👋 "+N(w,"onboarding call to action")+"</p>"}),CanvasComponents.card(e)):"":(e=V.castNode({tag:"div",c:"flex w-full items-center justify-evenly",html:"<p>👋 "+N(y,"onboarding call to action")+"</p>"}),CanvasComponents.card(e)):(e=V.castNode({tag:"div",c:"flex w-full items-center justify-evenly",html:"<p>👋 "+N(v,"onboarding call to action")+"</p>"}),e.addEventListener("click",(function(){window.Web3Obj?Join.draw("authenticate existing entity"):Join.draw("install metamask")})),CanvasComponents.card(e))}return""},getStarted:function(){return V.cN({t:"li",i:"get-started",s:{getstarted:{background:"rgb(255,112,148)",color:"white"}},c:"pill getstarted flex justify-center items-center rounded-full cursor-pointer no-txt-select whitespace-no-wrap",h:N(h),k:x})},confirmClickSpinner:function(){return V.cN({svg:!0,c:"confirm-click-spinner",a:{width:"18",height:"18",viewBox:"0 0 50 50"},h:[{svg:!0,t:"path",a:{d:"M25,5A20.14,20.14,0,0,1,45,22.88a2.51,2.51,0,0,0,2.49,2.26h0A2.52,2.52,0,0,0,50,22.33a25.14,25.14,0,0,0-50,0,2.52,2.52,0,0,0,2.5,2.81h0A2.51,2.51,0,0,0,5,22.88,20.14,20.14,0,0,1,25,5Z"},h:{svg:!0,t:"animateTransform",a:{attributeName:"transform",type:"rotate",from:"0 25 25",to:"360 25 25",dur:"0.7s",repeatCount:"indefinite"}}}]})}}}(),Form=function(){"use strict";return{draw:function(e,t){!function(e){if(e.fadeOut)V.getNode("form")&&V.setAnimation("form","fadeOut",{delay:.2,duration:1}).then(()=>{V.setNode("form","clear")});else if(e.success){const t=InteractionComponents.form();if("new entity"==e.layout){const n=e.data[0];V.getNode("#set").addEventListener("click",V.handleSetEntity,{once:!0}),V.setNode(t,[InteractionComponents.formField("title",n.title),InteractionComponents.formField("location",n.location,n.lat,n.lng),InteractionComponents.formField("description",n.description),V.cN({c:"flex",h:[InteractionComponents.formUploadImage(),InteractionComponents.formField("target",n.target),InteractionComponents.formField("unit",n.unit)]})])}else"search"==e.layout?V.setNode(t,[InteractionComponents.formField("search"),InteractionComponents.formSearchFilter()]):V.setNode(t,[InteractionComponents.title(),InteractionComponents.desc()]);V.setNode("body",t),setTimeout(()=>{V.getVisibility("#search-input")&&V.getNode("#search-input").focus(),V.getVisibility("#plusform__title")&&V.getNode("#plusform__title").focus()},600),V.setAnimation("form","fadeIn",{delay:.2,duration:1}),Google.launch().then(()=>{Google.initAutocomplete("plusform")}),Button.draw("all",{fade:"out"}),Button.draw("search"==e.layout?"query":"set",{delay:1})}else V.getNode(".form__response").textContent=e.message}(function(e,t){if(t&&"out"==t.fade)return{fadeOut:!0};if("error"==e)return t;let n;if("new entity"==e){n={title:void 0,role:void 0,location:void 0,lat:void 0,lng:void 0,description:void 0,unit:void 0,target:void 0};const e=V.castJson(V.getLocal("last-form"));e&&(n.title=e.title,n.location=e.location,n.lat=e.lat,n.lng=e.lng,n.description=e.description,n.unit=e.unit,n.target=e.target)}return{success:!0,layout:e,data:[n]}}(e,t))}}}(),Join=function(){"use strict";async function e(){return V.cA()?V.getEntity("JOIN--"+V.cA()).then(async e=>{if(e.reset)return"entity not found";if(e.success){V.setActiveEntity(e.data[0]),Navigation.drawJoinedUserPill();const t=await V.getEntityBalance(e.data[0]);return t.success?V.setState("activeEntity",{balance:{success:!0,balance:t.data[0]}}):V.setState("activeEntity",{balance:{success:!1,message:t.message.message.message}}),"entity found"}return"entity not found"}):"error"}function t(){V.getNode(".profile-nudge")?(V.sN(".profile-nudge","clear"),V.getNode(".skill-nudge").style.display="block"):V.getNode(".skill-nudge")?(V.sN(".nudge-overlay","clear"),function(e){const t=V.cN({c:"first-view-key pxy",y:{position:"absolute",right:"10px",bottom:"10px","z-index":-1},h:[{t:"input",a:{value:e,type:"password"},y:{width:"230px",padding:"2px 8px",background:"lightskyblue",border:"2px solid blue","border-radius":"20px"},e:{focus:n,blur:n}}]});V.setNode("logo",t);const o=document.querySelector(".first-view-key").getBoundingClientRect(),i=V.cN({c:"save-key",y:{position:"absolute",top:o.y-220+"px",left:o.x-85+"px","z-index":-2},h:[{c:"font-indie",y:{"font-size":"1.9rem",color:"blue","text-shadow":"0 0 5px white"},h:"Before you begin, copy and save this key elsewhere"},{innerHtml:'<svg class="nudge-arrow nudge-arrow__key" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 43.1 85.9" style="enable-background:new 0 0 43.1 85.9;" xml:space="preserve"><path stroke-linecap="round" stroke-linejoin="round" class="draw-nudge-arrow" d="M11.3,2.5c-5.8,5-8.7,12.7-9,20.3s2,15.1,5.3,22c6.7,14,18,25.8,31.7,33.1" /><path stroke-linecap="round" stroke-linejoin="round" class="draw-nudge-arrow tail-1" d="M40.6,78.1C39,71.3,37.2,64.6,35.2,58" /><path stroke-linecap="round" stroke-linejoin="round" class="draw-nudge-arrow tail-2" d="M39.8,78.5c-7.2,1.7-14.3,3.3-21.5,4.9" /></svg>'}]});V.setNode("body",i)}(this)):V.sN(".nudge-overlay","clear")}function n(e){if("password"===this.type)V.sN(".save-key","clear"),this.type="text",setTimeout((function(){e.target.setSelectionRange(0,9999)}),50);else{window.getSelection().removeAllRanges(),this.type="password"}}return{launch:function(){if(!V.getLocal("browser-id")){const e="BRID"+V.castUuid().base64Url.substr(1,16);V.setLocal("browser-id",e)}if(!V.getNode("join")){V.setNode("balance > svg","clear"),V.setLocal("welcome-modal",1);const e=InteractionComponents.joinBtn();e.addEventListener("click",(function(){Join.draw("initialize join")})),V.setNode("header",e)}},draw:function(t){(async function(t){return V.getState("browserWallet")&&"EVM"==V.getSetting("transactionLedger")?"initialize join"==t?t="initialize web3 join":t.includes("authenticate")?await V.setConnectedAddress().then(async n=>{if(n.success){const n=await e();t.includes("existing entity")?(V.setLocal("welcome-modal",1),t="authenticate existing entity"):t=n}else t=n.status}):"new entity was set up"==t&&(V.aE()&&V.aE().fullId?t="entity found":V.cA()&&(t=await e())):"Symbol"==V.getSetting("transactionLedger")?"initialize join"==t?t="web2 login":"new entity was set up"==t&&(V.setLocal("last-connected-address",V.aE().symbolCredentials.address),t="entity found"):"initialize join"==t?t="initialize web2 join":"new entity was set up"==t&&(t="entity found"),t})(t).then(e=>{!function(e){if(console.log("join: ",e),"entity found"==e){V.setNode("join","clear"),V.setNode(".modal","clear"),1==V.getLocal("welcome-modal")&&(Navigation.drawEntityNavPill(V.getState("activeEntity")),V.setLocal("welcome-modal",0));const e=V.aE().balance;e?e&&e.success?Account.drawHeaderBalance(e.balance.balance):Modal.draw("could not get balance"):Account.drawHeaderBalance(),setInterval(Account.drawHeaderBalance,1e3*V.getSetting("balanceCheckInterval"))}else"entity not found"==e?(V.sN("balance > svg","clear"),Join.launch(),Modal.draw(e)):"logged out"==e||"user denied auth"==e?(Join.launch(),Navigation.draw(),Modal.draw(e)):(Navigation.draw(),Modal.draw(e))}(e)})},onboard:function(e){const n=document.querySelector('[path="/network/skills"]'),o=document.querySelector("entity-nav"),i=n.getBoundingClientRect(),a=o.getBoundingClientRect();V.sN("body",V.cN({c:"nudge-overlay",y:{position:"absolute",top:"0",bottom:"0",left:"0",right:"0"},k:t.bind(e),h:[{c:"profile-nudge",y:{position:"absolute",top:a.y+22+"px",left:a.x+50+"px"},h:[{innerHtml:'<svg class="nudge-arrow nudge-arrow__profile" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 43.1 85.9" style="enable-background:new 0 0 43.1 85.9;" xml:space="preserve"><path stroke-linecap="round" stroke-linejoin="round" class="draw-nudge-arrow" d="M11.3,2.5c-5.8,5-8.7,12.7-9,20.3s2,15.1,5.3,22c6.7,14,18,25.8,31.7,33.1" /><path stroke-linecap="round" stroke-linejoin="round" class="draw-nudge-arrow tail-1" d="M40.6,78.1C39,71.3,37.2,64.6,35.2,58" /><path stroke-linecap="round" stroke-linejoin="round" class="draw-nudge-arrow tail-2" d="M39.8,78.5c-7.2,1.7-14.3,3.3-21.5,4.9" /></svg>'},{c:"font-indie",y:{"font-size":"1.9rem",color:"blue","text-shadow":"0 0 5px white"},h:"Add your image and location"}]},{c:"skill-nudge",y:{display:"none",position:"absolute",top:i.y+28+"px",left:i.x+-25+"px"},h:[{innerHtml:'<svg class="nudge-arrow nudge-arrow__skill" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 43.1 85.9" style="enable-background:new 0 0 43.1 85.9;" xml:space="preserve"><path stroke-linecap="round" stroke-linejoin="round" class="draw-nudge-arrow" d="M11.3,2.5c-5.8,5-8.7,12.7-9,20.3s2,15.1,5.3,22c6.7,14,18,25.8,31.7,33.1" /><path stroke-linecap="round" stroke-linejoin="round" class="draw-nudge-arrow tail-1" d="M40.6,78.1C39,71.3,37.2,64.6,35.2,58" /><path stroke-linecap="round" stroke-linejoin="round" class="draw-nudge-arrow tail-2" d="M39.8,78.5c-7.2,1.7-14.3,3.3-21.5,4.9" /></svg>'},{c:"font-indie",y:{"font-size":"1.8rem",color:"blue","text-shadow":"0 0 5px white"},h:"Add a skill"}]}]}))}}}(),ModalComponents=function(){"use strict";const e={close:"close",connectingWallet:"Connecting wallet",connectWallet:"Join with wallet",useKey:"Use key",nameProfile:"Name profile",joining:"Joining",welcome:"Welcome",connectedAddress:"Address connected",confInWallet:"Confirm in wallet ... ",submitted:"submitted ...",enableWallet:"Enable a crypto wallet in your browser, for example",getMetaMask:"Get MetaMask",signTx:"Sign Transaction",newNameOnly:"Name personal profile only",newName:"Name personal profile",newNameExplain:"Name yourself, your personal profile here for your address. Later you can add anything you want to make visible in the network, like a business or your skills.",emailExplainA:"The admins of",emailExplainB:"kindly ask you to provide a real email address. This address will not be publicly visible.",confirmExplain:"Check your inbox (and spam) and enter the 4 digits emailed to you.",email:"Set email",confirmEmail:"Confirm",isConfirmCode:"is your confirmation code",confirmNumberIncorrect:"This 4-digit number is not correct",manageProfile:"Join with existing key",disconnect:"Confirm Disconnect",useProfile:"Use current profile",copyKey:"Click to copy the key and store it safely elsewhere",copyKeyExplain:"You'll need this key to manage this profile",liveBalance:"Live Balance",notRetrieved:"Sorry, account details could not be retrieved",fourOfour:"404 - Page not found",loggedOut:"You are logged out",entityExists:"This combination of title and tag already exists or is invalid",txSent:"✅ Sent to network",txSuccess:"✅ Transaction successful",error:"Something went wrong. Maybe the wallet is locked or you did not sign the transaction?",wait:"Please wait... requesting data",walletLocked:"Could not unlock wallet. Maybe the site's connectivity to the wallet was denied? Check the browser or wallet settings.",noBalance:"Could not get account balance. Is the network set correctly in your wallet? <br><br>Please set to RINKEBY.",txTo:"Recipient",txAmount:"Amount",txContribution:"Contribution",txFee:"Fee",txTotal:"Total"};function t(e,t){return V.i18n(e,"modal",t||"modal content")+" "}V.setStyle({modal:{top:"0",right:"0",bottom:"0",left:"0",background:"rgba(0,0,0,0.8)"},modal__content:{background:"white",width:"75vw","max-width":"500px",height:"46vh",margin:"14vh auto",padding:"0.5rem"},modal__close:{position:"absolute",right:"1rem",top:"1rem","text-decoration":"none",color:"white"},modal__uphrase:{color:"red"},"modal-pos-1":{top:"5vh"},"modal-pos-2":{top:"10vh"},"modal-pos-3":{top:"15vh"},"confirm-click-spinner":{"margin-left":"14px"}});const n="relative flex justify-center items-center bkg-button txt-button font-medium cursor-pointer txt-center pxy-1",o="relative cursor-pointer txt-center";function i(){V.setNode(".modal","clear")}function a(e){e.stopPropagation()}function s(){const o=InteractionComponents.formField("uPhrase"),i=V.cN({i:"use-key-btn",c:n+" modal-pos-1",k:r,h:t(e.useKey)}),a=V.cN({c:"form__response pxy txt-red"});V.sN(".modal__content",""),V.setNode(".modal__content",[o,a,i])}function r(){V.setNode("#use-key-btn",InteractionComponents.confirmClickSpinner()),V.setAuth(V.getNode("#loginform__uphrase").value).then(e=>{if(e.success)return console.log("auth success"),e.data[0].uuidE;throw new Error(e.message)}).then(e=>V.getEntity(e)).then(e=>{if(!e.success)throw new Error("could not get entity after set auth");V.setActiveEntity(e.data[0]),Join.draw("new entity was set up")}).catch(e=>{console.log("auth unsuccessful -",e),V.getNode(".form__response").textContent=e,V.setNode(".confirm-click-spinner","clear"),Join.launch()})}function c(e){e.stopPropagation(),V.setNode("#connectwallet-btn",InteractionComponents.confirmClickSpinner()),Join.draw("authenticate")}function l(n){n.stopPropagation(),n.target.removeEventListener("click",l,!1);const o=V.getNode("#sign-transaction");o.style.background="white",o.style.color="rgba("+V.getState("screen").brandSecondary+", 1)",V.cA()?o.textContent=t(e.confInWallet):(Modal.draw("transaction sent"),V.drawHashConfirmation(String(V.getState("active").transaction.data[0].timeSecondsUNIX)));const i=V.getState("active").transaction,a=e=>{console.log(e)};V.setTransaction(i).then(e=>{console.log(e),e.success||e.data.setTransaction.success?(V.drawTxConfirmation(e.data.setTransaction?e.data.setTransaction.data:e.data[0]),Account.drawHeaderBalance(),a("successfully")):(Modal.draw("error"),a("unsuccessfully"))}).catch(e=>{console.error(e),Modal.draw(),a("unsuccessfully")})}function d(){"EVM"==V.getSetting("transactionLedger")&&V.setEntity(V.aE().fullId,{field:"evmCredentials.address",data:V.cA(),role:V.aE().role}).then(()=>{Join.draw("authenticate")})}function u(e){e.stopPropagation(),window.open("https://metamask.io/download.html","_blank")}function p(){V.setNode("#disconnect-btn",InteractionComponents.confirmClickSpinner()),V.setDisconnect()}function g(){w("title",f,t(e.nameProfile))}function f(n){const o=V.getNode("#plusform__title").value,i=V.castEntityTitle(o,"Person");i.success?(V.setState("newRegistration",{title:o}),V.getSetting("askforEmail")?w("email",m,t(e.email),t(e.emailExplainA+" "+window.location.hostname+" "+e.emailExplainB)):v(n)):V.getNode(".joinform__response").textContent=i.message}function m(n){const o=V.castTag().replace("#",""),i=V.getNode("#plusform__email").value;V.getNode(".joinform__response").textContent="",n.target.append(InteractionComponents.confirmClickSpinner()),V.setState("newRegistration",{emailPrivate:V.getNode("#plusform__email").value}),Email.send({SecureToken:V.getSetting("emailKey"),To:i,From:"network.mailer@valueinstrument.org",Subject:window.location.hostname+": "+o+" "+t(e.isConfirmCode),Body:window.location.hostname+": "+o+" "+t(e.isConfirmCode)}).then(i=>{"OK"==i?w("emailConfirm",h.bind(o),t(e.confirmEmail),t(e.confirmExplain)):(n.target.textContent=t(e.newEmail),V.getNode(".joinform__response").textContent=i)})}function h(n){V.getNode("#plusform__emailConfirm").value==this?v(n):V.getNode(".joinform__response").textContent=t(e.confirmNumberIncorrect)}function v(n){n.stopPropagation(),n.target.removeEventListener("click",f,!1),n.target.removeEventListener("click",h,!1),V.sN(".explain","clear"),n.target.textContent=t(e.joining),n.target.append(InteractionComponents.confirmClickSpinner()),n.target.parentNode.append(V.cN({c:"progress-bar",h:{t:"span",c:"bar",h:{t:"span",c:"progress"}}})),V.getNode(".joinform__response").textContent="";const o={title:V.getState("newRegistration").title,emailPrivate:V.getState("newRegistration").emailPrivate||null,role:"Person",evmAddress:V.cA()||null};console.log("about to set entity: ",o),V.setEntity(o).then(e=>{e.success?(console.log("successfully set entity: ",e),V.setAuth(e.data[0].auth.uPhrase).then(e=>{e.success?console.log("auth success"):console.log("could not set auth after setting new entity")}),V.getState("active").navItem?(Navigation.drawReset(),setTimeout(y,900,e.data[0].auth.uPhrase)):Join.onboard(e.data[0].auth.uPhrase),V.setActiveEntity(e.data[0]),Join.draw("new entity was set up")):(console.log("could not set entity: ",e),V.getNode(".joinform__response").textContent=e.message)})}function y(e){Join.onboard(e)}function w(e,t,o,i){const a=V.cN({c:n,k:t,h:o}),s=InteractionComponents.formField(e),r=V.cN({c:"joinform__response pxy txt-red"}),c=V.cN({t:"p",c:"explain modal-pos-1 relative txt-center",h:i||""});V.sN(".modal__content",""),V.setNode(".modal__content",[s,r,a,c])}function N(){return V.cN({c:"modal__content relative",k:a})}return{modal:function(){return V.cN({t:"modal",c:"modal fixed",h:{i:"modal-close",c:"modal__close",h:t(e.close),k:i},k:i})},modalContent:N,preview:function(){const n=N(),o=V.cN({t:"p",h:[{c:"preloader__ring"},{t:"loader",c:"preloader__text",h:t(e.wait)}]});return V.setNode(n,o),n},simpleMessage:function(n){const o=N(),i=V.cN({t:"p",h:t(e[n])});return V.setNode(o,i),o},validationError:function(e){const t=N(),n=V.cN({t:"p",h:e});return V.setNode(t,n),t},getMetaMask:function(){const o=N(),i=V.cN({t:"p",c:"txt-center",h:t(e.enableWallet)+' <a href="https://metamask.io/download.html" target="_blank">MetaMask</a>'}),a=V.cN({c:"mt-r mb-r ml-auto mr-auto",y:{width:"108px"},h:{t:"img",src:"/assets/img/metamask-fox.png"}}),s=V.cN({c:n,k:u,h:t(e.getMetaMask)});return V.setNode(o,[i,a,s]),o},confirmTransaction:function(o){const i=o.data[0],a=N(),s=V.cN({t:"p",c:"modal__p",h:[{t:"p",h:`${t(e.txAmount)}: ${i.amount}`},{t:"p",h:`${t(e.txFee)}: ${i.feeAmount}`},{t:"p",h:`${t(e.txContribution)}: ${i.contribution}`},{t:"p",h:`${t(e.txTotal)}: ${i.txTotal}`},{t:"p",h:`${t(e.txTo)}: ${i.recipient} `}]}),r=V.cN({i:"sign-transaction",c:n+" modal-pos-1",k:l,h:t(e.signTx)});return V.setNode(a,[s,r]),a},web3Join:function(){const i=N(),a=V.cN({i:"connectwallet-btn",c:n+" modal-pos-1",k:c,h:t(e.connectWallet)}),r=V.cN({t:"p",c:o+" modal-pos-2",k:s,h:t(e.manageProfile)}),l=V.cN({t:"p",c:o+" modal-pos-3",k:g,h:t(e.newNameOnly)});return V.setNode(i,[a,r,l]),i},web2Join:function(){const i=N(),a=V.cN({c:n+" modal-pos-1",k:g,h:t(e.newName)}),r=V.cN({t:"p",c:o+" modal-pos-2",k:s,h:t(e.manageProfile)});return V.setNode(i,[a,r]),i},confirmUPhrase:function(){const o=N(),i=V.cN({c:n+" modal-pos-1",k:s,h:t(e.manageProfile)});return V.setNode(o,i),o},disconnect:function(){const o=N(),i=V.cN({i:"disconnect-btn",c:n+" modal-pos-1",k:p,h:t(e.disconnect)});return V.setNode(o,i),o},connectWallet:function(){const n=N(),o=V.cN({c:"preloader",h:[{c:"preloader__ring"},{t:"loader",c:"preloader__text",h:t(e.connectingWallet)}]});return V.setNode(n,o),n},mapAddress:function(){const i=N(),a=V.cN({c:n+" modal-pos-1",k:d,h:t(e.useProfile)}),s=V.cN({t:"p",c:o+" modal-pos-2",k:g,h:t(e.newName)});return V.setNode(i,[a,s]),i},entityFound:function(n,o,i,a,s){const r=N(),c=V.cN({c:"txt-center pxy",h:[{t:"p",h:t(e.welcome)},{t:"p",c:"font-medium fs-l pxy",h:n.fullId},{t:"p",h:o?t(e.connectedAddress):""},{t:"p",c:"fs-s pxy",h:o}]});if(i){const n=V.cN({c:"txt-center",y:{background:"aquamarine","border-radius":"3px"},h:[{t:"p",c:"pxy",h:t(e.copyKey)},UserComponents.castAccessKeyNode(i||"","txt-red fs-l"),{t:"p",c:"pxy",h:t(e.copyKeyExplain)}]});V.setNode(r,[c,n])}else V.setNode(r,c);return r},entityNotFound:function(){const i=N(),a=V.cN({c:n+" modal-pos-1",k:g,h:t(e.newName)}),s=V.cN({t:"p",c:o+" modal-pos-2",k:d,h:t(e.useProfile)}),r=V.cN({t:"p",c:"modal-pos-3 relative txt-center",h:t(e.newNameExplain)});return V.aE()?V.setNode(i,[a,s,r]):V.setNode(i,[a,r]),i}}}(),Modal=function(){"use strict";let e;return{draw:function(t,n){!function(t,n){const o=ModalComponents.modal();if("preview"==t)V.setNode(o,ModalComponents.preview());else if("entity found"==t)V.setNode(o,ModalComponents.entityFound(V.aE(),V.cA(),!!e&&e.uPhrase,V.getSetting("coinTicker"),V.getSetting("tokenTicker"))),e=void 0;else if("entity not found"==t)V.setNode(o,ModalComponents.entityNotFound());else if("authenticate existing entity"==t)V.setNode(o,ModalComponents.mapAddress());else if("web3 provider not found"==t)V.setNode(o,ModalComponents.tempUser());else if("initialize web3 join"==t)V.setNode(o,ModalComponents.web3Join());else if("initialize web2 join"==t)V.setNode(o,ModalComponents.web2Join());else if("user denied auth"==t)V.setNode(o,ModalComponents.simpleMessage("walletLocked"));else if("could not get balance"==t)V.setNode(o,ModalComponents.simpleMessage("noBalance"));else if("wallet locked"==t)V.setNode(o,ModalComponents.connectWallet());else if("logged out"==t)V.setNode(o,ModalComponents.simpleMessage("loggedOut"));else if("confirm uPhrase"==t)V.setNode(o,ModalComponents.confirmUPhrase());else if("disconnect"==t)V.setNode(o,ModalComponents.disconnect());else if("install metamask"==t)V.setNode(o,ModalComponents.getMetaMask());else if("please wait"==t)V.setNode(o,ModalComponents.simpleMessage("wait"));else if("confirm transaction"==t){const e=V.getState("active").transaction;V.setNode(o,ModalComponents.confirmTransaction(e))}else"transaction sent"==t?(V.setNode(o,ModalComponents.simpleMessage("txSent")),setTimeout(()=>{V.setNode(".modal","clear")},3500)):"transaction successful"==t?(V.setNode(o,ModalComponents.simpleMessage("txSuccess")),setTimeout(()=>{V.setNode(".modal","clear")},3500)):"404"==t?V.setNode(o,ModalComponents.simpleMessage("fourOfour")):"validation error"==t?V.setNode(o,ModalComponents.validationError(n)):V.setNode(o,ModalComponents.simpleMessage("error"));V.setNode(".modal","clear"),V.setNode("body",o)}(t,n)},setTempAuth:function(t){e=t}}}(),NavComponents=function(){"use strict";return V.setStyle({pill:{height:"2.5rem",padding:"0 1.2rem","margin-right":"0.7rem"},pill__entity:{height:"2.5rem",padding:"0 1rem","margin-right":"0.7rem"},"pill--selected":{color:"rgba(var(--brandPrimary), 1)",border:"2px solid rgba(var(--brandPrimary), 1)"},"pill--user-online":{position:"relative",left:"-3px"},pill__placeholderimage:{position:"relative",bottom:"-6px"},pill__img:{position:"relative",left:"-10px",border:"2px solid white"},pill__initials:{position:"relative",right:"3px"},"entity-nav":{"padding-top":"4px","padding-bottom":"8px",top:"var(--entity-nav-top)",left:"var(--entity-nav-left)"},"user-nav":{"padding-top":"4px","padding-bottom":"8px",top:"var(--user-nav-top)",left:"var(--user-nav-left)",display:"none"},"service-nav":{"padding-top":"4px","padding-bottom":"28px",top:"var(--service-nav-top)",left:"var(--service-nav-left)"},"entity-nav__ul":{"padding-left":"3px"},"service-nav__ul":{"padding-left":"3px"},"user-nav__ul":{"padding-left":"3px"},"entity-nav__ul > *:last-child":{visibility:"hidden"},"service-nav__ul > *:last-child":{visibility:"hidden"},"user-nav__ul > *:last-child":{visibility:"hidden"}}),{pill:function(e){return V.cN({t:"li",c:"pill flex justify-center items-center rounded-full bkg-white pill-shadow cursor-pointer no-txt-select whitespace-no-wrap",a:{path:e.path||"/"},h:[{t:"span",h:V.i18n(e.title,"navigation","nav item")}]})},entityPill:function(e){const t=function(e){const t=["rgba("+V.getState("screen").brandSecondary+", 1)"];if(e.useDataUrl)return"url('"+e.tinyImage+"')";if(e.tinyImage){return"url('"+V.castEntityThumbnail(JSON.parse(e.tinyImage)).src+"')"}return t[0]}(e);return V.cN({t:"li",c:(e.tinyImage?"pill__entity":"pill")+" flex justify-center items-center rounded-full bkg-white pill-shadow cursor-pointer no-txt-select whitespace-no-wrap",a:{uuidE:e.uuidE,uuidP:e.uuidP,path:e.path||"/",fullId:e.title+" "+e.tag,initials:e.initials},h:[{c:"pill__img circle-0 rounded-full flex justify-center items-center cursor-pointer",a:{style:`background:${t}; background-position: center center; background-size: cover;`},h:{c:"card__initials font-bold fs-s txt-white",h:t.includes("url")?"":{svg:!0,a:{class:"pill__placeholderimage txt-white",height:"30",viewBox:"0 0 24 24"},h:[{svg:!0,t:"path",a:{fill:"none",d:"M0 0h24v24H0V0z"}},{svg:!0,t:"path",a:{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v1c0 .55.45 1 1 1h14c.55 0 1-.45 1-1v-1c0-2.66-5.33-4-8-4z"}}]}}},{t:"span",c:"pill__initials",h:e.initials}]})},entityNav:function(){return V.cN({t:"entity-nav",c:"nav entity-nav fixed w-screen overflow-x-scroll"})},userNav:function(){return V.cN({t:"user-nav",c:"nav user-nav fixed w-screen overflow-x-scroll"})},serviceNav:function(){return V.cN({t:"service-nav",c:"nav service-nav fixed w-screen overflow-x-scroll"})},entityNavUl:function(){return V.cN({t:"ul",c:"entity-nav__ul flex items-center font-medium fs-rr"})},serviceNavUl:function(){return V.cN({t:"ul",c:"service-nav__ul flex items-center font-medium"})},userNavUl:function(){return V.cN({t:"ul",c:"user-nav__ul flex items-center font-medium"})}}}(),Navigation=function(){"use strict";function e(e){if(e.success){const n=NavComponents.serviceNavUl();n.addEventListener("click",o);const i=t(e.data[0].serviceNav,3);for(let e=0;e<i.length;e++){const t=NavComponents.pill(i[e]);V.setNode(n,t)}V.setNode(n,NavComponents.pill({title:""})),V.setNode("service-nav",""),V.setNode("service-nav",n);const a=NavComponents.entityNavUl();a.addEventListener("click",o);const s=t(e.data[0].entityNav,3);for(let e=0;e<s.length;e++){const t=NavComponents.entityPill(s[e]);V.setNode(a,t)}V.setNode(a,NavComponents.pill({title:"zzzzzzzzzzzzzzzzz"})),V.setNode("entity-nav",""),V.setNode("entity-nav",a);const r=NavComponents.userNavUl();r.addEventListener("click",o);const c=t(e.data[0].userNav,1);for(let e=0;e<c.length;e++){const t=NavComponents.pill(c[e]);V.setNode(r,t)}V.setNode(r,NavComponents.pill({title:"zzzzz"})),V.setNode("user-nav",""),V.setNode("user-nav",r)}const n=e.data[0].which;n&&setTimeout(()=>function(e){const t=V.getNode('[path="'+e+'"]');V.setState("active",{navItem:t.getAttribute("path")});const n=t.closest(".nav"),o=n.localName;"user-nav"==o||V.getVisibility("entity-nav")||(n.style.display="block",V.setAnimation("user-nav","fadeOut",{duration:.1}),V.setAnimation("entity-nav","fadeIn",{duration:.2}),V.setAnimation("service-nav","fadeIn",{duration:.6}));"user-nav"!=o||V.getVisibility("user-nav")||(n.style.display="block",V.setAnimation("entity-nav","fadeOut",{duration:.1}),V.setAnimation("service-nav","fadeOut",{duration:.6}),V.setAnimation("user-nav","fadeIn",{duration:.2}));const s=V.getState("header");i(),function(e){const t=e.getElementsByClassName("pill__initials")[0];t&&(t.textContent=e.getAttribute("fullId"),t.previousSibling.style.display="none",t.classList.add("pill__replace"),t.classList.remove("pill__initials"));e.className+=" pill--selected",e.addEventListener("click",a)}(t);const r=t.getBoundingClientRect();(function(e,t,n,o){let i=" absolute font-medium";"entity-nav"==e&&(i+=" fs-rr");const a=t.cloneNode(!0);a.className+=i,a.style.left=n.left+"px",a.style.top=n.top+"px",V.getNode("body").appendChild(a),t.style.visibility="hidden",V.getNode(e+" > ul").prepend(t),V.setAnimation(a,{top:o.entityNavTop+4,left:o.entityNavLeft+3},{duration:2}).then(()=>{t.style.visibility="visible",a.remove()})})(o,t,r,s),function(e){const t=V.getNode(e+" > ul").childNodes,n=V.castJson(V.getLocal(e+"-order"));for(let e=0;e<t.length-1;e++){const o=t[e],i=o.getAttribute("path");o.classList.contains("pill--selected")&&(n[i].c?n[i].c+=1:n[i].c=1),n[i].l=e}V.setLocal(e+"-order",n)}(o);const c="service-nav"==o?"entity-nav":"service-nav";V.sA(c,{width:0},{duration:1}),V.setAnimation(o,{width:r.width+11,top:s.entityNavTop,left:s.entityNavLeft},{duration:1}),V.getNode(o).scrollLeft=0}(n),8)}function t(e,t){const n=Object.values(e).sort((function(e,t){return e.l-t.l})),o=n.slice(t).sort((function(e,t){return t.c-e.c}));return n.slice(0).splice(0,t).concat(o)}function n(e,t){for(const n in e)t.hasOwnProperty(n)||delete e[n];for(const n in t)e.hasOwnProperty(n)||(e[t[n].path]=t[n],t[n].tinyImage&&(e[t[n].path].tinyImage=t[n].tinyImage),t[n].useDataUrl&&(e[t[n].path].useDataUrl=t[n].useDataUrl))}function o(e){e.stopPropagation();const t=e.target.closest("li");if(t){const e=t.getAttribute("path"),n=t.getAttribute("uuide"),o=t.getAttribute("uuidp");V.setState("active",{navItem:e}),V.setBrowserHistory(e),n?V.getNavItem("active",["entityNav"]).draw({uuidE:n,uuidP:o,path:e}):V.getNavItem("active",["serviceNav","userNav"]).draw(e)}}function i(){const e=document.getElementsByClassName("pill--selected");if(e.length)for(let t=0;t<e.length;t++){const n=e[t].getElementsByClassName("pill__replace")[0];n&&(n.textContent=e[t].getAttribute("initials"),n.previousSibling.style.display="flex",n.classList.add("pill__initials"),n.classList.remove("pill__replace")),e[t].removeEventListener("click",a),e[t].classList.remove("pill--selected")}}function a(e){e.stopPropagation(),V.getNode("form")?(Form.draw("all",{fade:"out"}),Button.draw("all",{fade:"out"}),Button.draw(V.getNavItem("active","serviceNav").use.button,{delay:1.5}),Page.draw({position:"peek",reset:!1})):"/me/edit"==V.getState("active").path&&V.getVisibility("#pref-lang-edit")?EntityList.draw("/me/edit"):(s(),Page.draw({position:"closed",reset:!1,navReset:!1}))}function s(){const e=V.getState("header"),t=window.innerWidth;i();const n=V.castJson(V.getLocal("entity-nav-order")||"{}"),o=Object.keys(n);o.length>=50&&(o.forEach(e=>{n[e].l>40&&delete n[e]}),V.setLocal("entity-nav-order",n)),V.setBrowserHistory("/"),V.getVisibility("user-nav")&&(V.setAnimation("user-nav","fadeOut",{duration:.1}).then(()=>{V.setAnimation("user-nav",{width:t})}),V.setAnimation("entity-nav","fadeIn",{duration:.2}),V.setAnimation("service-nav","fadeIn",{duration:.6})),V.setState("active",{navItem:!1}),V.getNode("entity-nav").scrollLeft=0,V.getNode("service-nav").scrollLeft=0,V.setAnimation("entity-nav",{width:t},{duration:1.5}),V.setAnimation("service-nav",{width:t,top:e.serviceNavTop,left:e.serviceNavLeft},{duration:2.5}),Form.draw("all",{fade:"out"}),Button.draw("all",{fade:"out"}),Marketplace.draw(),r()}function r(){if("/"!=V.getState("active").path)return;const e=V.getNode('[uuide="'+V.getState("activeEntity").uuidE+'"]');if(!e)return;V.getNode("entity-nav > ul").prepend(e);const t=e.getElementsByClassName("pill__initials")[0];t&&(t.textContent=e.getAttribute("fullId").replace(/\s#\d{4}/,""))}return{draw:function(t){return Promise.resolve(e(function(e,t=("object"==typeof e?e.path:e)){const o=V.castJson(V.getLocal("entity-nav-order")||"{}");!V.getState("entityNav")&&V.setState("entityNav",{});const i=V.getState("entityNav");e&&e.tinyImage&&o[e.path]?o[e.path].tinyImage=JSON.stringify(e.tinyImage):e&&e.images&&e.images.tinyImage&&o[e.path]&&(o[e.path].tinyImage=e.images.tinyImage,o[e.path].useDataUrl=!0);for(const e in o)if(!i[e]){const t={uuidE:o[e].uuidE,uuidP:o[e].uuidP,title:o[e].title,tag:o[e].tag,initials:o[e].initials,path:o[e].path,draw:function(e){Profile.draw(e)}};o[e].tinyImage&&(t.tinyImage=o[e].tinyImage),V.setNavItem("entityNav",t)}if(e&&e.fullId&&!i[e.path]){const t={uuidE:e.uuidE,uuidP:e.uuidP,title:e.title,tag:e.tag,initials:V.castInitials(e.title),path:e.path,draw:function(e){Profile.draw(e)}};e.tinyImage?t.tinyImage=JSON.stringify(e.tinyImage):e.images&&e.images.tinyImage&&(t.tinyImage=e.images.tinyImage,t.useDataUrl=!0),V.setNavItem("entityNav",t)}n(o,i),V.setLocal("entity-nav-order",o);const a=V.getNode('[path="'+t+'"]');if(a&&a.closest("header")&&!e.fullId)return{success:!1,status:"navigation does not need updating",data:[{which:t}]};const s=V.castJson(V.getLocal("service-nav-order")||"{}");n(s,V.getState("serviceNav")),V.setLocal("service-nav-order",s);const r=V.castJson(V.getLocal("user-nav-order")||"{}");return n(r,V.getState("userNav")),V.setLocal("user-nav-order",r),{success:!0,status:"navigation updated",data:[{which:t,entityNav:o,userNav:r,serviceNav:s,keep:5}]}}(t)))},drawReset:function(){s()},drawUserNav:function(){V.getVisibility("user-nav")?(V.setState("active",{navItem:!1}),s()):(Button.draw("all",{fade:"out"}),V.setAnimation("entity-nav","fadeOut",{duration:.1}),V.setAnimation("service-nav","fadeOut",{duration:.6}),V.setAnimation("user-nav","fadeIn",{duration:.2}))},drawImage:function(e){const t=V.castJson(V.getLocal("entity-nav-order"));t[e.path].tinyImage=e.images.tinyImage,t[e.path].useDataUrl=!0,V.setLocal("entity-nav-order",t)},drawEntityNavPill:function(e){const t={uuidE:e.uuidE,uuidP:e.uuidP,title:e.title,tag:e.tag,initials:V.castInitials(e.title),path:e.path,draw:function(e){Profile.draw(e)}};e.tinyImage&&(t.tinyImage=JSON.stringify(e.tinyImage)),V.setNavItem("entityNav",t);const o=V.castJson(V.getLocal("entity-nav-order")||"{}");n(o,V.getState("entityNav")),V.setLocal("entity-nav-order",o);const i=NavComponents.entityPill(t);V.getNode("entity-nav > ul").prepend(i),r()},drawJoinedUserPill:r}}(),SearchComponents=function(){"use strict";let e,t,n,o;function i(){if(n=V.getNode(".search__overlay"),e=V.getNode("magic-btn"),t=e.getNode(".search__input"),o=V.getState("screen"),V.getState("active").searchField){if(""!=t.value){if(t.value.length<2)return;!function(e){const t={query:e};Marketplace.draw(V.getState("active").navItem,t)}(t.value)}a()}else V.setState("active",{searchField:!0}),t.style.display="block",n.style.display="block",setTimeout((function(){t.focus()}),400),e.style.width=o.width>800?"240px":"195px",s()}function a(){t&&(V.setState("active",{searchField:!1}),t.style.display="none",n.style.display="none",t.value="",e.style.width="2.5rem",s())}function s(){let e=V.getState("active").navItem;e=V.getVisibility("user-nav")?"user-nav":e?e.includes("/profile")?"entity-nav":"service-nav":"entity-nav";const t=V.getState("active").searchField?o.width>800?"340px":"272px":V.getState("header").entityNavLeft+"px";V.setAnimation(e,{left:t})}return V.setStyle({"magic-btn":{top:"var(--magic-btn-top)",left:"var(--magic-btn-left)","border-radius":"20px",background:"white",height:"2.5rem",width:"2.5rem",transition:"all 0.3s ease-in-out"},magic-btn__btn:{width:"2rem",height:"2rem",top:"4px",right:"4px",background:"white","border-radius":"9999px","align-items":"center"},search__input:{border:"0",top:"4px",left:"11px",width:"70%",height:"2rem",background:"white"},search__overlay:{top:"0",bottom:"0",left:"0",right:"0"}}),{drawReset:function(){a()},searchMain:function(){return V.cN({t:"magic-btn",c:"magic-btn flex relative pill-shadow",h:[{c:"search__overlay fixed hidden",k:a},{t:"input",c:"search__input relative hidden",a:{type:"search"}},{c:"magic-btn__btn flex absolute justify-center",h:V.getIcon("search"),k:i}]})}}}();